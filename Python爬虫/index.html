<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">

    <title>
        
        Python爬虫 - JiZiTi | 学习管理
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <link href="//at.alicdn.com/t/font_1165120_0wsyrhj51lx.css" rel="stylesheet" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> to be better </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            <i>JiZiTi</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#response对象的属性"><span class="toc-text">response对象的属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#requests处理异常"><span class="toc-text">requests处理异常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Requests库的7个主要方法"><span class="toc-text">Requests库的7个主要方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#作业1"><span class="toc-text">作业1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#爬虫认识"><span class="toc-text">爬虫认识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实例爬取"><span class="toc-text">实例爬取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Beautiful-Soup"><span class="toc-text">Beautiful Soup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#信息处理"><span class="toc-text">信息处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#大学排名实例"><span class="toc-text">大学排名实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#正则表达式"><span class="toc-text">正则表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#淘宝商品比价定向爬虫实例"><span class="toc-text">淘宝商品比价定向爬虫实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#股票数据定向爬虫实例"><span class="toc-text">股票数据定向爬虫实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Scrapy框架"><span class="toc-text">Scrapy框架</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#股票爬虫Scrapy实例"><span class="toc-text">股票爬虫Scrapy实例</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> to be better </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        Python爬虫
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-04-28 20:18:55</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#collection" title="collection">collection</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <p><a href="https://www.icourse163.org/course/BIT-1001870001" target="_blank" rel="noopener">&#x6155;&#x8BFE;&#x5B66;&#x4E60;</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br></pre></td></tr></table></figure>
<h4 id="response&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;"><a href="#response&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;" class="headerlink" title="response&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;"></a>response&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;</h4><ul>
<li>r = requests.get(url)</li>
<li>r.headers()</li>
<li>r.status_code = 200&#x8BBF;&#x95EE;&#x6210;&#x529F; = 404&#x8BBF;&#x95EE;&#x5931;&#x8D25;</li>
<li>r.encoding &#x6839;&#x636E;headers&#x731C;&#x6D4B;&#x54CD;&#x5E94;&#x5185;&#x5BB9;&#x7F16;&#x7801;&#x65B9;&#x5F0F;<br>&#x5982;&#x679C;headers&#x4E2D;&#x6CA1;&#x6709;charset&#xFF0C;&#x5219;r.encoding = iso-8859-1</li>
<li>r.apparent_encoding&#x6839;&#x636E;&#x5185;&#x5BB9;&#x731C;&#x6D4B;&#x54CD;&#x5E94;&#x5185;&#x5BB9;&#x7F16;&#x7801;&#x65B9;&#x5F0F;</li>
<li>r.text &#x6253;&#x5370;&#x9875;&#x9762;&#x5185;&#x5BB9;</li>
<li>r.content &#x663E;&#x793A;&#x5185;&#x5BB9;&#x4E8C;&#x8FDB;&#x5236;&#x5F62;&#x5F0F;&#xFF08;&#x5982;&#x56FE;&#x7247;&#x8D44;&#x6E90;&#xFF09;</li>
</ul>
<h4 id="requests&#x5904;&#x7406;&#x5F02;&#x5E38;"><a href="#requests&#x5904;&#x7406;&#x5F02;&#x5E38;" class="headerlink" title="requests&#x5904;&#x7406;&#x5F02;&#x5E38;"></a>requests&#x5904;&#x7406;&#x5F02;&#x5E38;</h4><ul>
<li>requests.ConnectionError &#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x9519;&#x8BEF;&#x5F02;&#x5E38;&#xFF0C;&#x5982;DNS&#x67E5;&#x8BE2;&#x5931;&#x8D25;&#x3001;&#x62D2;&#x63A5;&#x8FDE;&#x63A5;&#x7B49;</li>
<li>requests.HTTPError HTTP&#x9519;&#x8BEF;&#x5F02;&#x5E38;<br>r.raise_for_status() &#x5982;&#x679C;&#x4E0D;&#x662F;200&#xFF0C;&#x4EA7;&#x751F;&#x5F02;&#x5E38;requests.HTTPError</li>
<li>requests.URLRequired URL&#x7F3A;&#x5931;&#x5F02;&#x5E38;</li>
<li>requests.TooManyRedirects &#x8D85;&#x8FC7;&#x6700;&#x5927;&#x91CD;&#x5B9A;&#x5411;&#x6B21;&#x6570;&#xFF0C;&#x4EA7;&#x751F;&#x91CD;&#x5B9A;&#x5411;&#x5F02;&#x5E38;<br>&#x5BF9;&#x590D;&#x6742;&#x8FDE;&#x63A5;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;</li>
<li>requests.ConnectTimeout &#x8FDE;&#x63A5;&#x8FDC;&#x7A0B;&#x670D;&#x52A1;&#x5668;&#x8D85;&#x65F6;&#x5F02;&#x5E38;</li>
<li>requests.Timeout &#x8BF7;&#x6C42;URL&#x8D85;&#x65F6;&#xFF0C;&#x4EA7;&#x751F;&#x8D85;&#x65F6;&#x5F02;&#x5E38;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">		r.raise_for_status() <span class="comment"># &#x5982;&#x679C;&#x72B6;&#x6001;&#x7801;&#x4E0D;&#x662F;200&#xFF0C;&#x5C06;&#x4EA7;&#x751F;&#x5F02;&#x5E38;</span></span><br><span class="line">		r.encoding = r.apparent_encoding</span><br><span class="line">		<span class="keyword">return</span> r.text</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#x4EA7;&#x751F;&#x5F02;&#x5E38;&quot;</span></span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>: <span class="comment"># &#x8FD9;&#x4E2A;if&#x8BED;&#x53E5;&#x8D77;&#x4EC0;&#x4E48;&#x4F5C;&#x7528;</span></span><br><span class="line">	url = <span class="string">&quot;www.google.com&quot;</span></span><br><span class="line">	print(getHTMLText(url))</span><br></pre></td></tr></table></figure>
<h4 id="Requests&#x5E93;&#x7684;7&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;"><a href="#Requests&#x5E93;&#x7684;7&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;" class="headerlink" title="Requests&#x5E93;&#x7684;7&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;"></a>Requests&#x5E93;&#x7684;7&#x4E2A;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;</h4><ul>
<li><p>requests.request() &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x652F;&#x6491;&#x4EE5;&#x4E0B;&#x5404;&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x57FA;&#x7840;&#x65B9;&#x6CD5;<br><code>requests.request(method, url, &#x63A7;&#x5236;&#x8BBF;&#x95EE;&#x53C2;&#x6570;)</code><br>method: &#x8BF7;&#x6C42;&#x65B9;&#x5F0F;&#xFF0C;&#x5BF9;&#x5E94;get/put/&#x2026;&#x2026;/OPTIONS</p>
</li>
<li><p>requests.get() &#x6700;&#x957F;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;</p>
</li>
<li>requests.head()</li>
<li>requests.post &#x9644;&#x52A0;&#x65B0;&#x7684;&#x6570;&#x636E;</li>
<li>requests.put() &#x5B58;&#x50A8;&#x8D44;&#x6E90;&#xFF0C;&#x8986;&#x76D6;&#x539F;URL&#x4F4D;&#x7F6E;&#x7684;&#x8D44;&#x6E90;</li>
<li>requests.patch() &#x63D0;&#x4EA4;&#x5C40;&#x90E8;&#x4FEE;&#x6539;&#x8BF7;&#x6C42;</li>
<li>requests.delete()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&apos;&apos;&apos;</span></span><br><span class="line"><span class="string">&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x53C2;&#x6570;&#x6F14;&#x793A;</span></span><br><span class="line"><span class="string">params, data, json, headers, </span></span><br><span class="line"><span class="string">cookies, auth, files, timeout, proxies, </span></span><br><span class="line"><span class="string">allow_redirects, stream, verify, cert</span></span><br><span class="line"><span class="string">&apos;&apos;&apos;</span></span><br><span class="line">payload = {<span class="string">&apos;key1&apos;</span>: <span class="string">&apos;value1&apos;</span>, <span class="string">&apos;key2&apos;</span>: <span class="string">&apos;value2&apos;</span>}</span><br><span class="line">r = requests.post(<span class="string">&apos;http://httpbin.org/post&apos;</span>, data = payload)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&apos;http://httpbin.org/post&apos;</span>, json = payload)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&apos;http://httpbin.org/post&apos;</span>, params = payload)</span><br><span class="line">print(r.url)</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&apos;http://httpbin.org/post&apos;</span>, data = <span class="string">&apos;ABC&apos;</span>)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line">fs = {<span class="string">&apos;file&apos;</span>: open(<span class="string">&apos;data.xls&apos;</span>, <span class="string">&apos;rb&apos;</span>)}</span><br><span class="line">r = requests.request(<span class="string">&apos;POST&apos;</span>, <span class="string">&apos;http://python123.io/ws&apos;</span>, files=fs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x9690;&#x85CF;IP</span></span><br><span class="line">pxs = {<span class="string">&apos;http&apos;</span>: <span class="string">&apos;http://user:pass@10.10.10.1:4321&apos;</span></span><br><span class="line">       <span class="string">&apos;http&apos;</span>: <span class="string">&apos;https://10.10.10.1:4321&apos;</span>}</span><br><span class="line">r = requests.request(<span class="string">&apos;GET&apos;</span>, <span class="string">&apos;http://www.baidu.com&apos;</span>, poxies=pxs)</span><br></pre></td></tr></table></figure>
<h4 id="&#x4F5C;&#x4E1A;1"><a href="#&#x4F5C;&#x4E1A;1" class="headerlink" title="&#x4F5C;&#x4E1A;1"></a>&#x4F5C;&#x4E1A;1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&apos;&apos;&apos;</span></span><br><span class="line"><span class="string">&#x8BF7;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x5C0F;&#x7A0B;&#x5E8F;&#xFF0C;&#x201C;&#x4EFB;&#x610F;&#x201D;&#x627E;&#x4E2A;url&#xFF0C;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x6210;&#x529F;&#x722C;&#x53D6;100&#x6B21;&#x7F51;&#x9875;&#x7684;&#x65F6;&#x95F4;&#x3002;</span></span><br><span class="line"><span class="string">(&#x67D0;&#x4E9B;&#x7F51;&#x7AD9;&#x5BF9;&#x4E8E;&#x8FDE;&#x7EED;&#x722C;&#x53D6;&#x9875;&#x9762;&#x5C06;&#x91C7;&#x53D6;&#x5C4F;&#x853D;IP&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8981;&#x907F;&#x5F00;&#x8FD9;&#x7C7B;&#x7F51;&#x7AD9;&#x3002;)</span></span><br><span class="line"><span class="string">&#x8BF7;&#x56DE;&#x590D;&#x4EE3;&#x7801;&#xFF0C;&#x5E76;&#x7ED9;&#x51FA;url&#x53CA;&#x5728;&#x81EA;&#x5DF1;&#x673A;&#x5668;&#x4E0A;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x3002;</span></span><br><span class="line"><span class="string">&apos;&apos;&apos;</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">		r.raise_for_status()</span><br><span class="line">		r.encoding = r.apparent_encoding</span><br><span class="line">		<span class="keyword">return</span> r.text</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#x4EA7;&#x751F;&#x5F02;&#x5E38;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>: <span class="comment"># &#x8FD9;&#x4E2A;if&#x8BED;&#x53E5;&#x8D77;&#x4EC0;&#x4E48;&#x4F5C;&#x7528;</span></span><br><span class="line">	url = <span class="string">&quot;www.baidu.com&quot;</span></span><br><span class="line">	s_time = datetime.datetime.now()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">		getHTMLText(url)</span><br><span class="line">	e_time = datetime.datetime.now()</span><br><span class="line">	print(<span class="string">&apos;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#xFF1A;&apos;</span>,(e_time-s_time).microseconds, end=<span class="string">&apos;&#x5FAE;&#x79D2;&apos;</span>)</span><br></pre></td></tr></table></figure>
<p>&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#xFF1A; 31499&#x5FAE;&#x79D2;</p>
<h4 id="&#x722C;&#x866B;&#x8BA4;&#x8BC6;"><a href="#&#x722C;&#x866B;&#x8BA4;&#x8BC6;" class="headerlink" title="&#x722C;&#x866B;&#x8BA4;&#x8BC6;"></a>&#x722C;&#x866B;&#x8BA4;&#x8BC6;</h4><ul>
<li>&#x89C4;&#x6A21;<ul>
<li>request&#x5E93;&#x2014;&#x5C0F;&#x89C4;&#x6A21;</li>
<li>scrapy&#x5E93;&#x2014;&#x4E2D;&#x89C4;&#x6A21;</li>
<li>&#x641C;&#x7D22;&#x5F15;&#x64CE;&#x2014;&#x5927;&#x89C4;&#x6A21;</li>
</ul>
</li>
<li><p>&#x7F51;&#x7EDC;&#x722C;&#x866B;&#x7684;&#x9650;&#x5236;</p>
<ol>
<li>&#x6765;&#x6E90;&#x5BA1;&#x67E5;&#xFF1A;&#x5224;&#x65AD;User-Agent&#x8FDB;&#x884C;&#x9650;&#x5236;(&#x6D4F;&#x89C8;&#x5668;)</li>
<li>&#x53D1;&#x5E03;&#x516C;&#x544A;&#xFF1A;robots&#x534F;&#x8BAE;&#xFF08;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7F6E;robots.txt&#xFF09;</li>
</ol>
</li>
<li><p>Robots Exclusion Standard&#x7F51;&#x7EDC;&#x722C;&#x866B;&#x6392;&#x9664;&#x6807;&#x51C6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># hexo robots.txt</span><br><span class="line">User-agent: *                  //&#x5BF9;&#x4E8E;&#x4EFB;&#x610F;&#x7684;agent&#x90FD;&#x5E94;&#x9075;&#x5B88;&#x6B64;&#x534F;&#x8BAE;</span><br><span class="line">Allow: /</span><br><span class="line">Allow: /archives/</span><br><span class="line">Allow: /categories/</span><br><span class="line">Allow: /tags/</span><br><span class="line"></span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /js/</span><br><span class="line">Disallow: /css/</span><br><span class="line">Disallow: /fonts/</span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /fancybox/</span><br><span class="line"></span><br><span class="line">User-agent: EtaoSpider        //&#x6B64;&#x6307;&#x540D;&#x7684;&#x6076;&#x610F;&#x722C;&#x866B;</span><br><span class="line">Disallow: /                   //&#x4E0D;&#x80FD;&#x722C;&#x53D6;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="&#x5B9E;&#x4F8B;&#x722C;&#x53D6;"><a href="#&#x5B9E;&#x4F8B;&#x722C;&#x53D6;" class="headerlink" title="&#x5B9E;&#x4F8B;&#x722C;&#x53D6;"></a>&#x5B9E;&#x4F8B;&#x722C;&#x53D6;</h4><ul>
<li>&#x4E00;&#x822C;&#x6027;&#x722C;&#x53D6;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLJD</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text[:<span class="number">1000</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLAMS</span><span class="params">(url)</span>:</span> <span class="comment"># &#x7B80;&#x5355;&#x4F2A;&#x88C5;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        kv = {<span class="string">&apos;user-agent&apos;</span>: <span class="string">&apos;Mozilla/5.0&apos;</span>}</span><br><span class="line">        <span class="comment"># &apos;User-Agent&apos;: &apos;python-requests/2.21.0&apos;&#x6A21;&#x62DF;&#x6D4F;&#x89C8;&#x5668;</span></span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>, headers=kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text[<span class="number">1000</span>:<span class="number">2000</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    urlJD = <span class="string">&quot;https://item.jd.com/2967929.html&quot;</span>  <span class="comment"># &#x4EAC;&#x4E1C;</span></span><br><span class="line">    urlAMS = <span class="string">&quot;https://www.amazon.cn/gp/product/B01M8L5Z3Y&quot;</span>  <span class="comment"># &#x4E9A;&#x9A6C;&#x900A;</span></span><br><span class="line">    print(getHTMLJD(urlJD))</span><br><span class="line">    print(getHTMLAMS(urlAMS))</span><br></pre></td></tr></table></figure>
<ul>
<li>&#x641C;&#x7D22;&#x5F15;&#x64CE;&#x5173;&#x952E;&#x8BCD;&#x63D0;&#x4EA4;&#x63A5;&#x53E3;<ol>
<li>&#x767E;&#x5EA6;&#xFF1A;<a href="http://www.baidu.com/s?wd=keyword" target="_blank" rel="noopener">http://www.baidu.com/s?wd=keyword</a></li>
<li>360&#xFF1A;<a href="http://www.so.com/s?q=keyword" target="_blank" rel="noopener">http://www.so.com/s?q=keyword</a></li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLBaidu</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        kv = {<span class="string">&apos;wd&apos;</span>: <span class="string">&apos;Python&apos;</span>}</span><br><span class="line">        r = requests.get(url, params=kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> len(r.text)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTML360</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        kv = {<span class="string">&apos;q&apos;</span>: <span class="string">&apos;Python&apos;</span>}</span><br><span class="line">        r = requests.get(url, params=kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> len(r.text)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    urlBaidu = <span class="string">&quot;http://www.baidu.com/s&quot;</span>  <span class="comment"># &#x767E;&#x5EA6;</span></span><br><span class="line">    url360 = <span class="string">&quot;http://www.so.com/s&quot;</span>  <span class="comment"># 360</span></span><br><span class="line">    print(getHTMLBaidu(urlBaidu))</span><br><span class="line">    print(getHTML360(url360))</span><br></pre></td></tr></table></figure>
<ul>
<li>&#x7F51;&#x7EDC;&#x56FE;&#x7247;&#x7B49;&#x8D44;&#x6E90;&#x4E0B;&#x8F7D;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://www.jiziti.fun/img/avatar.jpg&quot;</span></span><br><span class="line">root = <span class="string">&quot;D://test//&quot;</span></span><br><span class="line">path = root + url.split(<span class="string">&apos;/&apos;</span>)[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(root):</span><br><span class="line">        os.mkdir(root)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="keyword">with</span> open(path, <span class="string">&apos;wb&apos;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(r.content)  <span class="comment"># r.content&#x8FD4;&#x56DE;2&#x8FDB;&#x5236;&#x6587;&#x4EF6;</span></span><br><span class="line">            f.close()</span><br><span class="line">            print(<span class="string">&quot;&#x6587;&#x4EF6;&#x6210;&#x529F;&#x4FDD;&#x5B58;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;&#x6587;&#x4EF6;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>IP&#x5730;&#x5740;&#x5F52;&#x5C5E;&#x5730;&#x7684;&#x81EA;&#x52A8;&#x67E5;&#x8BE2;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://m.ip138.com/ip.asp?ip=&quot;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(url + <span class="string">&apos;202.204.80.112&apos;</span>)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(r.text[<span class="number">-500</span>:])</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">&quot;&#x722C;&#x53D6;&#x5931;&#x8D25;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Beautiful-Soup"><a href="#Beautiful-Soup" class="headerlink" title="Beautiful Soup"></a><a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="noopener">Beautiful Soup</a></h4><p>&#x53EF;&#x4EE5;&#x89E3;&#x6790;html&#x548C;xml&#x6587;&#x6863;</p>
<p><code>pip install beautifulsoup4</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&quot;http://python123.io/ws/demo.html&quot;</span>)</span><br><span class="line">demo = r.text</span><br><span class="line">soup = BeautifulSoup(demo, <span class="string">&apos;html.parser&apos;</span>) <span class="comment"># HTML&#x89E3;&#x6790;&#x5668;</span></span><br><span class="line"><span class="comment"># soup = BeautifulSoup(&apos;&lt;p&gt;data&lt;/p&gt;&apos;, &apos;html.parser&apos;)</span></span><br><span class="line">print(soup.prettify())</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Beautiful Soup&#x5E93;&#x89E3;&#x6790;&#x5668;</p>
<ol>
<li>html.parser <code>&#x4E0D;&#x7528;&#x518D;&#x5B89;&#x88C5;&#x5176;&#x4ED6;&#x5305;</code></li>
<li>lxml <code>pip install lxml</code></li>
<li>xml  <code>pip install lxml</code></li>
<li>html5lib <code>pip install html5lib</code></li>
</ol>
</li>
<li><p>Beautiful Soup&#x7C7B;&#x7684;&#x57FA;&#x672C;&#x5143;&#x7D20;</p>
<ol>
<li>Tag</li>
<li>Name <code>&lt;tag&gt;.name</code></li>
<li>Attributes <code>&lt;tag&gt;.attrs</code></li>
<li>NavigableString <code>&lt;tag&gt;.string</code></li>
<li>Comment &#x6CE8;&#x91CA;&#x90E8;&#x5206;&#x5904;&#x7406;</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">soup.title <span class="comment"># &lt;title&gt;This is a python demo page&lt;/title&gt;</span></span><br><span class="line">tag = soup.a</span><br><span class="line">tag</span><br><span class="line">type(tag) <span class="comment"># &lt;class &apos;bs4.element.Tag&apos;&gt;</span></span><br><span class="line"></span><br><span class="line">soup.a.name <span class="comment"># &apos;a&apos;</span></span><br><span class="line">soup.a.parent.name <span class="comment"># &apos;p&apos;</span></span><br><span class="line">soup.a.parent.parent.name <span class="comment"># &apos;body&apos;</span></span><br><span class="line"></span><br><span class="line">tag.attrs <span class="comment"># {&apos;href&apos;: &apos;http://www.icourse163.org/course/BIT-268001&apos;, &apos;class&apos;: [&apos;py1&apos;], &apos;id&apos;: &apos;link1&apos;}</span></span><br><span class="line">type(tag.attrs) <span class="comment"># &lt;class &apos;dict&apos;&gt;</span></span><br><span class="line">tag.attrs[<span class="string">&apos;class&apos;</span>] <span class="comment"># [&apos;py1&apos;]</span></span><br><span class="line"></span><br><span class="line">newsoup = BeautifulSoup(<span class="string">&apos;&lt;p&gt;&lt;b&gt;&lt;!-- test --&gt;&lt;/b&gt;&lt;/p&gt;&apos;</span>,<span class="string">&apos;html.parser&apos;</span>)</span><br><span class="line">newsoup.b.string <span class="comment"># &apos; test &apos;</span></span><br><span class="line">newsoup.p.string <span class="comment"># &apos; test &apos;</span></span><br><span class="line">type(newsoup.b.string) <span class="comment"># &lt;class &apos;bs4.element.Comment&apos;&gt;</span></span><br><span class="line">type(newsoup.p.string) <span class="comment"># &lt;class &apos;bs4.element.Comment&apos;&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>&#x904D;&#x5386;</p>
<ul>
<li>&#x5411;&#x4E0B;&#x904D;&#x5386;<ol>
<li>contents &#x5B50;&#x8282;&#x70B9;&#x7684;&#x5217;&#x8868;</li>
<li>children &#x5B50;&#x8282;&#x70B9;&#x7684;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;</li>
<li>descendants &#x5B50;&#x5B59;&#x8282;&#x70B9;&#x7684;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">soup.head <span class="comment"># &lt;head&gt;&lt;title&gt;This is a python demo page&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line">soup.head.contents <span class="comment"># [&lt;title&gt;This is a python demo page&lt;/title&gt;]</span></span><br><span class="line"><span class="comment"># &apos;\n&apos;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>&#x5411;&#x4E0A;&#x904D;&#x5386;<ol>
<li>parent &#x7236;&#x8282;&#x70B9;&#x7684;&#x6807;&#x7B7E; (html&#x6807;&#x7B7E;&#x7684;&#x7236;&#x4EB2;&#x662F;&#x5176;&#x672C;&#x8EAB;)</li>
<li>parents &#x8282;&#x70B9;&#x5148;&#x8F88;&#x6807;&#x7B7E;&#x7684;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> parent <span class="keyword">in</span> soup.a.parents:</span><br><span class="line">    <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        print(parent) <span class="comment"># soup&#x672C;&#x8EAB;&#x4F1A;&#x88AB;&#x904D;&#x5386;&#xFF0C;soup.parent&#x4E3A;&#x7A7A;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(parent.name)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>&#x5E73;&#x884C;&#x904D;&#x5386;</p>
<p><strong>&#x5E73;&#x884C;&#x904D;&#x5386;&#x53D1;&#x751F;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x7236;&#x8282;&#x70B9;&#x4E0B;</strong></p>
<ol>
<li>next_sibling &#x4E0B;&#x4E00;&#x4E2A;&#x5E73;&#x884C;&#x8282;&#x70B9;&#x7684;&#x6807;&#x7B7E;</li>
<li>previous_sibling &#x4E0A;&#x4E00;&#x4E2A;&#x5E73;&#x884C;&#x8282;&#x70B9;&#x7684;&#x6807;&#x7B7E;</li>
<li>next_siblings &#x540E;&#x7EED;&#x5E73;&#x884C;&#x6807;&#x7B7E;&#x7684;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;</li>
<li>previous_siblings &#x524D;&#x9762;&#x5E73;&#x884C;&#x6807;&#x7B7E;&#x7684;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">soup.a.next_sibling</span><br><span class="line"><span class="comment"># &apos; and &apos; NavigableString&#x662F;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span></span><br><span class="line"><span class="keyword">for</span> sibling <span class="keyword">in</span> soup.a.next_siblings:</span><br><span class="line">    print(sibling)</span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x5176;&#x4ED6;</p>
<p>HTML&#x6253;&#x5370;prettify()<br>&#x652F;&#x6301;&#x4E2D;&#x6587;utf-8</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">soup.prettify() <span class="comment"># &#x7ED9;&#x6BCF;&#x4E00;&#x4E2A;&#x6807;&#x7B7E;&#x540E;&#x9762;&#x52A0;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;</span></span><br><span class="line">print(soup.a.prettify())</span><br></pre></td></tr></table></figure>
<h4 id="&#x4FE1;&#x606F;&#x5904;&#x7406;"><a href="#&#x4FE1;&#x606F;&#x5904;&#x7406;" class="headerlink" title="&#x4FE1;&#x606F;&#x5904;&#x7406;"></a>&#x4FE1;&#x606F;&#x5904;&#x7406;</h4><ul>
<li><p>&#x4FE1;&#x606F;&#x6807;&#x8BB0;</p>
<ul>
<li>xml</li>
<li>json&#xFF08;javascript object notation)</li>
<li>yaml</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">person</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">firstName</span>&gt;</span>Tian<span class="tag">&lt;/<span class="name">firstName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">lastName</span>&gt;</span>Song<span class="tag">&lt;/<span class="name">lastName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">address</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">streetAddr</span>&gt;</span>&#x4E2D;&#x5173;&#x6751;&#x5357;&#x5927;&#x8857;<span class="tag">&lt;/<span class="name">streetAddr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">city</span>&gt;</span>&#x5317;&#x4EAC;<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">zipcode</span>&gt;</span>100080<span class="tag">&lt;/<span class="name">zipcode</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prof</span>&gt;</span>Computer System<span class="tag">&lt;/<span class="name">prof</span>&gt;</span><span class="tag">&lt;<span class="name">prof</span>&gt;</span>Security<span class="tag">&lt;/<span class="name">prof</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">person</span>&gt;</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">&quot;firstName&quot;</span>: <span class="string">&quot;Tian&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lastName&quot;</span>: <span class="string">&quot;Song&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;address&quot;</span>: {</span><br><span class="line">        <span class="attr">&quot;streetAddr&quot;</span>: <span class="string">&quot;&#x4E2D;&#x5173;&#x6751;&#x5357;&#x5927;&#x8857;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;city&quot;</span>: <span class="string">&quot;&#x5317;&#x4EAC;&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;zipcode&quot;</span>: <span class="string">&quot;100080&quot;</span></span><br><span class="line">    },</span><br><span class="line">    <span class="attr">&quot;prof&quot;</span>: [<span class="string">&quot;Computer System&quot;</span>, <span class="string">&quot;Security&quot;</span>]</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">firstName:</span> <span class="string">Tian</span> <span class="comment"># &#x65E0;&#x7C7B;&#x578B;&#x7684;&#x952E;&#x503C;&#x5BF9;</span></span><br><span class="line"><span class="attr">lastName:</span> <span class="string">Song</span></span><br><span class="line"></span><br><span class="line"><span class="attr">address:</span> <span class="comment"># &#x901A;&#x8FC7;&#x7F29;&#x8FDB;&#x8868;&#x8FBE;&#x6240;&#x5C5E;&#x5173;&#x7CFB;</span></span><br><span class="line">	<span class="attr">streetAddr:</span> <span class="string">&#x4E2D;&#x5173;&#x6751;&#x5357;&#x5927;&#x8857;</span></span><br><span class="line">	<span class="attr">city:</span> <span class="string">&#x5317;&#x4EAC;</span></span><br><span class="line">	<span class="attr">zipcode:</span> <span class="number">100080</span></span><br><span class="line"></span><br><span class="line"><span class="attr">prof:</span> <span class="comment"># -&#x8868;&#x793A;&#x5E76;&#x5217;</span></span><br><span class="line"><span class="bullet">-</span><span class="string">Computer</span> <span class="string">System</span></span><br><span class="line"><span class="bullet">-</span><span class="string">Security</span></span><br><span class="line"></span><br><span class="line"><span class="attr">text:</span> <span class="string">| # &#x8868;&#x8FBE;&#x6574;&#x5757;&#x6570;&#x636E;</span></span><br><span class="line"><span class="string">&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5;&#x5F88;&#x957F;&#x7684;&#x6587;&#x672C;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>&#x63D0;&#x53D6;&#x5173;&#x952E;&#x4FE1;&#x606F;</p>
<ol>
<li><p>&#x89E3;&#x6790;&#x4FE1;&#x606F;</p>
</li>
<li><p>&#x76F4;&#x63A5;&#x641C;&#x7D22;&#x5173;&#x952E;&#x4FE1;&#x606F;&#xFF08;&#x51C6;&#x786E;&#x6027;&#x4F4E;&#xFF09;</p>
</li>
<li><p>&#x878D;&#x5408;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;</p>
</li>
</ol>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&quot;http://python123.io/ws/demo.html&quot;</span>)</span><br><span class="line">demo = r.text</span><br><span class="line">soup = BeautifulSoup(demo, <span class="string">&apos;html.parser&apos;</span>) <span class="comment"># HTML&#x89E3;&#x6790;&#x5668;</span></span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> soup.find_all(<span class="string">&apos;a&apos;</span>):</span><br><span class="line">    print(link.get(<span class="string">&apos;href&apos;</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>beautifulsoup&#x7684;&#x65B9;&#x6CD5;<ul>
<li><code>find_all(name, attrs, recursive, string, &#x5176;&#x4ED6;&#x63A7;&#x5236;)</code><br>&#x8FD9;&#x4E2A;attrs&#x76F4;&#x63A5;&#x7528;&#x7684;&#x8BDD;&#x6307;&#x7684;&#x662F;class&#x800C;&#x4E0D;&#x662F;id<br>&#x5982;&#x679C;&#x67E5;&#x627E;id&#xFF0C;&#x9700;&#x8981;<code>id=&apos;&#xD7;&#xD7;&#xD7;&apos;</code><br>recursive&#xFF1A;&#x662F;&#x5426;&#x5BF9;&#x5B50;&#x5B59;&#x5168;&#x90E8;&#x68C0;&#x7D22;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;True<br>string&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x57DF;&#x7684;&#x7279;&#x5B9A;&#x68C0;&#x7D22;<br><code>import re</code>&#x7ED3;&#x5408;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4F7F;&#x7528;<br>find_all&#x53EF;&#x7701;&#x7565;</li>
<li>&#x6269;&#x5C55;&#x65B9;&#x6CD5;<br>find()&#xFF1A;&#x53EA;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;<br>find_parents()&#xFF1A;&#x5148;&#x8F88;&#x8282;&#x70B9;&#xFF0C;&#x5217;&#x8868;&#x7C7B;&#x578B;<br>find_parent()&#xFF1A;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;<br>find_next_siblings()<br>find_next_sibling()<br>find_previous_siblings()<br>find_previous_sibling()</li>
</ul>
</li>
</ul>
<h4 id="&#x5927;&#x5B66;&#x6392;&#x540D;&#x5B9E;&#x4F8B;"><a href="#&#x5927;&#x5B66;&#x6392;&#x540D;&#x5B9E;&#x4F8B;" class="headerlink" title="&#x5927;&#x5B66;&#x6392;&#x540D;&#x5B9E;&#x4F8B;"></a>&#x5927;&#x5B66;&#x6392;&#x540D;&#x5B9E;&#x4F8B;</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span> <span class="comment"># &#x4ECE;&#x7F51;&#x7EDC;&#x4E0A;&#x83B7;&#x53D6;&#x5927;&#x5B66;&#x6392;&#x540D;&#x7684;&#x7F51;&#x9875;&#x5185;&#x5BB9;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="string">&quot;&#x83B7;&#x53D6;&#x5F02;&#x5E38;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillUnivList</span><span class="params">(ulist, html)</span>:</span> <span class="comment"># &#x5C06;&#x4FE1;&#x606F;&#x5B58;&#x50A8;&#x5728;&#x5217;&#x8868;&#x4E2D;</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> soup.find(<span class="string">&apos;tbody&apos;</span>).children:</span><br><span class="line">        <span class="keyword">if</span> isinstance(tr, bs4.element.Tag): <span class="comment"># &#x8FC7;&#x6EE4;&#x6389;&#x975E;&#x6807;&#x7B7E;&#x7C7B;&#x578B;</span></span><br><span class="line">            tds = tr(<span class="string">&apos;td&apos;</span>) <span class="comment"># &#x7701;&#x7565;find_all</span></span><br><span class="line">            ulist.append([tds[<span class="number">0</span>].string, tds[<span class="number">1</span>].string, tds[<span class="number">3</span>].string])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printUnivList</span><span class="params">(ulist, num)</span>:</span> <span class="comment"># &#x8F93;&#x51FA;&#x7ED3;&#x679C;</span></span><br><span class="line">    tplt = <span class="string">&quot;{0:^10}\t{1:{3}^10}\t{2:^10}&quot;</span> <span class="comment"># &#x4F7F;&#x7528;{3}&#x7684;&#x53C2;&#x6570;&#x586B;&#x5145;</span></span><br><span class="line">    print(tplt.format(<span class="string">&quot;&#x6392;&#x540D;&quot;</span>, <span class="string">&quot;&#x5B66;&#x6821;&#x540D;&#x79F0;&quot;</span>, <span class="string">&quot;&#x603B;&#x5206;&quot;</span>, chr(<span class="number">12288</span>)))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        print(tplt.format(u[<span class="number">0</span>], u[<span class="number">1</span>], u[<span class="number">2</span>], chr(<span class="number">12288</span>)))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ulist = []</span><br><span class="line">    url = <span class="string">&apos;http://www.zuihaodaxue.cn/zuihaodaxuepaiming2019.html&apos;</span></span><br><span class="line">    html = getHTMLText(url)</span><br><span class="line">    fillUnivList(ulist, html)</span><br><span class="line">    printUnivList(ulist, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h4 id="&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;"><a href="#&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;" class="headerlink" title="&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;"></a>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</h4><div class="table-container">
<table>
<thead>
<tr>
<th>&#x64CD;&#x4F5C;&#x7B26;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>&#x4EFB;&#x4F55;&#x5355;&#x4E2A;&#x5B57;&#x7B26;</td>
</tr>
<tr>
<td>[]</td>
<td>&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x5BF9;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7ED9;&#x51FA;&#x53D6;&#x503C;&#x8303;&#x56F4;</td>
</tr>
<tr>
<td><sup><a href="#fn_" id="reffn_"></a></sup></td>
<td>&#x975E;&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x5BF9;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7ED9;&#x51FA;&#x6392;&#x9664;&#x8303;&#x56F4;</td>
</tr>
<tr>
<td>*</td>
<td>&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;0&#x6B21;&#x6216;&#x65E0;&#x9650;&#x6B21;&#x6269;&#x5C55;</td>
</tr>
<tr>
<td>+</td>
<td>&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;1&#x6B21;&#x6216;&#x65E0;&#x9650;&#x6B21;&#x6269;&#x5C55;</td>
</tr>
<tr>
<td>?</td>
<td>&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;0&#x6B21;&#x6216;1&#x6B21;&#x6269;&#x5C55;</td>
</tr>
<tr>
<td>|</td>
<td>&#x5DE6;&#x53F3;&#x8868;&#x8FBE;&#x5F0F;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;</td>
</tr>
<tr>
<td>{m}</td>
<td>&#x6269;&#x5C55;&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;m&#x6B21;</td>
</tr>
<tr>
<td>{m,n}</td>
<td>&#x6269;&#x5C55;&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;m&#x81F3;n&#x6B21;&#xFF08;&#x542B;n&#xFF09;</td>
</tr>
<tr>
<td>^</td>
<td>&#x5339;&#x914D;&#x5B57;&#x7B26;&#x4E32;&#x5F00;&#x5934;</td>
</tr>
<tr>
<td>$</td>
<td>&#x5339;&#x914D;&#x5B57;&#x7B26;&#x4E32;&#x7ED3;&#x5C3E;</td>
</tr>
<tr>
<td>()</td>
<td>&#x5206;&#x7EC4;&#x6807;&#x8BB0;&#xFF0C;&#x5185;&#x90E8;&#x53EA;&#x80FD;&#x4F7F;&#x7528;|&#x64CD;&#x4F5C;&#x7B26;</td>
</tr>
<tr>
<td>\d</td>
<td>&#x6570;&#x5B57;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;[0-9]</td>
</tr>
<tr>
<td>\w</td>
<td>&#x5355;&#x8BCD;&#x5B57;&#x7B26;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;[A-Za-z0-9_]</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>&#x5E38;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;<ul>
<li><code>^[A-Za-z]+$</code><br>&#x7531;26&#x4E2A;&#x5B57;&#x6BCD;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;</li>
<li><code>^[A-Za-z0-9]+$</code><br>&#x7531;26&#x4E2A;&#x5B57;&#x6BCD;&#x548C;&#x6570;&#x5B57;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;</li>
<li><code>^-?\d+$</code><br>&#x6574;&#x6570;&#x5F62;&#x5F0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;</li>
<li><code>^[0-9]*[1-9][0-9]*$</code><br>&#x6B63;&#x6574;&#x6570;&#x5F62;&#x5F0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;<or>&#xFF1F;&#xFF1F;&#xFF1F;</or></li>
<li><code>[1-9]\d{5}</code><br>&#x4E2D;&#x56FD;&#x5883;&#x5185;&#x90AE;&#x653F;&#x7F16;&#x7801;&#xFF0C;6&#x4F4D;</li>
<li><code>[\u4e00-\u9fa5]</code><br>&#x5339;&#x914D;&#x4E2D;&#x6587;&#x5B57;&#x7B26;</li>
<li><code>\d{3}-\d{8}|\d{4}-\d{7}</code><br>&#x56FD;&#x5185;&#x7535;&#x8BDD;&#x53F7;&#x7801;&#xFF0C;010-68913536</li>
<li><code>(([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5]).){3}([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])</code><br>&#x5339;&#x914D;IP&#x5730;&#x5740;<br>0-99:<code>[1-9]?\d</code> 100-199: <code>1\d{2}</code> 200-249: <code>2[0-4]\d</code> 250-255: <code>25[0-5]</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br></pre></td></tr></table></figure>
<ul>
<li><p>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8868;&#x793A;&#x7C7B;&#x578B;</p>
<ol>
<li>raw string&#x7C7B;&#x578B;&#xFF08;\&#x4E0D;&#x89E3;&#x91CA;&#x4E3A;&#x8F6C;&#x4E49;&#x7B26;&#xFF09;<br>&#x5982;&#xFF1A;<code>r[1-9]\d{5}</code></li>
<li>string&#x7C7B;&#x578B;<br>&#x5982;&#xFF1A;<code>[1-9]\\d{5}</code></li>
</ol>
</li>
<li><p>re&#x5E93;&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x51FD;&#x6570;</p>
<ol>
<li>re.search(pattern, string, flags=0) &#x5339;&#x914D;&#x7B2C;&#x4E00;&#x4E2A;&#xFF0C;&#x8FD4;&#x56DE;match&#x5BF9;&#x8C61;<br>re.I(ignorecase)&#x5339;&#x914D;&#x5FFD;&#x7565;&#x5927;&#x5C0F;&#x5199;<br>re.M(multiline) ^&#x64CD;&#x4F5C;&#x7B26;&#x5C06;&#x5339;&#x914D;&#x6BCF;&#x884C;&#x5F00;&#x59CB;&#x90E8;&#x5206;<br>re.S(dotall) .&#x64CD;&#x4F5C;&#x7B26;&#x80FD;&#x591F;&#x5339;&#x914D;&#x6240;&#x6709;&#x5B57;&#x7B26;&#xFF08;&#x5305;&#x62EC;&#x6362;&#x884C;&#x7B26;&#xFF09;</li>
<li>re.match(pattern, string, flags=0) &#x4ECE;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#x5339;&#x914D;&#xFF0C;&#x8FD4;&#x56DE;match&#x5BF9;&#x8C61;</li>
<li>re.findall(pattern, string, flags=0) &#x5339;&#x914D;&#x6240;&#x6709;&#xFF0C;&#x8FD4;&#x56DE;&#x5217;&#x8868;</li>
<li>re.split(pattern, string, maxsplit=0, flags=0) &#x8FD4;&#x56DE;&#x5217;&#x8868;<br>maxsplit&#xFF1A;&#x6700;&#x5927;&#x5206;&#x5272;&#x6570;&#xFF0C;&#x5269;&#x4F59;&#x90E8;&#x5206;&#x4F5C;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x8F93;&#x51FA;</li>
<li>re.finditer(pattern, string, flags=0) &#x8FD4;&#x56DE;&#x8FED;&#x4EE3;&#x7C7B;&#x578B;&#xFF0C;&#x8FED;&#x4EE3;&#x5143;&#x7D20;&#x4E3A;match&#x5BF9;&#x8C61;</li>
<li>re.sub(pattern, repl, string, count=0, flags=0) &#x8FD4;&#x56DE;&#x66FF;&#x6362;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;<br>count&#xFF1A;&#x5339;&#x914D;&#x7684;&#x6700;&#x5927;&#x66FF;&#x6362;&#x6B21;&#x6570;</li>
</ol>
</li>
<li><p>&#x7F16;&#x8BD1;&#x6267;&#x884C;</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x591A;&#x6B21;&#x4F7F;&#x7528;pattern</span></span><br><span class="line">rex = re.compile(<span class="string">r&apos;[1-9]\d{5}&apos;</span>)</span><br><span class="line">rst = rex.search(<span class="string">&apos;BTS 100086&apos;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Match&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x4E0E;&#x65B9;&#x6CD5;</p>
<ol>
<li>string &#x5F85;&#x5339;&#x914D;&#x5B57;&#x7B26;&#x4E32;&#xFF1B;re &#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF1B;pos &#x641C;&#x7D22;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#xFF1B;endpos</li>
<li>group(0)&#xFF1B;start()&#xFF1B;end()&#xFF1B;span() &#x8FD4;&#x56DE;(.start(), .end())&#x5143;&#x7EC4;&#x7C7B;&#x578B;</li>
</ol>
</li>
<li><p>&#x8D2A;&#x5A6A;&#x5339;&#x914D;&#x4E0E;&#x6700;&#x5C0F;&#x5339;&#x914D;</p>
<ul>
<li><code>*?</code>&#x3001;<code>+?</code>&#x3001;<code>??</code>&#x3001;<code>{m,n}?</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">match = re.search(<span class="string">r&apos;PY.*N&apos;</span>,<span class="string">&apos;PYANBNCNDN&apos;</span>)</span><br><span class="line">match.group(<span class="number">0</span>) <span class="comment"># &#x9ED8;&#x8BA4;&#x91C7;&#x7528;&#x8D2A;&#x5A6A;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD4;&#x56DE;&apos;PYANBNCNDN&apos;</span></span><br><span class="line">match = re.search(<span class="string">r&apos;PY.*?N&apos;</span>,<span class="string">&apos;PYANBNCNDN&apos;</span>)</span><br><span class="line">match.group(<span class="number">0</span>) <span class="comment"># &#x901A;&#x8FC7;&#xFF1F;&#x5B9E;&#x73B0;&#x6700;&#x5C0F;&#x5339;&#x914D;&#xFF0C;&#x8FD4;&#x56DE;&apos;PYAN&apos;</span></span><br></pre></td></tr></table></figure>
<h4 id="&#x6DD8;&#x5B9D;&#x5546;&#x54C1;&#x6BD4;&#x4EF7;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;"><a href="#&#x6DD8;&#x5B9D;&#x5546;&#x54C1;&#x6BD4;&#x4EF7;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;" class="headerlink" title="&#x6DD8;&#x5B9D;&#x5546;&#x54C1;&#x6BD4;&#x4EF7;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;"></a>&#x6DD8;&#x5B9D;&#x5546;&#x54C1;&#x6BD4;&#x4EF7;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        kv = {</span><br><span class="line">            <span class="string">&apos;User-Agent&apos;</span>: <span class="string">&apos;Mozilla/5.0&apos;</span>,</span><br><span class="line">            <span class="string">&apos;Cookie&apos;</span>: <span class="string">&apos;&#xD7;&#xD7;&#xD7;&#xD7;&apos;</span>, <span class="comment"># &#x53EF;&#x624B;&#x52A8;&#x83B7;&#x53D6;</span></span><br><span class="line">        }</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>, headers=kv) <span class="comment"># &#x6DD8;&#x5B9D;&#x6A21;&#x62DF;&#x767B;&#x5F55;</span></span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parsePage</span><span class="params">(ilt, html)</span>:</span> <span class="comment"># &#x63D0;&#x53D6;&#x5546;&#x54C1;&#x540D;&#x79F0;&#x548C;&#x4EF7;&#x683C;&#x4FE1;&#x606F;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plt = re.findall(<span class="string">r&apos;\&quot;view_price\&quot;\:\&quot;[\d\.]*\&quot;&apos;</span>,html)</span><br><span class="line">        tlt = re.findall(<span class="string">r&apos;\&quot;raw_title\&quot;\:\&quot;.*?\&quot;&apos;</span>,html)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plt)):</span><br><span class="line">            price = eval(plt[i].split(<span class="string">&apos;:&apos;</span>)[<span class="number">1</span>]) <span class="comment"># eval&#x51FD;&#x6570;&#x53BB;&#x6389;&#x5355;&#x53CC;&#x5F15;&#x53F7;</span></span><br><span class="line">            title = eval(tlt[i].split(<span class="string">&apos;:&apos;</span>)[<span class="number">1</span>])</span><br><span class="line">            ilt.append([price , title])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;parsePage&#x51FA;&#x9519;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printGoodsList</span><span class="params">(ilt)</span>:</span> <span class="comment"># &#x8F93;&#x51FA;&#x7ED3;&#x679C;</span></span><br><span class="line">    tplt = <span class="string">&quot;{:4}\t{:8}\t{:16}&quot;</span></span><br><span class="line">    print(tplt.format(<span class="string">&quot;&#x5E8F;&#x53F7;&quot;</span>, <span class="string">&quot;&#x4EF7;&#x683C;&quot;</span>, <span class="string">&quot;&#x5546;&#x54C1;&#x540D;&#x79F0;&quot;</span>))</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> ilt:</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">        print(tplt.format(count, g[<span class="number">0</span>], g[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    goods = <span class="string">&apos;&#x4E66;&#x5305;&apos;</span></span><br><span class="line">    depth = <span class="number">2</span> <span class="comment"># &#x722C;&#x53D6;&#x591A;&#x5C11;&#x9875;</span></span><br><span class="line">    start_url = <span class="string">&apos;https://s.taobao.com/search?q=&apos;</span> + goods</span><br><span class="line">    infoList = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(depth): <span class="comment"># &#x5FAA;&#x73AF;&#x83B7;&#x53D6;&#x9875;&#x9762;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = start_url + <span class="string">&apos;&amp;s=&apos;</span> + str(<span class="number">44</span>*i) <span class="comment"># &#x6DD8;&#x5B9D;&#x6BCF;&#x9875;&#x663E;&#x793A;44&#x4E2A;&#x5546;&#x54C1;</span></span><br><span class="line">            html = getHTMLText(url)</span><br><span class="line">            parsePage(infoList, html)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    printGoodsList(infoList)</span><br><span class="line">     </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p><img src="../img/loading.gif" data-original="/img/python/2.png" alt="&#x8F93;&#x51FA;&#x7ED3;&#x679C;"></p>
<h4 id="&#x80A1;&#x7968;&#x6570;&#x636E;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;"><a href="#&#x80A1;&#x7968;&#x6570;&#x636E;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;" class="headerlink" title="&#x80A1;&#x7968;&#x6570;&#x636E;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;"></a>&#x80A1;&#x7968;&#x6570;&#x636E;&#x5B9A;&#x5411;&#x722C;&#x866B;&#x5B9E;&#x4F8B;</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> traceback <span class="comment"># &#x4E3A;&#x4E86;&#x8C03;&#x8BD5;&#x65B9;&#x4FBF;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url, code=<span class="string">&quot;utf-8&quot;</span>)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = code <span class="comment"># &#x624B;&#x5DE5;&#x83B7;&#x53D6;encoding&#xFF0C;&#x63D0;&#x9AD8;&#x8FD0;&#x884C;&#x6548;&#x7387;</span></span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getStockList</span><span class="params">(lst, stockURL)</span>:</span> <span class="comment"># &#x83B7;&#x53D6;&#x80A1;&#x7968;&#x5217;&#x8868;</span></span><br><span class="line">    html = getHTMLText(stockURL, <span class="string">&quot;GB2312&quot;</span>)</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&apos;html.parser&apos;</span>) </span><br><span class="line">    a = soup.find_all(<span class="string">&apos;a&apos;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            href = i.attrs[<span class="string">&apos;href&apos;</span>]</span><br><span class="line">            lst.append(re.findall(<span class="string">r&quot;[s][hz]\d{6}&quot;</span>, href)[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getStockInfo</span><span class="params">(lst, stockURL, fpath)</span>:</span> <span class="comment"># &#x6839;&#x636E;&#x80A1;&#x7968;&#x96F7;&#x67CF;&#x554A;&#x5728;&#x767E;&#x5EA6;&#x83B7;&#x53D6;&#x4E2A;&#x80A1;&#x4FE1;&#x606F;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> stock <span class="keyword">in</span> lst:</span><br><span class="line">        url = stockURL + stock + <span class="string">&quot;.html&quot;</span></span><br><span class="line">        html = getHTMLText(url)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> html==<span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            infoDict = {}</span><br><span class="line">            soup = BeautifulSoup(html, <span class="string">&apos;html.parser&apos;</span>)</span><br><span class="line">            stockInfo = soup.find(<span class="string">&apos;div&apos;</span>,attrs={<span class="string">&apos;class&apos;</span>:<span class="string">&apos;stock-bets&apos;</span>})</span><br><span class="line"> </span><br><span class="line">            name = stockInfo.find_all(attrs={<span class="string">&apos;class&apos;</span>:<span class="string">&apos;bets-name&apos;</span>})[<span class="number">0</span>]</span><br><span class="line">            infoDict.update({<span class="string">&apos;&#x80A1;&#x7968;&#x540D;&#x79F0;&apos;</span>: name.text.split()[<span class="number">0</span>]})</span><br><span class="line">             </span><br><span class="line">            keyList = stockInfo.find_all(<span class="string">&apos;dt&apos;</span>)</span><br><span class="line">            valueList = stockInfo.find_all(<span class="string">&apos;dd&apos;</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(keyList)):</span><br><span class="line">                key = keyList[i].text</span><br><span class="line">                val = valueList[i].text</span><br><span class="line">                infoDict[key] = val</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">with</span> open(fpath, <span class="string">&apos;a&apos;</span>, encoding=<span class="string">&apos;utf-8&apos;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write( str(infoDict) + <span class="string">&apos;\n&apos;</span> )</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">                print(<span class="string">&quot;\r&#x5F53;&#x524D;&#x8FDB;&#x5EA6;: {:.2f}%&quot;</span>.format(count*<span class="number">100</span>/len(lst)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="comment">#traceback.print_exc()</span></span><br><span class="line">            count = count + <span class="number">1</span> <span class="comment"># &#x663E;&#x793A;&#x8FDB;&#x5EA6;&#xFF0C;\r&#x5B9E;&#x73B0;&#x4E0D;&#x6362;&#x884C;</span></span><br><span class="line">            print(<span class="string">&quot;\r&#x5F53;&#x524D;&#x8FDB;&#x5EA6;: {:.2f}%&quot;</span>.format(count*<span class="number">100</span>/len(lst)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    stock_list_url = <span class="string">&apos;http://quote.eastmoney.com/stock_list.html&apos;</span></span><br><span class="line">    stock_info_url = <span class="string">&apos;https://gupiao.baidu.com/stock/&apos;</span></span><br><span class="line">    output_file = <span class="string">&apos;D:/BaiduStockInfo.txt&apos;</span></span><br><span class="line">    slist=[]</span><br><span class="line">    getStockList(slist, stock_list_url)</span><br><span class="line">    getStockInfo(slist[<span class="number">200</span>:<span class="number">230</span>], stock_info_url, output_file)</span><br><span class="line"> </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h4 id="Scrapy&#x6846;&#x67B6;"><a href="#Scrapy&#x6846;&#x67B6;" class="headerlink" title="Scrapy&#x6846;&#x67B6;"></a>Scrapy&#x6846;&#x67B6;</h4><p><code>pip install scrapy</code></p>
<p><img src="../img/loading.gif" data-original="/img/python/3.png" alt="scrapy"></p>
<ul>
<li><p>&#x201C;5+2&#x201D;&#x7ED3;&#x6784;</p>
<ol>
<li>engine&#xFF1A;&#x63A7;&#x5236;&#x6240;&#x6709;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x6D41;&#xFF0C;&#x6839;&#x636E;&#x6761;&#x4EF6;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;</li>
<li>downloader&#xFF1A;&#x6839;&#x636E;&#x8BF7;&#x6C42;&#x4E0B;&#x8F7D;&#x7F51;&#x9875;</li>
<li>scheduler&#xFF1A;&#x8C03;&#x5EA6;&#x722C;&#x53D6;&#x8BF7;&#x6C42;</li>
<li>downloader middleware&#xFF1A;&#x4FEE;&#x6539;&#x3001;&#x4E22;&#x5F03;&#x3001;&#x65B0;&#x589E;&#x8BF7;&#x6C42;&#x6216;&#x54CD;&#x5E94;&#xFF08;request&#x3001;response&#xFF09;</li>
<li>spider&#xFF1A;&#x63D0;&#x4F9B;&#x521D;&#x59CB;url&#xFF0C;&#x89E3;&#x6790;response&#xFF0C;&#x4EA7;&#x751F;item&#xFF0C;&#x4EA7;&#x751F;&#x989D;&#x5916;&#x7684;request</li>
<li>item pipelines&#xFF1A;&#x5BF9;item&#x8FDB;&#x884C;&#x5904;&#x7406;</li>
<li>spider middleware</li>
</ol>
</li>
<li><p>&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528;</p>
<p><code>scrapy &lt;command&gt;[options][args]</code></p>
<ol>
<li><code>scrapy startproject [options]&lt;name&gt;&lt;domain&gt;</code>&#x521B;&#x5EFA;&#x5DE5;&#x7A0B;</li>
<li><code>scrapy genspider&lt;name&gt;[dir]</code>&#x521B;&#x5EFA;&#x722C;&#x866B;</li>
<li><code>scrapy settings[options]</code>&#x83B7;&#x53D6;&#x722C;&#x866B;&#x914D;&#x7F6E;&#x4FE1;&#x606F;</li>
<li><code>scrapy crawl&lt;spider&gt;</code>&#x8FD0;&#x884C;&#x722C;&#x866B;</li>
<li><code>scrapy list</code>&#x5217;&#x51FA;&#x5DE5;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x722C;&#x866B;</li>
<li><code>scrapy shell [url]</code>&#x542F;&#x52A8;URL&#x8C03;&#x8BD5;&#x547D;&#x4EE4;&#x884C;</li>
</ol>
</li>
<li><p>&#x5B9E;&#x4F8B;</p>
<ol>
<li><p><code>scrapy startproject spy</code><br><code>cd spy</code></p>
</li>
<li><p><code>scrapy genspider demo spy.io</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">&apos;demo&apos;</span> <span class="comment"># &#x722C;&#x866B;&#x540D;&#x5B57;</span></span><br><span class="line">    allowed_domains = [<span class="string">&apos;spy.io&apos;</span>] <span class="comment"># &#x722C;&#x53D6;&#x57DF;&#x540D;</span></span><br><span class="line">    start_urls = [<span class="string">&apos;http://spy.io/&apos;</span>] <span class="comment"># &#x521D;&#x59CB;&#x722C;&#x53D6;&#x4E5F;&#x79D2;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#parse&#x7528;&#x4E8E;&#x5904;&#x7406;&#x54CD;&#x5E94;&#xFF0C;&#x89E3;&#x6790;&#x5185;&#x5BB9;&#x5F62;&#x6210;&#x5B57;&#x5178;&#xFF0C;&#x53D1;&#x73B0;&#x65B0;&#x7684;URL&#x722C;&#x53D6;&#x8BF7;&#x6C42;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x4FEE;&#x6539;demo.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">&quot;demo&quot;</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&quot;python123.io&quot;]</span></span><br><span class="line">    start_urls = [<span class="string">&apos;https://python123.io/ws/demo.html&apos;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        fname = response.url.split(<span class="string">&apos;/&apos;</span>)[<span class="number">-1</span>] <span class="comment"># &#x5199;&#x5165;response&#x5185;&#x5BB9;</span></span><br><span class="line">        <span class="keyword">with</span> open(fname, <span class="string">&apos;wb&apos;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(response.body)</span><br><span class="line">        self.log(<span class="string">&apos;Saved file %s.&apos;</span> % name)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>scrapy crawl demo</code></p>
</li>
</ol>
</li>
<li><p>yield&#x751F;&#x6210;&#x5668;<br>&#x8282;&#x7701;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;<br>&#x5E38;&#x4E0E;for&#x5FAA;&#x73AF;&#x7ED3;&#x5408;&#x4F7F;&#x7528;</p>
</li>
<li><p>CSS Selector<br><code>&lt;HTML&gt;.css(&apos;a::attr(href)&apos;).extract()</code></p>
</li>
</ul>
<h4 id="&#x80A1;&#x7968;&#x722C;&#x866B;Scrapy&#x5B9E;&#x4F8B;"><a href="#&#x80A1;&#x7968;&#x722C;&#x866B;Scrapy&#x5B9E;&#x4F8B;" class="headerlink" title="&#x80A1;&#x7968;&#x722C;&#x866B;Scrapy&#x5B9E;&#x4F8B;"></a>&#x80A1;&#x7968;&#x722C;&#x866B;Scrapy&#x5B9E;&#x4F8B;</h4><ul>
<li>stocks.py&#xFF08;spider&#xFF09;</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StocksSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">&quot;stocks&quot;</span></span><br><span class="line">    start_urls = [<span class="string">&apos;http://quote.eastmoney.com/stock_list.html&apos;</span>]</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> href <span class="keyword">in</span> response.css(<span class="string">&apos;a::attr(href)&apos;</span>).extract():</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                stock = re.findall(<span class="string">r&quot;[s][hz]\d{6}&quot;</span>, href)[<span class="number">0</span>]</span><br><span class="line">                url = <span class="string">&apos;https://gupiao.baidu.com/stock/&apos;</span> + stock + <span class="string">&apos;.html&apos;</span></span><br><span class="line">                <span class="keyword">yield</span> scrapy.Request(url, callback=self.parse_stock)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_stock</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        infoDict = {} <span class="comment"># item&#x7C7B;&#x4F3C;&#x5B57;&#x5178;</span></span><br><span class="line">        stockInfo = response.css(<span class="string">&apos;.stock-bets&apos;</span>)</span><br><span class="line">        name = stockInfo.css(<span class="string">&apos;.bets-name&apos;</span>).extract()[<span class="number">0</span>]</span><br><span class="line">        keyList = stockInfo.css(<span class="string">&apos;dt&apos;</span>).extract()</span><br><span class="line">        valueList = stockInfo.css(<span class="string">&apos;dd&apos;</span>).extract()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(keyList)):</span><br><span class="line">            key = re.findall(<span class="string">r&apos;&gt;.*&lt;/dt&gt;&apos;</span>, keyList[i])[<span class="number">0</span>][<span class="number">1</span>:<span class="number">-5</span>]</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                val = re.findall(<span class="string">r&apos;\d+\.?.*&lt;/dd&gt;&apos;</span>, valueList[i])[<span class="number">0</span>][<span class="number">0</span>:<span class="number">-5</span>]</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                val = <span class="string">&apos;--&apos;</span></span><br><span class="line">            infoDict[key]=val</span><br><span class="line"> </span><br><span class="line">        infoDict.update(</span><br><span class="line">            {<span class="string">&apos;&#x80A1;&#x7968;&#x540D;&#x79F0;&apos;</span>: re.findall(<span class="string">&apos;\s.*\(&apos;</span>,name)[<span class="number">0</span>].split()[<span class="number">0</span>] + \</span><br><span class="line">             re.findall(<span class="string">&apos;\&gt;.*\&lt;&apos;</span>, name)[<span class="number">0</span>][<span class="number">1</span>:<span class="number">-1</span>]})</span><br><span class="line">        <span class="keyword">yield</span> infoDict <span class="comment"># &#x5C06;&#x4FE1;&#x606F;&#x63D0;&#x4EA4;&#x7ED9;item piplines&#x7C7B;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>pipelines.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaidustocksPipeline</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaidustocksInfoPipeline</span><span class="params">(object)</span>:</span> <span class="comment"># &#x5904;&#x7406;stocks&#x7C7B;&#x4E2D;&#x63D0;&#x4EA4;&#x7684;item</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open_spider</span><span class="params">(self, spider)</span>:</span></span><br><span class="line">        self.f = open(<span class="string">&apos;BaiduStockInfo.txt&apos;</span>, <span class="string">&apos;w&apos;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_spider</span><span class="params">(self, spider)</span>:</span></span><br><span class="line">        self.f.close()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            line = str(dict(item)) + <span class="string">&apos;\n&apos;</span></span><br><span class="line">            self.f.write(line)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>
<ul>
<li>settings.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ITEM_PIPELINES = {</span><br><span class="line">    <span class="string">&apos;BaiduStocks.pipelines.BaidustocksInfoPipeline&apos;</span>: <span class="number">300</span>,</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><img src="../img/loading.gif" data-original="/img/python/4.png" alt="&#x8F93;&#x51FA;&#x7ED3;&#x679C;"></p>

        <a id="gotop" href="#"><i class="iconfont icon-up-circle"></i></a>
        
        <br>
        <div id="gitalk-container"></div>
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <ul class="list-inline text-center">
        <li>
            <a target="_blank" href="https://xn--i0v668g.com/">
                            <span>
                                <i class="iconfont icon-yang"></i>
                            </span>
            </a>
        </li>
        <li>
            <a target="_blank" href="https://github.com/jianzhiting">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
	<li>
            <a target="_blank" href="https://space.bilibili.com/50146626?from=search&seid=15037865582393636035/">
                            <span>
                                <i class="iconfont icon-bilibili-line"></i>
                            </span>
            </a>
        </li>

    </ul>
    <p>
	to work harder
        <!-- 
	<span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span> 
----------------------------����if you are looking for my theme����---------------------------
	<a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a>
----------------------------------------------------------------------------------------------
	-->
        <a href="https://hexo.io/">Hexo</a></p>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->




<script>!function(e){var r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function t(){for(var c=0;c<r.length;c++)t=r[c],void 0,0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=r[c];t=o,n=function(){r=r.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}t(),e.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(t,e)})}(this);</script></body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<!--Leancloud 操作库:-->
<!--<script src='//cdn1.lncld.net/static/js/3.0.4/av-min.js'></script>-->
<!--Valine 的核心代码库:-->
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<!-- <script src='https://axu.nos-eastchina1.126.net/blogger/Valine.min.js'></script> -->
<script>

window.onload = function(){
	new Valine({
	    el: '#gitalk-container',
	    app_id: 'Kr42r8HXibSngdpUk9xxUMvp-MdYXbMMI',
	    app_key: 'CoKtiY4Yde8LfhppRU3TVwg9',
	    placeholder: 'ヾﾉ≧∀≦)o Write a Comment',
	    emojiCDN:'\/\/cdn.jsdelivr.net\/gh\/jianzhiting\/pic_depot\/img\/emoji\/',
	    emojiMaps:{
		"_口罩_":"3ad2f66b151496d2a5fb0a8ea75f32265d778dd3.png@112w_112h.webp",
		"_酸了_":"92b1c8cbceea3ae0e8e32253ea414783e8ba7806.png@112w_112h.webp",
		"_吃瓜_":"4191ce3c44c2b3df8fd97c33f85d3ab15f4f3c84.png",
		"_OK_":"4683fd9ffc925fa6423110979d7dcac5eda297f4.png@112w_112h.webp",
		"_doge_":"doge.png",
		"_冷_":"cb0ebbd0668640f07ebfc0e03f7a18a8cd00b4ed.png@112w_112h.webp",
		"tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png@112w_112h.webp",
		"tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png@112w_112h.webp",
		"tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png",
		"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png@112w_112h.webp",
		"tv_疑问":"shock.png",
		"tv_点赞":"123a.png",
		"_危_":"5cc6c3357c4df544dd8de9d5c5c0cec97c7c9a56.png@112w_112h.webp",
		"_妙_":"0e98299d7decf5eaffad854977946075c3e91cb8.png@112w_112h.webp",
		"_我裂开了_":"29bd57ec4e8952880fea6c9e47aee924e91f10c4.png@112w_112h.webp",
		"_你细品_":"535e00658e7e47966f154d3a167fa2365ebc4321.png",
		"_奥力给_":"c9b8683827ec6c00fea5327c9bec14f581cef2aa.png",
		"_知识增加_":"142409b595982.png",
		"_第一_":"985bd0bd7dfb668981f2a8733398ebd.png",
	    },
	    avatar: 'retro',
	    pageSize: 5,
	});
}
</script>

</html>
