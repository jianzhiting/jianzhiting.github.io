<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">

    <title>
        
        基于MapReduce的Kindle评论数据分析 - JiZiTi | 学习管理
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <link href="//at.alicdn.com/t/font_1165120_0wsyrhj51lx.css" rel="stylesheet" type="text/css">
    
    <script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.js" integrity="sha384-U8Vrjwb8fuHMt6ewaCy8uqeUXv4oitYACKdB0VziCerzt011iQ/0TqlSlv8MReCm" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/contrib/auto-render.min.js" integrity="sha384-aGfk5kvhIq5x1x5YdvCp4upKZYnA8ckafviDpmWEKp4afOZEqOli7gqSnh8I6enH" crossorigin="anonymous"></script>
    <script>
    renderMathInElement(document.body,{
              delimiters: [
                  {left: "$$", right: "$$", display: true},
                  {left: "$", right: "$", display: false}
              ]
          }
    );
    </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->    
    
</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> to be better </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <!--<img src="/img/avatar.jpg" /> -->
	    <img src="https://ae01.alicdn.com/kf/U56c436d35cb1479e92d0155f267b9705x.jpg">
        </div>
        <div class="name">
            <i>JiZiTi</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hadoop"><span class="toc-text">Hadoop</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-项目简介"><span class="toc-text">1    项目简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-背景"><span class="toc-text">1.1    背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-项目实现目的"><span class="toc-text">1.2    项目实现目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-整体思路"><span class="toc-text">1.3    整体思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-数据及集群配置说明"><span class="toc-text">2    数据及集群配置说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-数据来源"><span class="toc-text">2.1    数据来源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-数据结构说明"><span class="toc-text">2.2    数据结构说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-集群配置说明"><span class="toc-text">2.3    集群配置说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-数据概览"><span class="toc-text">3    数据概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-不同时间粒度下的评论分布"><span class="toc-text">3.1    不同时间粒度下的评论分布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-各阶段评分商品的评论关键词"><span class="toc-text">3.2   各阶段评分商品的评论关键词</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-各个商品的基准平均评级"><span class="toc-text">3.3   各个商品的基准平均评级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-商品评级修正"><span class="toc-text">4    商品评级修正</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-基于评论次数与整体评级的水军识别"><span class="toc-text">4.1   基于评论次数与整体评级的水军识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-基于评论时效性及帮助度的评分修正"><span class="toc-text">4.2   基于评论时效性及帮助度的评分修正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-基于CoreNLP的评论情感识别"><span class="toc-text">4.3   基于CoreNLP的评论情感识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-基于时效性、帮助性、情感识别的书籍评分修正"><span class="toc-text">4.4   基于时效性、帮助性、情感识别的书籍评分修正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-部分得分较高电子书列表"><span class="toc-text">4.5   部分得分较高电子书列表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-总结和展望"><span class="toc-text">5    总结和展望</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-问题及总结"><span class="toc-text">5.1    问题及总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-展望"><span class="toc-text">5.2   展望</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-text">附录</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> to be better </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        基于MapReduce的Kindle评论数据分析
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-04-22 15:47:21</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#project" title="project">project</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content no-indent">
        <h1 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h1><h2 id="1-&#x9879;&#x76EE;&#x7B80;&#x4ECB;"><a href="#1-&#x9879;&#x76EE;&#x7B80;&#x4ECB;" class="headerlink" title="1    &#x9879;&#x76EE;&#x7B80;&#x4ECB;"></a><strong>1</strong>    <strong>&#x9879;&#x76EE;&#x7B80;&#x4ECB;</strong></h2><h3 id="1-1-&#x80CC;&#x666F;"><a href="#1-1-&#x80CC;&#x666F;" class="headerlink" title="1.1    &#x80CC;&#x666F;"></a><strong>1.1</strong>    <strong>&#x80CC;&#x666F;</strong></h3><p>&#x968F;&#x7740;Web&#x6280;&#x672F;&#x548C;&#x7535;&#x5B50;&#x5546;&#x52A1;&#x7684;&#x53D1;&#x5C55;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x7684;&#x4EBA;&#x4F1A;&#x5728;&#x7EBF;&#x4E0A;&#x5BF9;&#x81EA;&#x5DF1;&#x4E70;&#x8FC7;&#x7684;&#x5546;&#x54C1;&#x53D1;&#x8868;&#x8BC4;&#x8BBA;&#x3002;&#x8FD9;&#x4E9B;&#x8BC4;&#x8BBA;&#x4FE1;&#x606F;&#x867D;&#x7136;&#x53EF;&#x80FD;&#x4F1A;&#x5E26;&#x7740;&#x4E00;&#x4E9B;&#x53D1;&#x5E03;&#x8005;&#x7684;&#x4E3B;&#x89C2;&#x60C5;&#x611F;&#xFF0C;&#x4F46;&#x662F;&#x80FD;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x53CD;&#x6620;&#x51FA;&#x5546;&#x54C1;&#x7684;&#x597D;&#x574F;&#x4EE5;&#x53CA;&#x987E;&#x5BA2;&#x5BF9;&#x5546;&#x54C1;&#x7684;&#x559C;&#x7231;&#x7A0B;&#x5EA6;&#x3002;&#x57FA;&#x4E8E;&#x5927;&#x6570;&#x636E;&#x5206;&#x6790;&#x6280;&#x672F;&#xFF0C;&#x80FD;&#x591F;&#x4ECE;&#x5927;&#x91CF;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#x4E2D;&#x5206;&#x6790;&#x51FA;&#x5546;&#x54C1;&#x7684;&#x6574;&#x4F53;&#x8BC4;&#x4EF7;&#x3001;&#x8BC4;&#x8BBA;&#x8005;&#x7684;&#x8BC4;&#x8BBA;&#x504F;&#x597D;&#x7B49;&#x3002;&#x5982;&#x679C;&#x80FD;&#x591F;&#x53BB;&#x9664;&#x8BC4;&#x8BBA;&#x4E2D;&#x5404;&#x79CD;&#x56E0;&#x7D20;&#x5E26;&#x6765;&#x7684;&#x504F;&#x5DEE;&#xFF0C;&#x5F97;&#x5230;&#x7684;&#x7ED3;&#x679C;&#x5C06;&#x80FD;&#x591F;&#x66F4;&#x52A0;&#x51C6;&#x786E;&#x5730;&#x53CD;&#x6620;&#x4E8B;&#x5B9E;&#x3002;</p>
<p>&#x5546;&#x5BB6;&#x5F97;&#x5230;&#x4ECE;&#x5927;&#x91CF;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#x4E2D;&#x5206;&#x6790;&#x51FA;&#x7684;&#x987E;&#x5BA2;&#x53CD;&#x9988;&#x540E;&#xFF0C;&#x5C06;&#x6709;&#x52A9;&#x4E8E;&#x5546;&#x5BB6;&#x8FDB;&#x884C;&#x9500;&#x552E;&#x7B56;&#x7565;&#x7684;&#x51B3;&#x7B56;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x51C6;&#x5907;&#x8D2D;&#x4E70;&#x8BE5;&#x5546;&#x54C1;&#x7684;&#x987E;&#x5BA2;&#x4E5F;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x8BC4;&#x8BBA;&#x7684;&#x53CD;&#x9988;&#x6765;&#x5E2E;&#x52A9;&#x81EA;&#x5DF1;&#x5224;&#x65AD;&#x8BE5;&#x5546;&#x54C1;&#x662F;&#x5426;&#x503C;&#x5F97;&#x8D2D;&#x4E70;&#x3002;</p>
<h3 id="1-2-&#x9879;&#x76EE;&#x5B9E;&#x73B0;&#x76EE;&#x7684;"><a href="#1-2-&#x9879;&#x76EE;&#x5B9E;&#x73B0;&#x76EE;&#x7684;" class="headerlink" title="1.2    &#x9879;&#x76EE;&#x5B9E;&#x73B0;&#x76EE;&#x7684;"></a><strong>1.2</strong>    <strong>&#x9879;&#x76EE;&#x5B9E;&#x73B0;&#x76EE;&#x7684;</strong></h3><p>&#x57FA;&#x4E8E;MapReduce&#x7B97;&#x6CD5;&#xFF0C;&#x901A;&#x8FC7;&#x4E0D;&#x65AD;&#x5730;&#x4FEE;&#x6539;&#x5206;&#x6790;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#x7684;&#x6807;&#x51C6;&#x6765;&#x5F97;&#x5230;&#x66F4;&#x52A0;&#x771F;&#x5B9E;&#x7684;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x3002;&#x5148;&#x901A;&#x8FC7;&#x5206;&#x6790;&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x3001;&#x4E0D;&#x540C;&#x8BC4;&#x8BBA;&#x661F;&#x7EA7;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;&#x4EE5;&#x53CA;&#x5404;&#x7EA7;&#x8BC4;&#x5206;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x51B5;&#x6765;&#x5F97;&#x5230;&#x6570;&#x636E;&#x7684;&#x57FA;&#x672C;&#x60C5;&#x51B5;&#x3002;&#x5728;&#x6B64;&#x57FA;&#x7840;&#x4E0A;&#x4FEE;&#x6B63;&#x8BC4;&#x5206;&#x6A21;&#x578B;&#xFF0C;&#x5254;&#x9664;&#x201C;&#x6C34;&#x519B;&#x201D;&#x3001;&#x5BF9;&#x8BC4;&#x8BBA;&#x8FDB;&#x884C;&#x60C5;&#x611F;&#x5206;&#x6790;&#xFF0C;&#x7ED3;&#x5408;&#x65F6;&#x6548;&#x6027;&#x548C;&#x5E2E;&#x52A9;&#x6027;&#x6765;&#x5F97;&#x5230;&#x66F4;&#x52A0;&#x771F;&#x5B9E;&#x51C6;&#x786E;&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="1-3-&#x6574;&#x4F53;&#x601D;&#x8DEF;"><a href="#1-3-&#x6574;&#x4F53;&#x601D;&#x8DEF;" class="headerlink" title="1.3    &#x6574;&#x4F53;&#x601D;&#x8DEF;"></a><strong>1.3</strong>    <strong>&#x6574;&#x4F53;&#x601D;&#x8DEF;</strong></h3><p>&#x672C;&#x9879;&#x76EE;&#x65E8;&#x5728;&#x5206;&#x6790;&#x4E9A;&#x9A6C;&#x900A;kindle&#x5546;&#x5E97;1996&#x5E74;&#x5230;2014&#x5E74;&#x7684;&#x767E;&#x4E07;&#x6761;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#xFF0C;&#x4FEE;&#x6B63;&#x8BC4;&#x5206;&#x6A21;&#x578B;&#x4ECE;&#x800C;&#x5F97;&#x5230;&#x66F4;&#x4E3A;&#x771F;&#x5B9E;&#x51C6;&#x786E;&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x51B5;&#x3002;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x6B65;&#x9AA4;&#xFF1A;</p>
<p>&#xFF08;1&#xFF09;  &#x9488;&#x5BF9;&#x8BC4;&#x8BBA;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF08;&#x4E00;&#x7EA7;&#x6570;&#x636E;&#xFF09;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x5F97;&#x5230;&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;&#x3001;&#x5404;&#x4E2A;&#x9636;&#x6BB5;&#x8BC4;&#x8BBA;&#x7684;&#x8BCD;&#x4E91;&#x7B49;&#x4E8C;&#x7EA7;&#x6570;&#x636E;&#x3002;<br>&#xFF08;2&#xFF09;  &#x6C42;&#x51FA;&#x4E0D;&#x540C;&#x6807;&#x51C6;&#x4E0B;&#x7684;&#x5404;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#x4F5C;&#x4E3A;&#x57FA;&#x51C6;&#x5BF9;&#x6BD4;&#x6570;&#x636E;&#x3002;<br>&#xFF08;3&#xFF09;  &#x5728;&#x57FA;&#x51C6;&#x6570;&#x636E;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x8BC6;&#x522B;&#x51FA;&#x8BC4;&#x8BBA;&#x4E2D;&#x7684;&#x201C;&#x6C34;&#x519B;&#x201D;&#xFF0C;&#x6839;&#x636E;&#x5E2E;&#x52A9;&#x5EA6;&#x548C;&#x65F6;&#x6548;&#x6027;&#x786E;&#x5B9A;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x8BC4;&#x7EA7;&#x7684;&#x6743;&#x91CD;&#xFF0C;&#x5BF9;&#x8BC4;&#x8BBA;&#x8FDB;&#x884C;&#x60C5;&#x611F;&#x8BC6;&#x522B;&#x5206;&#x6790;&#xFF0C;&#x53BB;&#x9664;&#x4E0D;&#x540C;&#x4EBA;&#x4E4B;&#x95F4;&#x7684;&#x504F;&#x597D;&#x8BC4;&#x5206;&#x5DEE;&#x5F02;&#xFF0C;&#x4FEE;&#x6B63;&#x8BC4;&#x5206;&#x6A21;&#x578B;&#xFF0C;&#x91CD;&#x65B0;&#x5BF9;&#x4E00;&#x7EA7;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x5F97;&#x5230;&#x66F4;&#x52A0;&#x51C6;&#x786E;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x4EE5;&#x4E0A;&#x7684;&#x6B65;&#x9AA4;&#x90FD;&#x662F;&#x57FA;&#x4E8E;Hadoop MapReduce&#x7F16;&#x7A0B;&#x6C42;&#x89E3;&#xFF0C;&#x5F97;&#x51FA;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x540E;&#x4F7F;&#x7528;Python&#x5236;&#x4F5C;&#x51FA;&#x56FE;&#x8868;&#x3002;</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x672C;&#x6587;&#x5217;&#x51FA;&#x4E86;&#x5404;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x3002;</p>
<h2 id="2-&#x6570;&#x636E;&#x53CA;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;"><a href="#2-&#x6570;&#x636E;&#x53CA;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;" class="headerlink" title="2    &#x6570;&#x636E;&#x53CA;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;"></a><strong>2</strong>    <strong>&#x6570;&#x636E;&#x53CA;&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;</strong></h2><h3 id="2-1-&#x6570;&#x636E;&#x6765;&#x6E90;"><a href="#2-1-&#x6570;&#x636E;&#x6765;&#x6E90;" class="headerlink" title="2.1    &#x6570;&#x636E;&#x6765;&#x6E90;"></a><strong>2.1</strong>    <strong>&#x6570;&#x636E;&#x6765;&#x6E90;</strong></h3><p>&#x6211;&#x4EEC;&#x4ECE;kaggle&#x7F51;&#x7AD9;&#x4E0B;&#x8F7D;&#x4E86;&#x6709;&#x5173;&#x4E9A;&#x9A6C;&#x900A;&#x7684;kindle&#x5546;&#x5E97;&#x4EA7;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#xFF0C;&#x8BC4;&#x8BBA;&#x65F6;&#x95F4;&#x4ECE;1996&#x5E74;5&#x6708;&#x5230;2014&#x5E74;7&#x6708;&#xFF0C;&#x603B;&#x5171;982619&#x6761;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x8BC4;&#x8BBA;&#x8005;&#x81F3;&#x5C11;&#x53D1;&#x5E03;&#x4E86;5&#x6761;&#x8BC4;&#x8BBA;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EA7;&#x54C1;&#x90FD;&#x81F3;&#x5C11;&#x6709;5&#x6761;&#x8BC4;&#x8BBA;&#x3002;</p>
<h3 id="2-2-&#x6570;&#x636E;&#x7ED3;&#x6784;&#x8BF4;&#x660E;"><a href="#2-2-&#x6570;&#x636E;&#x7ED3;&#x6784;&#x8BF4;&#x660E;" class="headerlink" title="2.2    &#x6570;&#x636E;&#x7ED3;&#x6784;&#x8BF4;&#x660E;"></a><strong>2.2</strong>    <strong>&#x6570;&#x636E;&#x7ED3;&#x6784;&#x8BF4;&#x660E;</strong></h3><p><strong>&#x6570;&#x636E;&#x683C;&#x5F0F;:</strong> json</p>
<p><strong>&#x6570;&#x636E;&#x5B57;&#x6BB5;&#xFF1A;</strong></p>
<p>asin:  &#x4EA7;&#x54C1;&#x7F16;&#x53F7;<br>helpful:  &#x8BC4;&#x8BBA;&#x662F;&#x5426;&#x6709;&#x5E2E;&#x52A9;<br>overall:  &#x4EA7;&#x54C1;&#x8BC4;&#x7EA7;<br>reviewText:  &#x8BC4;&#x8BBA;&#x5185;&#x5BB9;<br>reviewTime:  &#x8BC4;&#x8BBA;&#x65F6;&#x95F4;<br>reviewerID:  &#x8BC4;&#x8BBA;&#x8005;ID<br>reviewerName:  &#x8BC4;&#x8BBA;&#x8005;&#x540D;&#x79F0;<br>summary:  &#x8BC4;&#x8BBA;&#x5185;&#x5BB9;&#x7684;&#x6982;&#x62EC;<br>unixReviewTime:  &#x65F6;&#x95F4;&#x6233;</p>
<p>&#x6CE8;&#xFF1A;helpful&#xFF1A;[m,n]&#x8868;&#x793A;&#x6709;n&#x4E2A;&#x4EBA;&#x5BF9;&#x8FD9;&#x6761;&#x8BC4;&#x8BBA;&#x8FDB;&#x884C;&#x4E86;&#x8BC4;&#x4EF7;&#xFF0C;&#x5176;&#x4E2D;m&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x8FD9;&#x6761;&#x8BC4;&#x8BBA;&#x6709;&#x5E2E;&#x52A9;&#x3002;</p>
<p><strong>&#x6570;&#x636E;&#x5B9E;&#x4F8B;&#xFF1A;</strong></p>
<p>{&#x201C;reviewerID&#x201D;:&#x201D;A1F6404F1VG29J&#x201D;,&#x201D;asin&#x201D;:&#x201D;B000F83SZQ&#x201D;, reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;}</p>
<h3 id="2-3-&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;"><a href="#2-3-&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;" class="headerlink" title="2.3    &#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;"></a><strong>2.3</strong>    <strong>&#x96C6;&#x7FA4;&#x914D;&#x7F6E;&#x8BF4;&#x660E;</strong></h3><p><strong>&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x60C5;&#x51B5;&#xFF1A;</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x673A;&#x5668;&#x540D;&#x79F0;</th>
<th>IP&#x5730;&#x5740;</th>
<th>&#x786C;&#x4EF6;&#x914D;&#x7F6E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>Master</td>
<td>192.168.1.246</td>
<td>Core i5 &#x53CC;&#x6838;   RAM:12GB</td>
</tr>
<tr>
<td>Slaver0</td>
<td>192.168.1.243</td>
<td>Core i5 &#x53CC;&#x6838;   RAM:8GB</td>
</tr>
<tr>
<td>Slaver1</td>
<td>192.168.1.245</td>
<td>Core i5 &#x53CC;&#x6838; RAM:8GB</td>
</tr>
<tr>
<td>Slaver2</td>
<td>192.168.1.247</td>
<td>Core i5 &#x53CC;&#x6838;   RAM:8GB</td>
</tr>
</tbody>
</table>
</div>
<p><strong>&#x8F6F;&#x4EF6;&#xFF1A;</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th><strong>&#x7248;&#x672C;</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Hadoop</td>
<td>2.9.0</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>16.04.5</td>
</tr>
<tr>
<td>VMware Workstation Pro</td>
<td>12.1.0</td>
</tr>
<tr>
<td>Python</td>
<td>3.6.4</td>
</tr>
<tr>
<td>Maven</td>
<td>3.6.0</td>
</tr>
</tbody>
</table>
</div>
<h2 id="3-&#x6570;&#x636E;&#x6982;&#x89C8;"><a href="#3-&#x6570;&#x636E;&#x6982;&#x89C8;" class="headerlink" title="3    &#x6570;&#x636E;&#x6982;&#x89C8;"></a><strong>3</strong>    <strong>&#x6570;&#x636E;&#x6982;&#x89C8;</strong></h2><p>&#x7ECF;&#x7EDF;&#x8BA1;&#xFF0C;&#x5171;&#x6709;&#x8BC4;&#x8BBA;&#x8005;68223&#x4EBA;&#xFF0C;&#x5546;&#x54C1;61934&#x79CD;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x6CA1;&#x6709;&#x540C;&#x4E00;&#x8BC4;&#x8BBA;&#x8005;&#x4E3A;&#x540C;&#x4E00;&#x5546;&#x54C1;&#x7559;&#x8BC4;&#x8D85;&#x8FC7;&#x4E24;&#x6B21;&#x3002;</p>
<h3 id="3-1-&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;"><a href="#3-1-&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;" class="headerlink" title="3.1    &#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;"></a><strong>3.1</strong>    <strong>&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#x4E0B;&#x7684;&#x8BC4;&#x8BBA;&#x5206;&#x5E03;</strong></h3><p>&#x9996;&#x5148;&#xFF0C;&#x5728;&#x8BE5;&#x6848;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x5728;&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x4E0B;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x7684;&#x5206;&#x5E03;&#xFF0C;&#x4ECE;&#x800C;&#x5BF9;&#x7528;&#x6237;&#x7684;&#x6D3B;&#x8DC3;&#x60C5;&#x51B5;&#x6709;&#x4E00;&#x4E2A;&#x521D;&#x6B65;&#x8BA4;&#x8BC6;&#xFF0C;&#x56E0;&#x4E3A;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x5F71;&#x54CD;&#x4E86;Kindle&#x4E66;&#x7C4D;&#x7684;&#x9500;&#x552E;&#x6570;&#x76EE;&#xFF0C;&#x56E0;&#x6B64;&#x63D0;&#x9AD8;Kindle&#x7528;&#x6237;&#x7684;&#x6D3B;&#x8DC3;&#x5EA6;&#xFF0C;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;Kindle&#x4E66;&#x7C4D;&#x7684;&#x9500;&#x552E;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>1.&#x5165;&#x521D;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x6839;&#x636E;&#x8BC4;&#x8BBA;&#x7684;UNIX&#x65F6;&#x95F4;&#x6233;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#xFF0C;&#x4EE5;&#x5929;&#x4F5C;&#x4E3A;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#xFF08;&#x539F;&#x59CB;&#x6570;&#x636E;&#x4E2D;UNIX&#x65F6;&#x95F4;&#x6233;&#x7F3A;&#x4E4F;&#x7CBE;&#x7EC6;&#x5230;&#x5C0F;&#x65F6;&#x7684;&#x6570;&#x636E;&#xFF09;&#xFF0C;&#x7EDF;&#x8BA1;&#x51FA;&#x4E0D;&#x540C;&#x65E5;&#x671F;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x3002;&#x7528;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>CommentCountByDate.java</strong><sup><a href="#fn_1" id="reffn_1">1</a></sup></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: 2000-03-05(&#x8BC4;&#x8BBA;&#x65E5;&#x671F;)   value: 1&#xFF08;&#x8BC4;&#x8BBA;&#x6B21;&#x6570;&#xFF09;</p>
<p>2.&#x5728;&#x83B7;&#x53D6;&#x4EE5;&#x5929;&#x4F5C;&#x4E3A;&#x65F6;&#x95F4;&#x7C92;&#x5EA6;&#xFF0C;2000~2014&#x5E74;&#x4E0D;&#x540C;&#x65E5;&#x671F;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x540E;&#xFF0C;&#x5229;&#x7528;Python&#x7EDF;&#x8BA1;&#x51FA;&#x4E0D;&#x540C;&#x5E74;&#x4EFD;&#x3001;&#x6708;&#x4EFD;&#x3001;&#x5DE5;&#x4F5C;&#x65E5;&#x7684;&#x65E5;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#xFF1A;</p>
<p>&#x5C06;&#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#x7ED8;&#x5236;&#x6210;&#x6298;&#x7EBF;&#x56FE;&#x5982;&#x4E0B;:<br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/output_3_0.png" style="width: 60%"></p>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;Kindle&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x81EA;&#x4ECE;2010&#x5E74;&#x5F00;&#x59CB;&#x5448;&#x73B0;&#x4E95;&#x55B7;&#x5F0F;&#x589E;&#x957F;&#xFF0C;&#x6700;&#x7EC8;&#x5728;2014&#x5E74;&#x8FBE;&#x5230;&#x65E5;&#x5E73;&#x5747;&#x6570;&#x76EE;&#x4E3A;2000&#x6B21;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x968F;&#x7740;&#x79FB;&#x52A8;&#x4E92;&#x8054;&#x7F51;&#x7684;&#x53D1;&#x5C55;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x4EBA;&#x9009;&#x62E9;&#x5728;kindle&#x4E0A;&#x8D2D;&#x4E70;&#x7535;&#x5B50;&#x4E66;&#xFF1B;<br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/output_4_0.png" style="width: 60%"></p>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x65E5;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x5728;1&#x6708;&#x4EFD;&#x81F3;7&#x6708;&#x4EFD;&#x5728;525&#x6B21;&#x4E0A;&#x4E0B;&#x6CE2;&#x52A8;&#xFF1B;&#x5728;8-12&#x6708;&#x4EFD;&#x4E0E;&#x4E4B;&#x524D;&#x76F8;&#x6BD4;&#x663E;&#x8457;&#x4E0B;&#x964D;&#xFF0C;&#x4F46;&#x4ECD;&#x7136;&#x5448;&#x73B0;&#x51FA;&#x56DE;&#x5347;&#x8D8B;&#x52BF;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x4EBA;&#x4EEC;&#x5728;&#x5E74;&#x521D;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x4E00;&#x6B21;&#x6027;&#x8D2D;&#x4E70;&#x4ECA;&#x5E74;&#x8981;&#x9605;&#x8BFB;&#x7684;&#x4E66;&#x7C4D;&#xFF1B;<br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/output_5_0.png" style="width: 60%"></p>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5728;&#x5468;&#x65E5;&#x3001;&#x5468;&#x4E00;&#x65F6;&#xFF0C;&#x65E5;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x4E0E;&#x5E73;&#x65F6;&#x76F8;&#x6BD4;&#x8F83;&#x9AD8;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x5468;&#x65E5;&#x3001;&#x5468;&#x4E00;&#x7B49;&#x4EBA;&#x4EEC;&#x6709;&#x8F83;&#x591A;&#x7A7A;&#x95F2;&#x7684;&#x65F6;&#x95F4;&#x6765;&#x9605;&#x8BFB;&#x4E66;&#x7C4D;&#x548C;&#x5BF9;&#x4E66;&#x7C4D;&#x8FDB;&#x884C;&#x8BC4;&#x8BBA;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;Kindle&#x9500;&#x552E;&#x90E8;&#x95E8;&#x53EF;&#x5728;8-12&#x6708;&#x4EFD;&#x589E;&#x52A0;&#x4FC3;&#x9500;&#x6D3B;&#x52A8;&#xFF1B;&#x5728;&#x5468;&#x65E5;&#x3001;&#x5468;&#x4E00;&#x7B49;&#x4EBA;&#x4EEC;&#x6709;&#x8F83;&#x591A;&#x7A7A;&#x95F2;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x589E;&#x52A0;&#x5546;&#x54C1;&#x63A8;&#x9001;&#xFF0C;&#x4ECE;&#x800C;&#xFF0C;&#x63D0;&#x9AD8;Kindle&#x4E66;&#x7C4D;&#x9500;&#x91CF;&#x3002;</p>
<h3 id="3-2-&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x5206;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;"><a href="#3-2-&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x5206;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;" class="headerlink" title="3.2   &#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x5206;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;"></a><strong>3.2</strong>   <strong>&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x5206;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;</strong></h3><p>&#x5728;&#x83B7;&#x53D6;&#x4E0D;&#x540C;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x5206;&#x540E;&#xFF0C;&#x4E3A;&#x5206;&#x6790;&#x4E0D;&#x540C;&#x8BC4;&#x8BBA;&#x7684;&#x5185;&#x5BB9;&#x5BF9;&#x5546;&#x54C1;&#x8BC4;&#x5206;&#x7684;&#x5F71;&#x54CD; &#xFF0C;&#x6211;&#x4EEC;&#x6839;&#x636E;&#x5546;&#x54C1;&#x8BC4;&#x5206;&#x7684;&#x4E0D;&#x540C;&#x5212;&#x5206;&#x4E3A;&#x4E94;&#x4E2A;&#x533A;&#x95F4; [1,2), [2,3), [3,4), [4,5)&#xFF0C;[5,5]&#x6839;&#x636E;TF-IDF&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x51FA;&#x6BCF;&#x4E2A;&#x8BC4;&#x8BBA;&#x7684;&#x5173;&#x952E;&#x8BCD;&#xFF0C;&#x5E76;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x8BC4;&#x5206;&#x533A;&#x95F4;&#x4E0B;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x5206;&#x5E03;&#xFF0C;&#x7ED8;&#x5236;&#x6210;&#x56FE;&#x4E91;&#x52A0;&#x4EE5;&#x5C55;&#x793A;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>CommentTermFrequency.java</strong><sup><a href="#fn_2" id="reffn_2">2</a></sup></p>
<p>1.&#x5728;&#x5BF9;&#x8BC4;&#x8BBA;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#x5E76;&#x53BB;&#x9664;stopword&#x540E;&#xFF0C;&#x8BA1;&#x7B97;&#x51FA;&#x5176;&#x8BCD;&#x9891;&#xFF1B;</p>
<script type="math/tex; mode=display">
TF = \frac{在某一条评论中单词w出现的次数}{该评论中去除stopword后的所有单词的数目}</script><p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: nice B000F83SZQ+A1F6404F1VG29J   value: 0.10&#xFF08;&#x8BCD;&#x9891;&#xFF09;</p>
<p>2.&#x5728;&#x83B7;&#x53D6;&#x8BE5;&#x6848;&#x4F8B;&#x4E2D;&#x8BC4;&#x8BBA;&#x7684;&#x8BCD;&#x9891;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x8BA1;&#x7B97;&#x51FA;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x4E2D;&#x7684;&#x8BCD;&#x9891;-&#x9006;&#x6587;&#x4EF6;&#x9891;&#x7387;&#xFF1B;</p>
<script type="math/tex; mode=display">
TF - IDF_w = TF_w\times lg\frac{评论总数}{包含单词w的评论数}</script><p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>nice B000F83SZQ+A1F6404F1VG29J    0.10&#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09; </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>nice B000F83SZQ+A1F6404F1VG29J    0.15 </p>
<p>3.&#x5728;&#x5F97;&#x5230;&#x6BCF;&#x4E2A;&#x8BC4;&#x8BBA;&#x4E2D;&#x6BCF;&#x4E2A;&#x5355;&#x8BCD;&#x7684;&#x8BCD;&#x9891;-&#x9006;&#x6587;&#x4EF6;&#x9891;&#x7387;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x53D6;&#x6700;&#x9AD8;&#x8005;&#xFF0C;&#x4F5C;&#x4E3A;&#x8BE5;&#x8BC4;&#x8BBA;&#x7684;&#x5173;&#x952E;&#x8BCD;&#xFF1B;</p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>nice B000F83SZQ+A1F6404F1VG29J    0.15 &#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09;</p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong> B000F83SZQ+A1F6404F1VG29J    nice </p>
<p>4.&#x5728;&#x83B7;&#x53D6;&#x5230;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x8BE5;&#x8BC4;&#x8BBA;&#x6240;&#x8BC4;&#x8BBA;&#x7684;&#x5546;&#x54C1;&#x8FDB;&#x884C;&#x6C47;&#x603B;&#xFF0C;&#x4EE5;&#x964D;&#x4F4E;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x63D0;&#x9AD8;&#x4E0B;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x4F7F;&#x7528;Python&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5206;&#x6790;&#x7684;&#x6548;&#x7387;&#xFF1B;</p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong> B000F83SZQ+A1F6404F1VG29J    nice&#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09; </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong> B000F83SZQ nice      5 </p>
<p>5.&#x6839;&#x636E;&#x524D;&#x9762;&#x8BA1;&#x7B97;&#x51FA;&#x7684;&#x4E0D;&#x540C;&#x5546;&#x54C1;&#x7684;&#x6700;&#x7EC8;&#x8BC4;&#x5206;&#xFF0C;&#x5229;&#x7528;Python&#x5BF9;&#x5546;&#x54C1;&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x6570;&#x76EE;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#xFF0C;&#x5F97;&#x51FA;&#x4E0D;&#x540C;&#x8BC4;&#x5206;&#x533A;&#x95F4;&#x4E0B;&#x9AD8;&#x9891;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x8FDB;&#x800C;&#x5206;&#x6790;&#x8BC4;&#x8BBA;&#x5185;&#x5BB9;&#x5BF9;&#x5546;&#x54C1;&#x8BC4;&#x5206;&#x7684;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6839;&#x636E;&#x6240;&#x5F97;&#x51FA;&#x7684;&#x4E0D;&#x540C;&#x8BC4;&#x5206;&#x533A;&#x95F4;&#x4E0B;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x5229;&#x7528;Python&#x7ED8;&#x5236;&#x6210;&#x56FE;&#x4E91;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/level.jpg" alt="img"></p>
<p>&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x3001;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#x5206;&#x5E03;&#x4E3A;&#x5546;&#x54C1;&#x8BC4;&#x5206;&#x5728;[1,2), [2,3), [3,4), [4,5)&#xFF0C;[5,5]&#x8BC4;&#x8BBA;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x8BCD;&#x4E91;&#x5206;&#x5E03;&#x56FE;&#x3002;</p>
<p>&#x4ECE;&#x56FE;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;</p>
<p>&#x2022;   &#x56E0;&#x4E3A;&#x4E00;&#x661F;&#x8BC4;&#x4EF7;&#x7684;&#x5546;&#x54C1;&#x6BD4;&#x8F83;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x5176;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x4E5F;&#x8F83;&#x5C11;&#xFF0C;&#x4E14;&#x901A;&#x8FC7;TF-IDF&#x8BC6;&#x522B;&#x51FA;&#x6765;&#x7684;&#x5173;&#x952E;&#x5B57;&#x4E2D;&#x591A;&#x4E3A;&#x59D3;&#x540D;&#xFF0C;&#x4E0D;&#x5177;&#x6709;&#x4EE3;&#x8868;&#x6027;&#xFF1B;</p>
<p>&#x2022;   &#x5728;&#x4E8C;&#x661F;&#x3001;&#x4E09;&#x661F;&#x8BC4;&#x4EF7;&#x7684;&#x5546;&#x54C1;&#x4E2D;&#xFF0C;&#x591A;&#x4E3A;waste&#x3001;horrible&#x3001;deleted&#x7B49;&#x8D1F;&#x9762;&#x8BCD;&#x8BED;&#xFF0C;&#x4E0E;&#x6211;&#x4EEC;&#x7684;&#x8BA4;&#x77E5;&#x76F8;&#x4E00;&#x81F4;&#xFF1B;</p>
<p>&#x2022;   &#x5728;&#x56DB;&#x661F;&#x3001;&#x4E94;&#x661F;&#x8BC4;&#x4EF7;&#x7684;&#x5546;&#x54C1;&#x4E2D;&#xFF0C;&#x591A;&#x4E3A;recipes&#x3001;diet&#x7B49;&#x98DF;&#x8C31;&#x7C7B;&#x7684;&#x63CF;&#x8FF0;&#x8BCD;&#x8BED;&#xFF0C;&#x53EF;&#x80FD;&#x98DF;&#x8C31;&#x7C7B;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x5747;&#x8F83;&#x9AD8;&#xFF1B;&#x540C;&#x65F6;&#x8FD8;&#x5B58;&#x5728;&#x7740;&#x90E8;&#x5206;cute&#x3001;Christmas&#x3001;children&#x3001;kids&#x7B49;&#x8BCD;&#x8BED;&#xFF0C;&#x53EF;&#x80FD;&#x513F;&#x7AE5;&#x7C7B;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x8F83;&#x9AD8;&#x3002;</p>
<h3 id="3-3-&#x5404;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x57FA;&#x51C6;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;"><a href="#3-3-&#x5404;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x57FA;&#x51C6;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;" class="headerlink" title="3.3   &#x5404;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x57FA;&#x51C6;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;"></a><strong>3.3</strong>   <strong>&#x5404;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x57FA;&#x51C6;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;</strong></h3><p>&#x8BFB;&#x5165;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x4EE5;&#x5546;&#x54C1;&#x7F16;&#x53F7;&#x4F5C;&#x4E3A;&#x952E;&#xFF0C;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x4F5C;&#x4E3A;&#x503C;&#xFF0C;&#x5229;&#x7528;MapReduce&#x8BA1;&#x7B97;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#xFF1A;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>Overall.java</strong><sup><a href="#fn_3" id="reffn_3">3</a></sup></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: B000F83SZQ&#xFF08;&#x5546;&#x54C1;&#x7F16;&#x53F7;&#xFF09;  value: 4.89&#xFF08;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#xFF09;</p>
<p>&#x5F97;&#x5230;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#xFF0C;&#x90E8;&#x5206;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>B000QCS8YM 5.0<br>B000QFOD8E 3.5<br>B000QUCOB2 4.285714<br>B000R3NNAE 4.4444447<br>B000R93D4Y 3.96<br>B000R93D8U 3.5 </p>
<p>&#x4E4B;&#x540E;&#x5229;&#x7528;&#x5546;&#x54C1;&#x53CA;&#x5176;&#x8BC4;&#x7EA7;&#xFF0C;&#x7EDF;&#x8BA1;&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x603B;&#x6570;&#xFF0C;&#x5546;&#x54C1;&#x6700;&#x7EC8;&#x8BC4;&#x7EA7;&#x89C6;&#x4E3A;&#x8BC4;&#x7EA7;&#x6574;&#x6570;&#x90E8;&#x7684;&#x6570;&#x503C;&#x5927;&#x5C0F;&#xFF1A;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>CountOverall.java</strong><sup><a href="#fn_4" id="reffn_4">4</a></sup></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>B000F83SZQ  4.89 </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: 1&#xFF08;&#x5546;&#x54C1;&#x7B49;&#x7EA7;&#xFF09;  value: 64&#xFF08;&#x5546;&#x54C1;&#x6570;&#x91CF;&#xFF09; </p>
<p>&#x5229;&#x7528;Python&#x7EDF;&#x8BA1;&#x51FA;&#x8BC4;&#x7EA7;&#x5404;&#x9636;&#x6BB5;&#x7684;&#x5546;&#x54C1;&#x603B;&#x6570;&#x76EE;&#xFF0C;&#x5E76;&#x7ED8;&#x5236;&#x6210;&#x67F1;&#x72B6;&#x56FE;&#x5982;&#x4E0B;&#xFF08;Python&#x4EE3;&#x7801;&#xFF1A;print_models.py&#xFF09;&#xFF1A;<br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/overallBase.png" style="width: 60%"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x8BC4;&#x7EA7;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x5546;&#x54C1;&#x603B;&#x6570;</td>
<td>64</td>
<td>823</td>
<td>10734</td>
<td>45596</td>
<td>4717</td>
</tr>
</tbody>
</table>
</div>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;Kindle&#x7684;&#x5404;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x666E;&#x904D;&#x8F83;&#x9AD8;&#xFF0C;&#x96C6;&#x4E2D;&#x5728;4&#x661F;&#x5DE6;&#x53F3;&#xFF0C;&#x4E00;&#x661F;&#x548C;&#x4E8C;&#x661F;&#x7684;&#x5546;&#x54C1;&#x8F83;&#x5C11;&#xFF0C;&#x5B58;&#x5728;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#x7684;5&#x661F;&#x5546;&#x54C1;&#x3002;</p>
<h2 id="4-&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x4FEE;&#x6B63;"><a href="#4-&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x4FEE;&#x6B63;" class="headerlink" title="4    &#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x4FEE;&#x6B63;"></a><strong>4</strong>    <strong>&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x4FEE;&#x6B63;</strong></h2><h3 id="4-1-&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x6B21;&#x6570;&#x4E0E;&#x6574;&#x4F53;&#x8BC4;&#x7EA7;&#x7684;&#x6C34;&#x519B;&#x8BC6;&#x522B;"><a href="#4-1-&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x6B21;&#x6570;&#x4E0E;&#x6574;&#x4F53;&#x8BC4;&#x7EA7;&#x7684;&#x6C34;&#x519B;&#x8BC6;&#x522B;" class="headerlink" title="4.1   &#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x6B21;&#x6570;&#x4E0E;&#x6574;&#x4F53;&#x8BC4;&#x7EA7;&#x7684;&#x6C34;&#x519B;&#x8BC6;&#x522B;"></a><strong>4.1</strong>   <strong>&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x6B21;&#x6570;&#x4E0E;&#x6574;&#x4F53;&#x8BC4;&#x7EA7;&#x7684;&#x6C34;&#x519B;&#x8BC6;&#x522B;</strong></h3><p>1.&#x5229;&#x7528;&#x4E4B;&#x524D;&#x5199;&#x7684;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x65E5;&#x671F;&#x8BC4;&#x8BBA;&#x6570;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x589E;&#x52A0;&#x6761;&#x4EF6;&#xFF0C;&#x7B5B;&#x9009;&#x51FA;&#x8BC4;&#x8BBA;&#x6570;&#x8D85;&#x8FC7;20&#x6761;&#x7684;&#x8BB0;&#x5F55;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>CommentCountByDateOver20.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: 2000-03-05   value: 1 </p>
<p>2.&#x8F93;&#x5165;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x8BA1;&#x7B97;&#x6BCF;&#x4F4D;&#x8BC4;&#x8BBA;&#x8005;&#x6BCF;&#x5929;&#x7684;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#xFF0C;&#x5F53;&#x4E00;&#x4F4D;&#x8BC4;&#x8BBA;&#x8005;&#x5728;&#x4E00;&#x5929;&#x4E4B;&#x5185;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#x8D85;&#x8FC7;&#x4E00;&#x5B9A;&#x6570;&#x76EE;&#x3B1;&#xFF0C;&#x6216;&#x8005;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#x5360;&#x6BD4;&#x5F53;&#x5929;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#x8D85;&#x8FC7;&#x67D0;&#x4E2A;&#x9608;&#x503C;&#x3B2;&#xFF0C;&#x6211;&#x4EEC;&#x6000;&#x7591;&#x8BE5;&#x8BC4;&#x8BBA;&#x8005;&#x53EF;&#x80FD;&#x662F;&#x804C;&#x4E1A;&#x5237;&#x8BC4;&#x4EBA;&#x5458;&#xFF0C;&#x6700;&#x540E;&#x7528;&#x51FD;&#x6570;&#x6574;&#x7406;&#x7ED3;&#x679C;&#xFF0C;&#x5F97;&#x5230;&#x8FD9;&#x4E9B;&#x4EBA;&#x7684;&#x8BC4;&#x8BBA;ID&#x3002;</p>
<script type="math/tex; mode=display">
某人当天评论数 > \alpha \quad||\quad\frac{某人当天评论数}{当天评论总数} > \beta</script><p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>IsPaidPoster1.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: 2014-05-05,A1F6404F1VG29J   value: 20 </p>
<p>&#x8BBE;&#x7F6E;&#x3B1;=15&#xFF0C;&#x3B2;=0.25&#xFF0C;&#x5F97;&#x5230;&#x6F5C;&#x5728;&#x5237;&#x8BC4;&#x4EBA;&#x5458;60&#x4EBA;&#xFF0C;&#x90E8;&#x5206;ID&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>A320TMDV6KCFU  A2YXNKWOGHP6AW   AAK9CEYIL2XL5   A9XRB71GIX26M AKE6711D72LTX  A1RXR105ND8OSH   A2AY83K9N60V38  A5IDWDZ2L1LA AAVZOTZWVQYRV  A1BSKHVCABJFXN 3FOL8CN5A1TFR</p>
<p>3.&#x8F93;&#x5165;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x8BA1;&#x7B97;&#x6BCF;&#x4F4D;&#x8BC4;&#x8BBA;&#x8005;&#x6240;&#x6709;&#x8BC4;&#x7EA7;&#x7684;&#x5747;&#x503C;&#x4E0E;&#x65B9;&#x5DEE;&#xFF0C;&#x5F53;&#x4E00;&#x4F4D;&#x8BC4;&#x8BBA;&#x8005;&#x6240;&#x6709;&#x8BC4;&#x7EA7;&#x7684;&#x5747;&#x503C;&#x5927;&#x4E8E;4.9&#x6216;&#x5C0F;&#x4E8E;1.1&#xFF0C;&#x5E76;&#x4E14;&#x6240;&#x6709;&#x8BC4;&#x7EA7;&#x7684;&#x65B9;&#x5DEE;&#x5C0F;&#x4E8E;0.1&#xFF0C;&#x8FD9;&#x4E9B;&#x8BC4;&#x8BBA;&#x5747;&#x89C6;&#x4E3A;&#x6076;&#x8BC4;&#x6216;&#x597D;&#x8BC4;&#xFF0C;&#x6211;&#x4EEC;&#x6000;&#x7591;&#x8FD9;&#x4E9B;&#x8BC4;&#x8BBA;&#x8005;&#x53EF;&#x80FD;&#x662F;&#x6076;&#x610F;&#x5237;&#x8BC4;&#x4EBA;&#x5458;&#xFF0C;&#x5373;&#x4F7F;&#x4E0D;&#x662F;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;&#x8BC4;&#x8BBA;&#x4E5F;&#x5177;&#x6709;&#x6DF7;&#x6DC6;&#x4EA7;&#x54C1;&#x8BC4;&#x7EA7;&#x7684;&#x4E0D;&#x5F53;&#x5F71;&#x54CD;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x7B49;&#x540C;&#x4E8E;&#x6C34;&#x519B;&#x3002;&#x6700;&#x540E;&#x7528;&#x51FD;&#x6570;&#x6574;&#x7406;&#x7ED3;&#x679C;&#xFF0C;&#x53EA;&#x5F97;&#x5230;&#x8FD9;&#x4E9B;&#x4EBA;&#x7684;&#x8BC4;&#x8BBA;&#x7F16;&#x53F7;&#x3002;&#x4E3A;&#x4E86;&#x52A0;&#x5927;&#x8BE5;&#x5904;&#x7406;&#x7684;&#x53EF;&#x4FE1;&#x5EA6;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8003;&#x8651;&#x4E86;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#x5728;100&#x4EE5;&#x4E0A;&#x7684;&#x8BC4;&#x8BBA;&#x8005;&#x3002;</p>
<script type="math/tex; mode=display">
\begin{cases}
某人所有评论评级的均值>4.9\quad ||\quad某人所有评论评级的均值<0.1 \\
某人所有评论评级的方差 < 0.1 \\
某人所有评论评级的数目 > 100
\end{cases}</script><p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>IsPaidPoster2.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: A12E0W3IY6RJM   value: 4.9606986  0.037756715 </p>
<p>&#x6700;&#x7EC8;&#x5F97;&#x5230;&#x6F5C;&#x5728;&#x6076;&#x8BC4;&#x4EBA;&#x5458;144&#x4F4D;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;&#x90E8;&#x5206;ID&#x5982;&#x4E0B;&#xFF1A;</p>
<p>A107QCQSFVT6VN    A10C4X94VN9IG8    A1141DEY00149Z    A12E0W3IY6RJMA12NCJPL1Y3AH4    A13D5S4OXQUPRM    A141H51I3H4B1S A17YQQLSTXODGV A18L0QYPXCUD8E    A18YWXFF8FFGB2    A19BBQS3X97H2B</p>
<p>&#x5C06;&#x4E24;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x6C47;&#x603B;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E86;199&#x4F4D;&#x6F5C;&#x5728;&#x8BC4;&#x8BBA;&#x4E0D;&#x5F53;&#x7528;&#x6237;&#xFF0C;&#x5176;&#x4E2D;5&#x4F4D;&#x517C;&#x5177;&#x5237;&#x8BC4;&#x4E0E;&#x6076;&#x610F;&#x8BC4;&#x8BBA;&#x4E24;&#x6761;&#x6027;&#x8D28;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;ID&#x4EE5;&#x53CA;&#x6635;&#x79F0;&#x5982;&#x4E0B;&#xFF1A;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>&#x6635;&#x79F0;</th>
</tr>
</thead>
<tbody>
<tr>
<td>A1ENV91MFAEVA3</td>
<td>JoT</td>
</tr>
<tr>
<td>A24F8TZ7WU4JDQ</td>
<td>Rebecca Palmer</td>
</tr>
<tr>
<td>A28MPK002D2WJ1</td>
<td>AA</td>
</tr>
<tr>
<td>A3M7QUA7XT7XIM</td>
<td>Jr.</td>
</tr>
<tr>
<td>A3PTWPKPXOG8Y5</td>
<td>Alexis</td>
</tr>
</tbody>
</table>
</div>
<p>&#x5229;&#x7528;&#x4E4B;&#x524D;&#x5199;&#x7684;&#x7EDF;&#x8BA1;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#x7684;&#x4EE3;&#x7801;Overall.java&#xFF0C;&#x589E;&#x52A0;&#x6761;&#x4EF6;&#xFF0C;&#x5254;&#x9664;&#x6C34;&#x519B;&#x7684;&#x8BC4;&#x8BBA;&#xFF0C;&#x786E;&#x4FDD;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x6709;&#x6548;&#x6027;&#x3002;&#x5F97;&#x5230;&#x65B0;&#x7684;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x8BC4;&#x7EA7;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>OverallClean.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: B000F83SZQ&#xFF08;&#x5546;&#x54C1;&#x7F16;&#x53F7;&#xFF09;  value: 4.25&#xFF08;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#xFF09;</p>
<p>&#x5229;&#x7528;&#x5546;&#x54C1;&#x53CA;&#x5176;&#x8BC4;&#x7EA7;&#xFF0C;&#x91CD;&#x65B0;&#x7EDF;&#x8BA1;&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x603B;&#x6570;&#xFF0C;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x6574;&#x6570;&#x90E8;&#x7684;&#x6570;&#x503C;&#x5927;&#x5C0F;&#x89C6;&#x4E3A;&#x6700;&#x7EC8;&#x8BC4;&#x7EA7;&#x3002;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x8BC4;&#x7EA7;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x5546;&#x54C1;&#x603B;&#x6570;</td>
<td>70</td>
<td>872</td>
<td>11056</td>
<td>45033</td>
<td>4902</td>
</tr>
</tbody>
</table>
</div>
<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x7ECF;&#x8FC7;&#x5904;&#x7406;&#xFF0C;&#x5546;&#x54C1;&#x603B;&#x6570;&#x51CF;&#x5C11;&#x4E86;1&#x4E2A;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x4E8B;&#x5B9E;&#x4FBF;&#x662F;&#xFF0C;&#x5C11;&#x4E86;&#x7684;&#x5546;&#x54C1;&#x7684;&#x5168;&#x90E8;&#x8BC4;&#x8BBA;&#x5747;&#x7531;&#x6C34;&#x519B;&#x5E26;&#x6765;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#x5747;&#x662F;&#x6211;&#x4EEC;&#x8BA4;&#x5B9A;&#x7684;&#x65E0;&#x6548;&#x8BC4;&#x8BBA;&#x3002;&#x8BE5;&#x5546;&#x54C1;&#x7684;AsinID&#x53CA;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#x4E3A;&#xFF1A;</p>
<p>B00IT2GHAS 5.0</p>
<p>&#x622A;&#x6B62;2018&#x5E74;12&#x6708;&#xFF0C;&#x8BE5;&#x5546;&#x54C1;&#x5177;&#x4F53;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/gay.png" alt="img"></p>
<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x73B0;&#x9636;&#x6BB5;&#x8BE5;&#x5546;&#x54C1;&#x589E;&#x52A0;&#x4E86;&#x8BB8;&#x591A;1&#x661F;&#x8BC4;&#x8BBA;&#xFF0C;&#x800C;&#x4E14;&#x5B83;&#x7684;&#x8BC4;&#x7EA7;&#x5448;&#x73B0;5&#x661F;&#x548C;1&#x661F;&#x7684;&#x4E24;&#x6781;&#x5316;&#x8D8B;&#x52BF;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8BE5;&#x5546;&#x54C1;&#x5F88;&#x53EF;&#x80FD;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x731C;&#x60F3;&#xFF0C;&#x5168;&#x90E8;&#x8BC4;&#x8BBA;&#x5747;&#x7531;&#x6C34;&#x519B;&#x5E26;&#x6765;&#xFF0C;&#x5B58;&#x5728;&#x4E0D;&#x5B9E;&#x8BC4;&#x4EF7;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="4-2-&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x65F6;&#x6548;&#x6027;&#x53CA;&#x5E2E;&#x52A9;&#x5EA6;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;"><a href="#4-2-&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x65F6;&#x6548;&#x6027;&#x53CA;&#x5E2E;&#x52A9;&#x5EA6;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;" class="headerlink" title="4.2   &#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x65F6;&#x6548;&#x6027;&#x53CA;&#x5E2E;&#x52A9;&#x5EA6;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;"></a><strong>4.2</strong>   <strong>&#x57FA;&#x4E8E;&#x8BC4;&#x8BBA;&#x65F6;&#x6548;&#x6027;&#x53CA;&#x5E2E;&#x52A9;&#x5EA6;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;</strong></h3><p>&#x4F9D;&#x636E;&#x8BC4;&#x8BBA;&#x7684;&#x5E2E;&#x52A9;&#x8BC4;&#x5206;&#x4E0E;&#x8BC4;&#x8BBA;&#x65F6;&#x95F4;&#xFF0C;&#x8D4B;&#x4E88;&#x6BCF;&#x4E2A;&#x8BC4;&#x7EA7;&#x4E0D;&#x540C;&#x5E2E;&#x52A9;&#x5EA6;&#x4E0E;&#x65F6;&#x6548;&#x6027;&#x7684;&#x6743;&#x91CD;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x5254;&#x9664;&#x6C34;&#x519B;&#x540E;&#x7684;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x539F;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x5229;&#x7528;&#x4E4B;&#x524D;&#x5199;&#x7684;&#x7EDF;&#x8BA1;&#x5254;&#x9664;&#x6C34;&#x519B;&#x540E;&#x7684;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;&#x7684;&#x4EE3;&#x7801;OverallClean.java&#xFF0C;&#x878D;&#x5165;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x8BC4;&#x7EA7;&#x6743;&#x91CD;&#x4FE1;&#x606F;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x6BCF;&#x79CD;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x3002;&#x53C2;&#x8003;&#x53C2;&#x6570;helpful&#x53CA;unixReviewTime&#xFF0C;&#x8BA1;&#x7B97;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x5E2E;&#x52A9;&#x5EA6;&#x4EE5;&#x53CA;&#x65F6;&#x6548;&#x6027;&#x3002;</p>
<p>&#x3010;&#x5E2E;&#x52A9;&#x5EA6;&#x3011;&#x5F53;&#x4E00;&#x6761;&#x8BC4;&#x8BBA;&#x6CA1;&#x6709;&#x5E2E;&#x52A9;&#x5EA6;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x672C;&#x6761;&#x5173;&#x4E8E;&#x8BE5;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x8BBA;&#x8BBE;&#x4E3A;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x6709;&#x5E2E;&#x52A9;&#x5EA6;&#x7684;&#x5747;&#x503C;&#xFF0C;&#x5E73;&#x5747;&#x5176;&#x91CD;&#x8981;&#x5EA6;&#x3002;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x4E3A;(0, 1]&#xFF1B;</p>
<p>&#x3010;&#x65F6;&#x6548;&#x6027;&#x3011;&#x6211;&#x4EEC;&#x7528;&#x8BC4;&#x8BBA;&#x65F6;&#x95F4;&#x6233;&#x6BD4;&#x4E0A;&#x6700;&#x65B0;&#x7684;2014-7-23&#xFF0C;&#x5373;unixTime=1406073600&#x7684;&#x7ED3;&#x679C;&#x518D;&#x5E73;&#x65B9;&#xFF08;&#x4EE5;&#x589E;&#x52A0;&#x533A;&#x522B;&#x5EA6;&#xFF09;&#xFF0C;&#x5F53;&#x505A;&#x65F6;&#x6548;&#x6027;&#x7684;&#x53C2;&#x6570;&#x3002;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x4E3A;(0, 1]&#xFF1B;</p>
<script type="math/tex; mode=display">
\begin{cases}
针对同一商品，每条评论评级的得分为ax_i + by_i \\
针对同一商品，每条评论评级的权重为\frac{ax_i + by_i}{(ax_1 + by_1 + \cdots + ax_n + by_n)}
\end{cases}\\
其中，帮助度为x,时效性为y</script><p>&#x8BBE;&#x7F6E;&#x5E2E;&#x52A9;&#x5EA6;&#x7CFB;&#x6570;a=1&#xFF0C;&#x65F6;&#x6548;&#x6027;&#x7CFB;&#x6570;&#x4E3A;b=1&#xFF0C;&#x5373;&#xFF0C;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x5E2E;&#x52A9;&#x5EA6;&#x4E0E;&#x65F6;&#x6548;&#x6027;&#x540C;&#x7B49;&#x91CD;&#x8981;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>OverallWeights.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: B000F83SZQ&#xFF08;&#x5546;&#x54C1;&#x7F16;&#x53F7;&#xFF09;  value: 4.249840640960779&#xFF08;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#xFF09;</p>
<p>&#x5229;&#x7528;&#x5546;&#x54C1;&#x53CA;&#x5176;&#x8BC4;&#x7EA7;&#xFF0C;&#x91CD;&#x65B0;&#x7EDF;&#x8BA1;&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x603B;&#x6570;&#xFF0C;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x6574;&#x6570;&#x90E8;&#x7684;&#x6570;&#x503C;&#x5927;&#x5C0F;&#x89C6;&#x4E3A;&#x6700;&#x7EC8;&#x8BC4;&#x7EA7;&#x3002;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x8BC4;&#x7EA7;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x5546;&#x54C1;&#x603B;&#x6570;</td>
<td>88</td>
<td>1086</td>
<td>12775</td>
<td>43082</td>
<td>4902</td>
</tr>
</tbody>
</table>
</div>
<p>&#x5229;&#x7528;Python&#x7ED8;&#x5236;&#x6210;&#x6298;&#x7EBF;&#x56FE;&#xFF0C;&#x5BF9;&#x6BD4;&#x4E09;&#x9636;&#x6BB5;&#x7684;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x9996;&#x5148;&#x662F;&#x5404;&#x9636;&#x6BB5;&#x8BC4;&#x7EA7;&#x5546;&#x54C1;&#x603B;&#x6570;&#xFF08;Python&#x4EE3;&#x7801;&#xFF1A;print_zhe.py&#xFF09;&#xFF1A;<br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/overall.png" style="width: 60%"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x8BC4;&#x7EA7;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>overall</td>
<td>64</td>
<td>823</td>
<td>10724</td>
<td>45596</td>
<td>4717</td>
</tr>
<tr>
<td>overallClean</td>
<td>70</td>
<td>872</td>
<td>11056</td>
<td>45033</td>
<td>4902</td>
</tr>
<tr>
<td>overallWeights</td>
<td>88</td>
<td>1086</td>
<td>12775</td>
<td>43082</td>
<td>4902</td>
</tr>
</tbody>
</table>
</div>
<p>&#x7ECF;&#x8FC7;&#x4E0D;&#x65AD;&#x7684;&#x8C03;&#x6574;&#xFF0C;&#x56DB;&#x661F;&#x7EA7;&#x5546;&#x54C1;&#x6570;&#x5728;&#x9010;&#x6E10;&#x4E0B;&#x6ED1;&#x5230;&#x4E09;&#x661F;&#x7EA7;&#xFF0C;&#x4E00;&#x661F;&#x7EA7;&#x3001;&#x4E8C;&#x661F;&#x7EA7;&#x5546;&#x54C1;&#x6570;&#x4E5F;&#x6709;&#x5FAE;&#x91CF;&#x589E;&#x591A;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x8BC4;&#x7EA7;&#x7CFB;&#x7EDF;&#x53D8;&#x5F97;&#x8D8A;&#x6765;&#x8D8A;&#x4E25;&#x683C;&#x3002;</p>
<p>&#x540C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x89C2;&#x5BDF;&#x5230;&#x8BC4;&#x7EA7;&#x4E3A;5&#x7684;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x5728;&#x5254;&#x9664;&#x6C34;&#x519B;&#x540E;&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x6211;&#x4EEC;&#x5206;&#x6790;&#x53EF;&#x80FD;&#x662F;&#x6709;&#x7ADE;&#x4E89;&#x5BF9;&#x624B;&#x6076;&#x610F;&#x5237;&#x8BC4;&#x5BFC;&#x81F4;&#x8BC4;&#x5206;&#x4E0B;&#x964D;&#x3002;&#x7136;&#x800C;&#x8FDB;&#x884C;&#x4E86;&#x6743;&#x91CD;&#x4FEE;&#x6539;&#x540E;&#x8BC4;&#x7EA7;&#x4E3A;5&#x7684;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x6CA1;&#x6709;&#x6539;&#x52A8;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x8BC4;&#x7EA7;&#x4E3A;5&#x7684;&#x5546;&#x54C1;&#x5FC5;&#x987B;&#x7B26;&#x5408;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x5747;&#x4E3A;5&#x661F;&#xFF0C;&#x8FD9;&#x6837;&#xFF0C;&#x65E0;&#x8BBA;&#x6211;&#x4EEC;&#x5982;&#x4F55;&#x4FEE;&#x6539;&#x6743;&#x91CD;&#xFF0C;&#x90FD;&#x65E0;&#x6CD5;&#x6539;&#x53D8;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x7EA7;&#x3002;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x8BC4;&#x8BBA;&#x6570;&#x4E0E;&#x9500;&#x552E;&#x91CF;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x6210;&#x6B63;&#x6BD4;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C06;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x7C7B;&#x6BD4;&#x4E3A;&#x5546;&#x54C1;&#x53D7;&#x6B22;&#x8FCE;&#x7A0B;&#x5EA6;&#xFF0C;&#x4EE5;&#x4E0B;&#x662F;&#x5404;&#x9636;&#x6BB5;&#x5546;&#x54C1;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6761;&#x6570;&#xFF08;&#x4FDD;&#x7559;&#x4E24;&#x4F4D;&#x5C0F;&#x6570;&#xFF09;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>AvgReview.java</strong><br><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/overallAvgReview.png" style="width: 60%"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x8BC4;&#x7EA7;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>overall</td>
<td>7.06</td>
<td>9.54</td>
<td>14.64</td>
<td>16.54</td>
<td>6.62</td>
</tr>
<tr>
<td>overallClean</td>
<td>7.07</td>
<td>9.53</td>
<td>14.54</td>
<td>16.63</td>
<td>6.58</td>
</tr>
<tr>
<td>overallWeights</td>
<td>6.91</td>
<td>8.91</td>
<td>13.83</td>
<td>16.98</td>
<td>6.58</td>
</tr>
</tbody>
</table>
</div>
<p>&#x6574;&#x4F53;&#x4E0A;&#x5206;&#x6790;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#xFF0C;1~4&#x7EA7;&#x8BC4;&#x7EA7;&#x9012;&#x589E;&#x65F6;&#xFF0C;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x4E5F;&#x662F;&#x4F9D;&#x6B21;&#x9012;&#x589E;&#x7684;&#xFF0C;&#x7B26;&#x5408;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x5047;&#x8BBE;&#xFF0C;&#x5373;&#x8BC4;&#x8BBA;&#x6570;&#x4E0E;&#x9500;&#x552E;&#x91CF;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x6210;&#x6B63;&#x6BD4;&#x3002;&#x53CD;&#x89C2;5&#x661F;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x5374;&#x53C8;&#x6709;&#x6700;&#x4F4E;&#x7684;&#x8BC4;&#x8BBA;&#x91CF;&#xFF0C;&#x6211;&#x4EEC;&#x731C;&#x6D4B;5&#x661F;&#x8BC4;&#x7EA7;&#x5546;&#x54C1;&#x4F1A;&#x66F4;&#x5C11;&#x6709;&#x4E89;&#x8BAE;&#xFF0C;&#x5C11;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x5410;&#x69FD;&#x8BC4;&#x8BBA;&#xFF0C;&#x8D2D;&#x4E70;&#x8005;&#x610F;&#x89C1;&#x8F83;&#x4E3A;&#x4E00;&#x81F4;&#xFF0C;&#x4F1A;&#x66F4;&#x591A;&#x7684;&#x9009;&#x62E9;&#x70B9;&#x8D5E;&#x5E2E;&#x52A9;&#x8BC4;&#x5206;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x81EA;&#x884C;&#x8BC4;&#x4EF7;&#xFF0C;&#x540C;&#x65F6;&#x4F1A;&#x6709;&#x66F4;&#x591A;&#x7684;&#x56DE;&#x8D2D;&#x7528;&#x6237;&#xFF0C;&#x800C;&#x56DE;&#x8D2D;&#x7528;&#x6237;&#x5F80;&#x5F80;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;&#x4E8C;&#x6B21;&#x8BC4;&#x4EF7;&#x3002;</p>
<p>&#x200B;    &#x5206;&#x5F00;&#x6765;&#x770B;&#x4E09;&#x6761;&#x6298;&#x7EBF;&#xFF0C;&#x7ECF;&#x8FC7;&#x4E0D;&#x65AD;&#x7684;&#x8C03;&#x6574;&#xFF0C;1~4&#x661F;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x9012;&#x589E;&#x66F2;&#x7EBF;&#x53D8;&#x5F97;&#x6108;&#x52A0;&#x9661;&#x5CED;&#xFF0C;&#x5177;&#x4F53;&#x8868;&#x73B0;&#x4E3A;&#x8BC4;&#x7EA7;&#x4E3A;1~3&#x7684;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x5747;&#x5728;&#x4E0D;&#x65AD;&#x4E0B;&#x964D;&#xFF0C;&#x800C;&#x8BC4;&#x7EA7;&#x4E3A;4&#x7684;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x5728;&#x4E0D;&#x65AD;&#x4E0A;&#x5347;&#x3002;&#x8BC4;&#x7EA7;&#x4E0D;&#x540C;&#xFF0C;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x7684;&#x5DEE;&#x8DDD;&#x4E5F;&#x5728;&#x62C9;&#x5927;&#x3002;</p>
<h3 id="4-3-&#x57FA;&#x4E8E;CoreNLP&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x611F;&#x8BC6;&#x522B;"><a href="#4-3-&#x57FA;&#x4E8E;CoreNLP&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x611F;&#x8BC6;&#x522B;" class="headerlink" title="4.3   &#x57FA;&#x4E8E;CoreNLP&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x611F;&#x8BC6;&#x522B;"></a><strong>4.3</strong>   <strong>&#x57FA;&#x4E8E;</strong>CoreNLP&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x611F;&#x8BC6;&#x522B;</h3><p>&#x6B63;&#x5982;&#x6211;&#x4EEC;&#x524D;&#x9762;&#x7684;&#x53D1;&#x73B0;&#xFF0C;&#x8BC4;&#x7EA7;&#x4E3A;5&#x7684;&#x5546;&#x54C1;&#x662F;&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x90FD;&#x4E0D;&#x4F1A;&#x518D;&#x88AB;&#x964D;&#x7EA7;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x5546;&#x54C1;&#x666E;&#x901A;&#xFF0C;&#x8BC4;&#x8BBA;&#x5F88;&#x5C11;&#xFF0C;&#x8BC4;&#x8BBA;&#x91CC;&#x63CF;&#x8FF0;&#x5E73;&#x5E73;&#x7684;&#xFF0C;&#x5C31;&#x56E0;&#x4E3A;&#x4EC5;&#x6709;&#x7684;&#x51E0;&#x6761;&#x8BC4;&#x8BBA;&#x5C31;&#x80FD;&#x4FDD;&#x6301;5&#x661F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x663E;&#x7136;&#x662F;&#x4E0D;&#x7B26;&#x5408;&#x5B9E;&#x9645;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x8BC4;&#x7EA7;&#x672C;&#x8EAB;&#x5C31;&#x5341;&#x5206;&#x4E0D;&#x4E25;&#x8C28;&#xFF0C;&#x5916;&#x52A0;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x8BC4;&#x7EA7;&#x4E3A;5&#x661F;&#x7684;&#x5546;&#x54C1;&#x5374;&#x62E5;&#x6709;&#x6700;&#x4F4E;&#x7684;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x7684;&#x73B0;&#x72B6;&#xFF0C;&#x6211;&#x4EEC;&#x610F;&#x8BC6;&#x5230;&#x4E86;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x661F;&#x7EA7;&#x672C;&#x8EAB;&#x4E5F;&#x9700;&#x8981;&#x5177;&#x6709;&#x51C6;&#x786E;&#x6027;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x8FD8;&#x53D1;&#x73B0;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EBA;&#x7684;&#x8BC4;&#x8BBA;&#x6807;&#x51C6;&#x90FD;&#x4E0D;&#x5927;&#x76F8;&#x540C;&#xFF0C;&#x6709;&#x7684;&#x4EBA;&#x8981;&#x6C42;&#x4E25;&#x683C;&#xFF0C;&#x8BC4;&#x5206;&#x6574;&#x4F53;&#x504F;&#x4F4E;&#xFF0C;&#x6709;&#x7684;&#x4EBA;&#x6BD4;&#x8F83;&#x968F;&#x610F;&#xFF0C;&#x8BC4;&#x5206;&#x5FFD;&#x9AD8;&#x5FFD;&#x4F4E;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x5FC5;&#x8981;&#x7ED9;&#x51FA;&#x79D1;&#x5B66;&#x7684;&#x8BC4;&#x7EA7;&#x65B9;&#x5F0F;&#xFF0C;&#x518D;&#x7ED3;&#x5408;&#x539F;&#x672C;&#x7684;&#x8BC4;&#x7EA7;&#xFF0C;&#x5BF9;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x672C;&#x8EAB;&#x7684;&#x661F;&#x7EA7;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x60C5;&#x611F;&#x5206;&#x6790;&#x662F;&#x6307;&#x5229;&#x7528;&#x673A;&#x5668;&#x63D0;&#x53D6;&#x4EBA;&#x4EEC;&#x5BF9;&#x67D0;&#x4EBA;&#x6216;&#x4E8B;&#x7269;&#x7684;&#x6001;&#x5EA6;&#xFF0C;&#x4ECE;&#x800C;&#x53D1;&#x73B0;&#x6F5C;&#x5728;&#x7684;&#x95EE;&#x9898;&#x7528;&#x4E8E;&#x6539;&#x8FDB;&#x6216;&#x9884;&#x6D4B;&#x3002;&#x5546;&#x54C1;&#x7684;&#x8BC4;&#x4EF7;&#x5206;&#x4E3A;&#x661F;&#x7EA7;&#x8BC4;&#x4EF7;&#x548C;&#x6587;&#x672C;&#x8BC4;&#x4EF7;&#x3002;&#x661F;&#x7EA7;&#x8BC4;&#x4EF7;&#x548C;&#x597D;&#x8BC4;&#x7387;&#x5728;&#x6392;&#x5E8F;&#x7B97;&#x6CD5;&#x4E2D;&#x5360;&#x636E;&#x91CD;&#x8981;&#x5730;&#x4F4D;&#x3002;&#x6709;&#x7684;&#x5546;&#x5BB6;&#x4E3A;&#x4E86;&#x63D0;&#x5347;&#x6392;&#x540D;&#xFF0C;&#x91C7;&#x53D6;&#x201C;&#x4E94;&#x661F;&#x597D;&#x8BC4;&#x8FD4;&#x73B0;&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8BF1;&#x5BFC;&#x987E;&#x5BA2;&#x597D;&#x8BC4;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x7528;&#x6237;&#x53EF;&#x80FD;&#x5BF9;&#x5546;&#x54C1;&#x5E76;&#x4E0D;&#x6EE1;&#x610F;&#xFF0C;&#x56E0;&#x6B64;&#x4F1A;&#x5728;&#x6587;&#x672C;&#x8BC4;&#x8BBA;&#x6216;&#x8005;&#x8FFD;&#x52A0;&#x8BC4;&#x8BBA;&#x65F6;&#x8BF4;&#x51FA;&#x5BF9;&#x5546;&#x54C1;&#x4E0D;&#x6EE1;&#x610F;&#x7684;&#x771F;&#x5B9E;&#x8BC4;&#x4EF7;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x8BC4;&#x8BBA;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x60C5;&#x611F;&#x5206;&#x6790;&#x5E76;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x8BC4;&#x8BBA;&#x597D;&#x8BC4;&#x7387;&#x6765;&#x5BF9;&#x5546;&#x54C1;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x6392;&#x5E8F;&#xFF0C;&#x6307;&#x5BFC;&#x4EBA;&#x4EEC;&#x6839;&#x636E;&#x771F;&#x5B9E;&#x8BC4;&#x4EF7;&#x9009;&#x53D6;&#x5546;&#x54C1;&#x5C31;&#x5F88;&#x663E;&#x5F97;&#x6709;&#x610F;&#x4E49;&#x3002;&#x672C;&#x6587;&#x4E2D;&#xFF0C;&#x5229;&#x7528;CoreNLP&#x5305;&#x5BF9;&#x5546;&#x54C1;&#x8BC4;&#x8BBA;&#x8FDB;&#x884C;&#x60C5;&#x611F;&#x5206;&#x6790;&#xFF0C;&#x4EE5;&#x5BF9;&#x5546;&#x54C1;&#x8BC4;&#x5206;&#x8FDB;&#x884C;&#x77EB;&#x6B63;&#x3002;</p>
<p>&#x4E3A;&#x7B80;&#x5316;&#x6A21;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x505A;&#x51FA;&#x5982;&#x4E0B;&#x5047;&#x8BBE;&#xFF1A;</p>
<p>&#x2022; &#x8BC4;&#x8BBA;&#x4E2D;&#x957F;&#x5EA6;&#x6700;&#x957F;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x4EE3;&#x8868;&#x8BE5;&#x8BC4;&#x8BBA;&#x7684;&#x60C5;&#x611F;&#xFF1B;</p>
<p>&#x7531;&#x4E8E;&#xFF0C;&#x8BE5;&#x6A21;&#x578B;&#x8F83;&#x4E3A;&#x590D;&#x6742;&#xFF0C;&#x9700;&#x8981;&#x8FD0;&#x884C;&#x8F83;&#x957F;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x4EC5;&#x8FD0;&#x884C;&#x524D;1000&#x6761;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x636E;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;SentimentAnalysis.java</strong></p>
<p><strong>&#x8F93;&#x5165;&#xFF1A;</strong>{&#x201C;reviewerID&#x201D;: &#x201C;A1F6404F1VG29J&#x201D;, &#x201C;asin&#x201D;: &#x201C;B000F83SZQ&#x201D;, &#x201C;reviewerName&#x201D;: &#x201C;Avidreader&#x201D;, &#x201C;helpful&#x201D;: [0, 0], &#x201C;reviewText&#x201D;: &#x201C;I enjoy vintage &#x2026; for me.&#x201D;, &#x201C;overall&#x201D;: 5.0, &#x201C;summary&#x201D;: &#x201C;Nice vintage story&#x201D;, &#x201C;unixReviewTime&#x201D;: 1399248000, &#x201C;reviewTime&#x201D;: &#x201C;05 5, 2014&#x201D;} </p>
<p><strong>&#x8F93;&#x51FA;&#xFF1A;</strong>key: B000F83SZQ+A1F6404F1VG29J   value: 2 </p>
<p>&#x8F93;&#x51FA;&#x7684;value&#x503C;&#x8868;&#x793A;&#x8BC4;&#x8BBA;&#x7684;&#x6B63;&#x8D1F;&#x9762;&#x60C5;&#x7EEA;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;1~5&#x5206;&#x522B;&#x4EE3;&#x8868;&#x6781;&#x5EA6;&#x8D1F;&#x9762;&#x3001;&#x8D1F;&#x9762;&#x3001;&#x4E2D;&#x6027;&#x3001;&#x6B63;&#x9762;&#x3001;&#x6781;&#x5EA6;&#x6B63;&#x9762;&#xFF09;</p>
<p>&#x5217;&#x51FA;&#x77EB;&#x6B63;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">&#x5546;&#x54C1;&#x7F16;&#x53F7;</th>
<th>&#x8BC4;&#x8BBA;&#x8005;ID</th>
<th style="text-align:left">&#x539F;&#x8BC4;&#x7EA7;</th>
<th style="text-align:left">&#x77EB;&#x6B63;&#x8BC4;&#x7EA7;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">B000FA64PA</td>
<td>AQZH7YTWQPOBE</td>
<td style="text-align:left">4</td>
<td style="text-align:left">2</td>
</tr>
</tbody>
</table>
</div>
<p>&#x5185;&#x5BB9;&#xFF1A;This is a short story focused on Darth Maul&#x2019;s role in helping the Trade Federation gain a mining colony. It&#x2019;s not bad, but it&#x2019;s also nothing exceptional. It&#x2019;s fairly short so we don&#x2019;t really get to see any characters develop. The few events that do happen seem to go by quickly, including what should have been major battles. The story is included in the novelShadow Hunter (Star Wars: Darth Maul), which is worth reading, so don&#x2019;t bother to buy this one separately.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>&#x5546;&#x54C1;&#x7F16;&#x53F7;</th>
<th>&#x8BC4;&#x8BBA;&#x8005;ID</th>
<th>&#x539F;&#x8BC4;&#x7EA7;</th>
<th>&#x77EB;&#x6B63;&#x8BC4;&#x7EA7;</th>
</tr>
</thead>
<tbody>
<tr>
<td>B000FA64PK</td>
<td>A2QK1U70OJ74P</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
<p>&#x5185;&#x5BB9;&#xFF1A;Excellent! Very well written story, very exciting with LOTS of action. The bad guys trying to kill Leia and Han. Viki Shesh is introduced.</p>
<h3 id="4-4-&#x57FA;&#x4E8E;&#x65F6;&#x6548;&#x6027;&#x3001;&#x5E2E;&#x52A9;&#x6027;&#x3001;&#x60C5;&#x611F;&#x8BC6;&#x522B;&#x7684;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;"><a href="#4-4-&#x57FA;&#x4E8E;&#x65F6;&#x6548;&#x6027;&#x3001;&#x5E2E;&#x52A9;&#x6027;&#x3001;&#x60C5;&#x611F;&#x8BC6;&#x522B;&#x7684;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;" class="headerlink" title="4.4   &#x57FA;&#x4E8E;&#x65F6;&#x6548;&#x6027;&#x3001;&#x5E2E;&#x52A9;&#x6027;&#x3001;&#x60C5;&#x611F;&#x8BC6;&#x522B;&#x7684;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;"></a><strong>4.4</strong>   <strong>&#x57FA;&#x4E8E;&#x65F6;&#x6548;&#x6027;&#x3001;&#x5E2E;&#x52A9;&#x6027;&#x3001;&#x60C5;&#x611F;&#x8BC6;&#x522B;&#x7684;&#x4E66;&#x7C4D;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;</strong></h3><p>&#x4F9D;&#x636E;&#x60C5;&#x611F;&#x5206;&#x6790;&#x5F97;&#x5230;&#x7684;&#x77EB;&#x6B63;&#x8BC4;&#x7EA7;&#xFF0C;&#x4EE5;&#x53CA;&#x539F;&#x8BC4;&#x7EA7;&#xFF0C;&#x7EFC;&#x5408;&#x4E4B;&#x524D;&#x7684;&#x7EA0;&#x6B63;&#x65B9;&#x6CD5;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x60C5;&#x7EEA;&#x5206;&#x6790;1000&#x6761;&#x6570;&#x636E;&#x7684;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x3002;</p>
<p><strong>&#xB7;&#x53C2;&#x8003;&#x4EE3;&#x7801;</strong> <strong>OverallSentiment.java</strong></p>
<p>&#x5F97;&#x5230;&#x65B0;&#x7684;&#x5BF9;&#x6BD4;&#x6570;&#x636E;&#xFF1A;&#x5404;&#x8BC4;&#x7EA7;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x3001;&#x5404;&#x8BC4;&#x7EA7;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>1000&#x6761;&#x6570;&#x636E;&#x5904;&#x7406;&#x7ED3;&#x679C;</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x539F;&#xFF08;&#x5546;&#x54C1;&#x6570;&#x76EE;&#xFF09;</td>
<td>-</td>
<td>1</td>
<td>37</td>
<td>50</td>
<td>5</td>
</tr>
<tr>
<td>&#x77EB;&#x6B63;&#xFF08;&#x5546;&#x54C1;&#x6570;&#x76EE;&#xFF09;</td>
<td>-</td>
<td>10</td>
<td>75</td>
<td>8</td>
<td>-</td>
</tr>
<tr>
<td>&#x539F;&#xFF08;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#xFF09;</td>
<td>-</td>
<td>15.0</td>
<td>9.51</td>
<td>11.66</td>
<td>5.6</td>
</tr>
<tr>
<td>&#x77EB;&#x6B63;&#xFF08;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#xFF09;</td>
<td>-</td>
<td>10.4</td>
<td>10.96</td>
<td>6.5</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
<p>&#x7531;&#x4E8E;&#x6570;&#x636E;&#x91CF;&#x8F83;&#x5C11;&#xFF0C;&#x6574;&#x4F53;&#x5206;&#x6790;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x9488;&#x5BF9;&#x539F;&#x672C;&#x7684;&#x5904;&#x7406;&#x7ED3;&#x679C;&#xFF0C;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x662F;&#x6BD4;&#x8F83;&#x543B;&#x5408;&#x4E4B;&#x524D;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x5904;&#x7406;&#x7ED3;&#x679C;&#x7684;&#x8D8B;&#x52BF;&#x7684;&#xFF0C;&#x5373;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x96C6;&#x4E2D;&#x5904;&#x4E8E;4&#x7B49;&#x8BC4;&#x7EA7;&#x5DE6;&#x53F3;&#xFF0C;&#x4F46;&#x662F;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x5C31;&#x4E0E;&#x4E4B;&#x524D;&#x7684;&#x8D8B;&#x52BF;&#x4E0D;&#x7B26;&#xFF0C;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x6570;&#x636E;&#x91CF;&#x5C11;&#xFF0C;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x91C7;&#x96C6;&#x4E0D;&#x591F;&#x968F;&#x673A;&#x800C;&#x51FA;&#x73B0;&#x7684;&#x504F;&#x5DEE;&#xFF0C;&#x6240;&#x4EE5;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x91CF;&#x7684;&#x6D4B;&#x91CF;&#x5E76;&#x4E0D;&#x80FD;&#x53CD;&#x6620;&#x6837;&#x672C;&#x4EE3;&#x8868;&#x603B;&#x4F53;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x4FBF;&#x6210;&#x4E3A;&#x4E86;&#x6211;&#x4EEC;&#x5206;&#x6790;&#x7684;&#x91CD;&#x70B9;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x7684;&#x7ED3;&#x679C;&#x5BF9;&#x8BC4;&#x7EA7;&#x7ED3;&#x679C;&#x6709;&#x5341;&#x5206;&#x5927;&#x7684;&#x6539;&#x52A8;&#x3002;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x540E;&#x8BC4;&#x7EA7;&#x603B;&#x4F53;&#x5448;&#x4E0B;&#x964D;&#x8D8B;&#x52BF;&#xFF0C;&#x8BB8;&#x591A;4&#x661F;&#x5546;&#x54C1;&#x53D8;&#x6210;&#x4E86;3&#x661F;&#x5546;&#x54C1;&#xFF0C;5&#x661F;&#x5546;&#x54C1;&#x751A;&#x81F3;&#x5B8C;&#x5168;&#x6D88;&#x5931;&#xFF0C;&#x800C;2&#x7EA7;&#x5546;&#x54C1;&#x4EC5;&#x6709;&#x589E;&#x52A0;&#x5374;&#x6CA1;&#x6709;&#x4E0B;&#x964D;&#xFF0C;&#x6700;&#x7EC8;&#x5546;&#x54C1;&#x6570;&#x76EE;&#x7684;&#x6570;&#x636E;&#x96C6;&#x4E2D;&#x70B9;&#x53D8;&#x6210;&#x4E86;3&#x7B49;&#x8BC4;&#x7EA7;&#x3002;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x7684;&#x7ED3;&#x679C;&#x8BC4;&#x7EA7;&#x4E3A;5&#x6216;1&#x662F;&#x9C9C;&#x5C11;&#x7684;&#xFF0C;&#x5373;&#x8BC4;&#x8BBA;&#x5185;&#x5BB9;&#x60F3;&#x8981;&#x8FBE;&#x5230;&#x6781;&#x5EA6;&#x6B63;&#x9762;&#x6216;&#x6781;&#x5EA6;&#x8D1F;&#x9762;&#x662F;&#x5341;&#x5206;&#x56F0;&#x96BE;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x7684;&#x7ED3;&#x679C;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x5BF9;&#x504F;&#x597D;&#x5DEE;&#x5F02;&#x7684;&#x4FEE;&#x6B63;&#xFF0C;&#x7ED3;&#x679C;&#x8D34;&#x5408;&#x73B0;&#x5B9E;&#x4E2D;&#x6781;&#x5C11;&#x51FA;&#x73B0;&#x4E00;&#x81F4;&#x597D;&#x8BC4;&#x6216;&#x4E00;&#x81F4;&#x6076;&#x8BC4;&#x7684;&#x5224;&#x65AD;&#x60C5;&#x5F62;&#xFF0C;&#x5448;&#x73B0;&#x6BD4;&#x8F83;&#x4E2D;&#x7B49;&#x5BA2;&#x89C2;&#x7684;&#x8BC4;&#x5206;&#x60C5;&#x5F62;&#x3002;</p>
<h3 id="4-5-&#x90E8;&#x5206;&#x5F97;&#x5206;&#x8F83;&#x9AD8;&#x7535;&#x5B50;&#x4E66;&#x5217;&#x8868;"><a href="#4-5-&#x90E8;&#x5206;&#x5F97;&#x5206;&#x8F83;&#x9AD8;&#x7535;&#x5B50;&#x4E66;&#x5217;&#x8868;" class="headerlink" title="4.5   &#x90E8;&#x5206;&#x5F97;&#x5206;&#x8F83;&#x9AD8;&#x7535;&#x5B50;&#x4E66;&#x5217;&#x8868;"></a><strong>4.5</strong>   <strong>&#x90E8;&#x5206;&#x5F97;&#x5206;&#x8F83;&#x9AD8;&#x7535;&#x5B50;&#x4E66;&#x5217;&#x8868;</strong></h3><p>B000QCS8YM</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/1.png" alt="img"></p>
<p>B000UH5Z3A</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/2.png" alt="img"></p>
<p>B002F0826C</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/3.png" alt="img"></p>
<p>B002RHP5TK</p>
<p><img src="../img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/jianzhiting/pic_depot/img/blog/4.png" alt="img"></p>
<p>&#x66F4;&#x591A;&#x66F4;&#x597D;&#x7684;&#x4E66;&#x5355;&#x8BF7;&#x5173;&#x6CE8;&#x6211;&#x4EEC;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x4E2D;&#x7684;OverallWeights</p>
<h2 id="5-&#x603B;&#x7ED3;&#x548C;&#x5C55;&#x671B;"><a href="#5-&#x603B;&#x7ED3;&#x548C;&#x5C55;&#x671B;" class="headerlink" title="5    &#x603B;&#x7ED3;&#x548C;&#x5C55;&#x671B;"></a><strong>5</strong>    <strong>&#x603B;&#x7ED3;&#x548C;&#x5C55;&#x671B;</strong></h2><h3 id="5-1-&#x95EE;&#x9898;&#x53CA;&#x603B;&#x7ED3;"><a href="#5-1-&#x95EE;&#x9898;&#x53CA;&#x603B;&#x7ED3;" class="headerlink" title="5.1    &#x95EE;&#x9898;&#x53CA;&#x603B;&#x7ED3;"></a><strong>5.1</strong>    <strong>&#x95EE;&#x9898;&#x53CA;&#x603B;&#x7ED3;</strong></h3><p>&#x95EE;&#x9898;&#xFF1A;&#x7F3A;&#x4E4F;&#x76F8;&#x5BF9;&#x51C6;&#x786E;&#x7684;&#x5BA2;&#x89C2;&#x8BC4;&#x5206;&#xFF0C;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x6CD5;&#x7B49;&#x4F30;&#x8BA1;&#x51FA;&#x76F8;&#x5BF9;&#x51C6;&#x786E;&#x7684;&#x5404;&#x53C2;&#x6570;&#x53D6;&#x503C;&#xFF1B;</p>
<p>&#x95EE;&#x9898;&#xFF1A;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x7684;&#x6A21;&#x578B;&#x8F83;&#x4E3A;&#x590D;&#x6742;&#xFF0C;&#x5BFC;&#x81F4;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x8F83;&#x6162;&#xFF0C;&#x65E0;&#x6CD5;&#x5BF9;&#x5168;&#x90E8;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x4E14;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x5B58;&#x5728;&#x8BEF;&#x5DEE;&#xFF1B;</p>
<p>&#x95EE;&#x9898;&#xFF1A;&#x6570;&#x636E;&#x4E0E;&#x5F53;&#x4E0B;&#x7684;&#x65F6;&#x95F4;&#x8131;&#x8F68;&#xFF0C;&#x672A;&#x80FD;&#x5B8C;&#x5168;&#x53CD;&#x5E94;&#x5F53;&#x4E0B;&#x7684;&#x9700;&#x6C42;&#x3002;</p>
<p>&#x603B;&#x7ED3;&#xFF1A;&#x6211;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x5B9E;&#x73B0;&#x4E86;&#x5546;&#x54C1;&#x8BC4;&#x8BBA;&#x7684;&#x4FEE;&#x6B63;&#xFF0C;&#x5F97;&#x5230;&#x4E86;&#x76F8;&#x5BF9;&#x771F;&#x5B9E;&#x7684;&#x8BC4;&#x8BBA;&#x60C5;&#x51B5;&#x3002;&#x7531;&#x4E8E;&#x7F3A;&#x4E4F;&#x76F8;&#x5BF9;&#x51C6;&#x786E;&#x7684;&#x8BC4;&#x5206;&#x3001;&#x53CA;&#x65F6;&#x7684;&#x6570;&#x636E;&#x3001;&#x7B80;&#x5355;&#x6709;&#x6548;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x6211;&#x4EEC;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;&#x6A21;&#x578B;&#x4ECD;&#x5B58;&#x5728;&#x4E00;&#x5B9A;&#x7684;&#x8BEF;&#x5DEE;&#x3002;</p>
<h3 id="5-2-&#x5C55;&#x671B;"><a href="#5-2-&#x5C55;&#x671B;" class="headerlink" title="5.2   &#x5C55;&#x671B;"></a><strong>5.2</strong>   <strong>&#x5C55;&#x671B;</strong></h3><p>&#xB7; &#x901A;&#x8FC7;&#x4EBA;&#x5DE5;&#x5BF9;Kindle&#x4EA7;&#x54C1;&#x8FDB;&#x884C;&#x5224;&#x65AD;&#xFF0C;&#x5F97;&#x51FA;&#x76F8;&#x5BF9;&#x51C6;&#x786E;&#x7684;&#x5BA2;&#x89C2;&#x8BC4;&#x5206;&#xFF0C;&#x4ECE;&#x800C;&#x901A;&#x8FC7;&#x6700;&#x5C0F;&#x4E8C;&#x4E58;&#x4F30;&#x8BA1;&#x7B49;&#x529E;&#x6CD5;&#xFF0C;&#x5F97;&#x51FA;&#x76F8;&#x5BF9;&#x51C6;&#x786E;&#x7684;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#x503C;&#xFF1B;</p>
<p>&#xB7; &#x4F18;&#x5316;&#x60C5;&#x611F;&#x5206;&#x6790;&#x7B97;&#x6CD5;&#xFF0C;&#x4F7F;&#x4E4B;&#x53EF;&#x4EE5;&#x5728;&#x66F4;&#x591A;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x80FD;&#x591F;&#x5904;&#x7406;&#x66F4;&#x591A;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4E14;&#x5224;&#x65AD;&#x66F4;&#x52A0;&#x51C6;&#x786E;&#xFF1B;</p>
<p>&#xB7; &#x641C;&#x96C6;&#x6700;&#x8FD1;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7528;&#x4EE5;&#x9A8C;&#x8BC1;&#x6211;&#x4EEC;&#x7684;&#x8BC4;&#x5206;&#x4FEE;&#x6B63;&#x6A21;&#x578B;&#x7684;&#x51C6;&#x786E;&#x6027;&#xFF1B;</p>
<p>&#xB7; &#x8003;&#x8651;&#x7528;&#x6237;&#x4E4B;&#x95F4;&#x7684;&#x8054;&#x7CFB;&#xFF0C;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x81EA;&#x56DE;&#x5F52;&#x6A21;&#x578B;&#xFF0C;&#x5BF9;&#x8BC4;&#x5206;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x4FEE;&#x6B63;&#x7B49;&#x3002;</p>
<h2 id="&#x9644;&#x5F55;"><a href="#&#x9644;&#x5F55;" class="headerlink" title="&#x9644;&#x5F55;"></a>&#x9644;&#x5F55;</h2><blockquote id="fn_1">
<sup>1</sup>. CommentCountByDate.java<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#x21A9;</a>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x6839;&#x636E;&#x65F6;&#x95F4;&#x6233;&#x8BA1;&#x7B97;&#x6BCF;&#x5929;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentCountByDate</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) {</span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: Comments count by year &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;CommentCountByDate&quot;</span>);</span><br><span class="line">        job.setJarByClass(CommentCountByDate.class);</span><br><span class="line">        job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">        job.setCombinerClass(CountReducer.class);</span><br><span class="line">        job.setReducerClass(CountReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) {</span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i]));</span><br><span class="line">        }</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            Long unixReviewTime = kindleReview.getUnixReviewTime();</span><br><span class="line">            String reviewTime = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>).format(<span class="keyword">new</span> Date(unixReviewTime * <span class="number">1000</span>));</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(reviewTime), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           Context context</span></span></span><br><span class="line"><span class="function"><span class="params">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) {</span><br><span class="line">                sum += value.get();</span><br><span class="line">            }</span><br><span class="line">            context.write(key, <span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>CommentByDate.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> * @author &#x9F9A;</span></span><br><span class="line"><span class="string"> * &#x7ED8;&#x5236;&#x6570;&#x636E;&#x6982;&#x89C8;&#x7684;&#x4E09;&#x5F20;&#x56FE;.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns;sns.set(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line">data = pd.read_table(<span class="string">&apos;./data/count_comment_by_date&apos;</span>, header=<span class="keyword">None</span>)</span><br><span class="line">data.columns = [<span class="string">&apos;date&apos;</span>, <span class="string">&apos;&apos;</span>]</span><br><span class="line">data[<span class="string">&apos;date&apos;</span>] = pd.to_datetime(data[<span class="string">&apos;date&apos;</span>])</span><br><span class="line">data = data.set_index(<span class="string">&apos;date&apos;</span>)</span><br><span class="line"></span><br><span class="line">by_year = data.groupby(data.index.year).mean()</span><br><span class="line">plt.plot(by_year,<span class="string">&quot;-x&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&apos;Year&apos;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&apos;Comment Numbers Per Day&apos;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">by_month = data.groupby(data.index.month).mean()</span><br><span class="line">plt.plot(by_month,<span class="string">&quot;-x&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&apos;Month&apos;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&apos;Comment Numbers Per Day&apos;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">by_weekday = data.groupby(data.index.weekday).mean()</span><br><span class="line">by_weekday.index = [<span class="string">&apos;Mon&apos;</span>, <span class="string">&apos;Tues&apos;</span>, <span class="string">&apos;Wed&apos;</span>, <span class="string">&apos;Thur&apos;</span>, <span class="string">&apos;Fri&apos;</span>, <span class="string">&apos;Sat&apos;</span>, <span class="string">&apos;Sun&apos;</span>]</span><br><span class="line">plt.plot(by_weekday,<span class="string">&quot;-x&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&apos;Weekday&apos;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&apos;Comment Numbers Per Day&apos;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<blockquote id="fn_2">
<sup>2</sup>. CommentTermFrequency.java<a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#x21A9;</a>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x8BCD;&#x9891;&#x5206;&#x6790;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentTermFrequency</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String[] stopwords = {<span class="string">&quot;a&quot;</span>, <span class="string">&quot;able&quot;</span>, <span class="string">&quot;about&quot;</span>, <span class="string">&quot;across&quot;</span>, <span class="string">&quot;after&quot;</span>, <span class="string">&quot;all&quot;</span>, <span class="string">&quot;almost&quot;</span>, <span class="string">&quot;also&quot;</span>, <span class="string">&quot;am&quot;</span>, <span class="string">&quot;among&quot;</span>,</span><br><span class="line">            <span class="string">&quot;an&quot;</span>, <span class="string">&quot;and&quot;</span>, <span class="string">&quot;any&quot;</span>, <span class="string">&quot;are&quot;</span>, <span class="string">&quot;as&quot;</span>, <span class="string">&quot;at&quot;</span>, <span class="string">&quot;be&quot;</span>, <span class="string">&quot;because&quot;</span>, <span class="string">&quot;been&quot;</span>, <span class="string">&quot;but&quot;</span>, <span class="string">&quot;by&quot;</span>, <span class="string">&quot;can&quot;</span>, <span class="string">&quot;cannot&quot;</span>, <span class="string">&quot;could&quot;</span>, <span class="string">&quot;dear&quot;</span>,</span><br><span class="line">            <span class="string">&quot;did&quot;</span>, <span class="string">&quot;do&quot;</span>, <span class="string">&quot;does&quot;</span>, <span class="string">&quot;either&quot;</span>, <span class="string">&quot;else&quot;</span>, <span class="string">&quot;ever&quot;</span>, <span class="string">&quot;every&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;from&quot;</span>, <span class="string">&quot;get&quot;</span>, <span class="string">&quot;got&quot;</span>, <span class="string">&quot;had&quot;</span>, <span class="string">&quot;has&quot;</span>, <span class="string">&quot;have&quot;</span>,</span><br><span class="line">            <span class="string">&quot;he&quot;</span>, <span class="string">&quot;her&quot;</span>, <span class="string">&quot;hers&quot;</span>, <span class="string">&quot;him&quot;</span>, <span class="string">&quot;his&quot;</span>, <span class="string">&quot;how&quot;</span>, <span class="string">&quot;however&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;in&quot;</span>, <span class="string">&quot;into&quot;</span>, <span class="string">&quot;is&quot;</span>, <span class="string">&quot;it&quot;</span>, <span class="string">&quot;its&quot;</span>, <span class="string">&quot;just&quot;</span>,</span><br><span class="line">            <span class="string">&quot;least&quot;</span>, <span class="string">&quot;let&quot;</span>, <span class="string">&quot;like&quot;</span>, <span class="string">&quot;likely&quot;</span>, <span class="string">&quot;may&quot;</span>, <span class="string">&quot;me&quot;</span>, <span class="string">&quot;might&quot;</span>, <span class="string">&quot;most&quot;</span>, <span class="string">&quot;must&quot;</span>, <span class="string">&quot;my&quot;</span>, <span class="string">&quot;neither&quot;</span>, <span class="string">&quot;no&quot;</span>, <span class="string">&quot;nor&quot;</span>, <span class="string">&quot;not&quot;</span>,</span><br><span class="line">            <span class="string">&quot;of&quot;</span>, <span class="string">&quot;off&quot;</span>, <span class="string">&quot;often&quot;</span>, <span class="string">&quot;on&quot;</span>, <span class="string">&quot;only&quot;</span>, <span class="string">&quot;or&quot;</span>, <span class="string">&quot;other&quot;</span>, <span class="string">&quot;our&quot;</span>, <span class="string">&quot;own&quot;</span>, <span class="string">&quot;rather&quot;</span>, <span class="string">&quot;said&quot;</span>, <span class="string">&quot;say&quot;</span>, <span class="string">&quot;says&quot;</span>, <span class="string">&quot;she&quot;</span>,</span><br><span class="line">            <span class="string">&quot;should&quot;</span>, <span class="string">&quot;since&quot;</span>, <span class="string">&quot;so&quot;</span>, <span class="string">&quot;some&quot;</span>, <span class="string">&quot;than&quot;</span>, <span class="string">&quot;that&quot;</span>, <span class="string">&quot;the&quot;</span>, <span class="string">&quot;their&quot;</span>, <span class="string">&quot;them&quot;</span>, <span class="string">&quot;then&quot;</span>, <span class="string">&quot;there&quot;</span>, <span class="string">&quot;these&quot;</span>, <span class="string">&quot;they&quot;</span>,</span><br><span class="line">            <span class="string">&quot;this&quot;</span>, <span class="string">&quot;tis&quot;</span>, <span class="string">&quot;to&quot;</span>, <span class="string">&quot;too&quot;</span>, <span class="string">&quot;twas&quot;</span>, <span class="string">&quot;us&quot;</span>, <span class="string">&quot;wants&quot;</span>, <span class="string">&quot;was&quot;</span>, <span class="string">&quot;we&quot;</span>, <span class="string">&quot;were&quot;</span>, <span class="string">&quot;what&quot;</span>, <span class="string">&quot;when&quot;</span>, <span class="string">&quot;where&quot;</span>, <span class="string">&quot;which&quot;</span>,</span><br><span class="line">            <span class="string">&quot;while&quot;</span>, <span class="string">&quot;who&quot;</span>, <span class="string">&quot;whom&quot;</span>, <span class="string">&quot;why&quot;</span>, <span class="string">&quot;will&quot;</span>, <span class="string">&quot;with&quot;</span>, <span class="string">&quot;would&quot;</span>, <span class="string">&quot;yet&quot;</span>, <span class="string">&quot;you&quot;</span>, <span class="string">&quot;your&quot;</span>, <span class="string">&quot;,&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;?&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;:&quot;</span>,</span><br><span class="line">            <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&apos;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>, <span class="string">&quot;{&quot;</span>, <span class="string">&quot;}&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;@&quot;</span>, <span class="string">&quot;#&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>, <span class="string">&quot;-&quot;</span>,</span><br><span class="line">            <span class="string">&quot;_&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;`&quot;</span>};</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; stopWordSet = <span class="keyword">new</span> HashSet&lt;String&gt;(Arrays.asList(stopwords));</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) {</span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: CommentTermFrequency &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;CommentTermFrequency&quot;</span>);</span><br><span class="line">        job.setJarByClass(CommentTermFrequency.class);</span><br><span class="line">        job.setMapperClass(TFMapper.class);</span><br><span class="line">        job.setCombinerClass(TFCombiner.class);</span><br><span class="line">        job.setReducerClass(TFReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(FloatWritable.class);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) {</span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i]));</span><br><span class="line">        }</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TFMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">FloatWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            String ReviewText = kindleReview.getReviewText();</span><br><span class="line">            String location = kindleReview.getAsin() + <span class="string">&quot;+&quot;</span> + kindleReview.getReviewerID();</span><br><span class="line">            Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">            props.put(<span class="string">&quot;annotators&quot;</span>, <span class="string">&quot;tokenize, ssplit, pos, parse, lemma&quot;</span>);</span><br><span class="line">            StanfordCoreNLP pipeline = <span class="keyword">new</span> StanfordCoreNLP(props);</span><br><span class="line">            Annotation annotation = pipeline.process(ReviewText);</span><br><span class="line">            List&lt;CoreMap&gt; sentences = annotation.get(CoreAnnotations.SentencesAnnotation.class);</span><br><span class="line">            <span class="keyword">int</span> wordCount = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (CoreMap sentence : sentences) {</span><br><span class="line">                <span class="keyword">for</span> (CoreLabel token : sentence.get(CoreAnnotations.TokensAnnotation.class)) {</span><br><span class="line">                    String lemma = token.get(CoreAnnotations.LemmaAnnotation.class).toLowerCase();</span><br><span class="line">                    <span class="keyword">if</span> (!stopWordSet.contains(lemma)) {</span><br><span class="line">                        context.write(<span class="keyword">new</span> Text(location + <span class="string">&quot; &quot;</span> + lemma), <span class="keyword">new</span> FloatWritable(<span class="number">1</span>));</span><br><span class="line">                        wordCount++;</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// &#x4E3B;&#x8981;&#x8FD9;&#x91CC;&#x503C;&#x4F7F;&#x7528;&#x7684; &quot;!&quot;&#x662F;&#x7279;&#x522B;&#x6784;&#x9020;&#x7684;&#x3002; &#x56E0;&#x4E3A;!&#x7684;ascii&#x6BD4;&#x6240;&#x6709;&#x7684;&#x5B57;&#x6BCD;&#x90FD;&#x5C0F;&#x3002;</span></span><br><span class="line">            context.write(<span class="keyword">new</span> Text(location + <span class="string">&quot; !&quot;</span>), <span class="keyword">new</span> FloatWritable(wordCount));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TFCombiner</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">FloatWritable</span>, <span class="title">Text</span>, <span class="title">FloatWritable</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> wordCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;FloatWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> index = key.toString().indexOf(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="comment">// &#x56E0;&#x4E3A;!&#x7684;ascii&#x6700;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x5728;map&#x9636;&#x6BB5;&#x7684;&#x6392;&#x5E8F;&#x540E;&#xFF0C;!&#x4F1A;&#x51FA;&#x73B0;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;</span></span><br><span class="line">            <span class="keyword">if</span> (key.toString().substring(index + <span class="number">1</span>, index + <span class="number">2</span>).equals(<span class="string">&quot;!&quot;</span>)) {</span><br><span class="line">                <span class="keyword">for</span> (FloatWritable value : values) {</span><br><span class="line">                    wordCount = value.get();</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">float</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (FloatWritable value : values) {</span><br><span class="line">                sum += value.get();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">float</span> tf = sum / wordCount;</span><br><span class="line">            context.write(key, <span class="keyword">new</span> FloatWritable(tf));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TFReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">FloatWritable</span>, <span class="title">Text</span>, <span class="title">FloatWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;FloatWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">for</span> (FloatWritable value : values) {</span><br><span class="line">                context.write(key, value);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>CommentTFIDF.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x5728;&#x83B7;&#x53D6;&#x8BE5;&#x6848;&#x4F8B;&#x4E2D;&#x8BC4;&#x8BBA;&#x7684;&#x8BCD;&#x9891;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x8BA1;&#x7B97;&#x51FA;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x4E2D;&#x7684;&#x8BCD;&#x9891;-&#x9006;&#x6587;&#x4EF6;&#x9891;&#x7387;${TF</span></span><br><span class="line"><span class="comment"> * IDF}_w=TF_w\times\lg\frac{&#x8BC4;&#x8BBA;&#x603B;&#x6570;}{&#x5305;&#x542B;&#x5355;&#x8BCD;w&#x7684;&#x8BC4;&#x8BBA;&#x6570;}$&#xFF1B; </span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x5165;&#xFF1A;nice B000F83SZQ+A1F6404F1VG29J    0.10&#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09;</span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x51FA;&#xFF1A;nice B000F83SZQ+A1F6404F1VG29J    0.15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentTFIDF</span> </span>{ </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{ </span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration(); </span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs(); </span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) { </span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: CommentTFIDF &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>); </span><br><span class="line">            System.exit(<span class="number">2</span>); </span><br><span class="line">        } </span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;CommentTFIDF&quot;</span>); </span><br><span class="line">        job.setJarByClass(CommentTFIDF.class); </span><br><span class="line">        job.setMapperClass(TFIDFMapper.class); </span><br><span class="line">        job.setReducerClass(TFIDFReducer.class); </span><br><span class="line">        job.setOutputKeyClass(Text.class); </span><br><span class="line">        job.setOutputValueClass(Text.class); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) { </span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i])); </span><br><span class="line">        } </span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>])); </span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>); </span><br><span class="line">    } </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TFIDFMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{ </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            String line = value.toString().replaceAll(<span class="string">&quot;\t&quot;</span>, <span class="string">&quot; &quot;</span>); </span><br><span class="line">            String[] strs = line.split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">            <span class="comment">// &#x83B7;&#x53D6;&#x5355;&#x8BCD; &#x4F5C;&#x4E3A;key </span></span><br><span class="line">            String word = strs[<span class="number">1</span>]; </span><br><span class="line">            <span class="comment">// &#x5176;&#x4F59;&#x90E8;&#x5206; &#x4F5C;&#x4E3A;value&#xFF0C;&#x7EDF;&#x8BA1;&#x5355;&#x8BCD;&#x5728;&#x6240;&#x6709;&#x8BC4;&#x8BBA;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;, &#x201C;1&#x201D; &#x8868;&#x793A;&#x51FA;&#x73B0;&#x4E00;&#x6B21;&#x3002; </span></span><br><span class="line">            String other = strs[<span class="number">0</span>] + <span class="string">&quot; &quot;</span> + strs[<span class="number">2</span>] + <span class="string">&quot; 1&quot;</span>; </span><br><span class="line">            context.write(<span class="keyword">new</span> Text(word), <span class="keyword">new</span> Text(other)); </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TFIDFReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{ </span><br><span class="line">        <span class="comment">//&#x603B;&#x8BC4;&#x8BBA;&#x6570; </span></span><br><span class="line">        <span class="keyword">int</span> file_count = <span class="number">982619</span>; </span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            <span class="keyword">float</span> sum = <span class="number">0</span>; </span><br><span class="line">            List&lt;String&gt; vals = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">            <span class="keyword">for</span> (Text value : values) { </span><br><span class="line">                String[] strs = value.toString().split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">                <span class="comment">// &#x7EDF;&#x8BA1;&#x6B64;&#x5355;&#x8BCD;&#x5728;&#x6240;&#x6709;&#x8BC4;&#x8BBA;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570; </span></span><br><span class="line">                <span class="keyword">try</span> { </span><br><span class="line">                    sum += Integer.parseInt(strs[<span class="number">2</span>]); </span><br><span class="line">                    vals.add(strs[<span class="number">0</span>] + <span class="string">&quot; &quot;</span> + strs[<span class="number">1</span>]); </span><br><span class="line">                } <span class="keyword">catch</span> (Exception e) { </span><br><span class="line">                    System.out.println(e); </span><br><span class="line">                } </span><br><span class="line">            } </span><br><span class="line">            <span class="comment">// &#x5355;&#x8BCD;&#x5728;&#x6240;&#x6709;&#x8BC4;&#x8BBA;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#x9664;&#x4EE5;&#x603B;&#x8BC4;&#x8BBA;&#x6570; = IDF </span></span><br><span class="line">            <span class="keyword">double</span> idf = Math.log10(file_count / sum); </span><br><span class="line">            String word = key.toString(); </span><br><span class="line">            <span class="keyword">for</span> (String val : vals) { </span><br><span class="line">                String[] strs = val.split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">                <span class="keyword">float</span> tf = Float.parseFloat(strs[<span class="number">1</span>]); </span><br><span class="line">                String loc = strs[<span class="number">0</span>]; </span><br><span class="line">                String tfidf = <span class="string">&quot;&quot;</span> + (tf * idf); </span><br><span class="line">                context.write(<span class="keyword">new</span> Text(loc + <span class="string">&quot; &quot;</span> + word), <span class="keyword">new</span> Text(tfidf)); </span><br><span class="line">            } </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>CommentAbstract.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x5728;&#x5F97;&#x5230;&#x6BCF;&#x4E2A;&#x8BC4;&#x8BBA;&#x4E2D;&#x6BCF;&#x4E2A;&#x5355;&#x8BCD;&#x7684;&#x8BCD;&#x9891;-&#x9006;&#x6587;&#x4EF6;&#x9891;&#x7387;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x53D6;&#x6700;&#x9AD8;&#x8005;&#xFF0C;&#x4F5C;&#x4E3A;&#x8BE5;&#x8BC4;&#x8BBA;&#x7684;</span></span><br><span class="line"><span class="comment"> * &#x952E;&#x8BCD;.</span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x5165;&#xFF1A;nice B000F83SZQ+A1F6404F1VG29J    0.15&#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09; </span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x51FA;&#xFF1A;B000F83SZQ+A1F6404F1VG29J    nice </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentAbstract</span> </span>{ </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{ </span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration(); </span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs(); </span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) { </span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: CommentAbstract &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>); </span><br><span class="line">            System.exit(<span class="number">2</span>); </span><br><span class="line">        } </span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;CommentAbstract&quot;</span>); </span><br><span class="line">        job.setJarByClass(CommentAbstract.class); </span><br><span class="line">        job.setMapperClass(AbstractMapper.class); </span><br><span class="line">        job.setReducerClass(AbstractReducer.class); </span><br><span class="line">        job.setOutputKeyClass(Text.class); </span><br><span class="line">        job.setOutputValueClass(Text.class); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) { </span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i])); </span><br><span class="line">        } </span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>])); </span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>); </span><br><span class="line">    } </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{ </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            String line = value.toString().replaceAll(<span class="string">&quot;\t&quot;</span>, <span class="string">&quot; &quot;</span>); </span><br><span class="line">            String[] strs = line.split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">            <span class="comment">// &#x83B7;&#x53D6;&#x8BC4;&#x8BBA;&#x6807;&#x8BB0;&#x4F5C;&#x4E3A;key </span></span><br><span class="line">            String loc = strs[<span class="number">0</span>]; </span><br><span class="line">            <span class="comment">// &#x5176;&#x4F59;&#x90E8;&#x5206; &#x4F5C;&#x4E3A;value </span></span><br><span class="line">            String other = strs[<span class="number">1</span>] + <span class="string">&quot; &quot;</span> + strs[<span class="number">2</span>]; </span><br><span class="line">            context.write(<span class="keyword">new</span> Text(loc), <span class="keyword">new</span> Text(other)); </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{ </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            <span class="keyword">float</span> max = <span class="number">0</span>; </span><br><span class="line">            String abst = <span class="string">&quot;&quot;</span>; </span><br><span class="line">            <span class="keyword">for</span> (Text value : values) { </span><br><span class="line">                String[] strs = value.toString().split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">                String word = strs[<span class="number">0</span>]; </span><br><span class="line">                <span class="keyword">float</span> tfidf = Float.parseFloat(strs[<span class="number">1</span>]); </span><br><span class="line">                <span class="keyword">if</span> (tfidf &gt; max) { </span><br><span class="line">                    max = tfidf; </span><br><span class="line">                    abst = word; </span><br><span class="line">                } </span><br><span class="line">            } </span><br><span class="line">            context.write(key, <span class="keyword">new</span> Text(abst)); </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>AsinAbstractCount.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x5728;&#x83B7;&#x53D6;&#x5230;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x8BE5;&#x8BC4;&#x8BBA;&#x6240;&#x8BC4;&#x8BBA;&#x7684;&#x5546;&#x54C1;&#x8FDB;&#x884C;&#x6C47;&#x603B;&#xFF0C;&#x4EE5;&#x964D;&#x4F4E;&#x6587;&#x4EF6;&#x5927;</span></span><br><span class="line"><span class="comment"> * &#x5C0F;&#xFF0C;&#x63D0;&#x9AD8;&#x4E0B;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x4F7F;&#x7528;`Python`&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5206;&#x6790;&#x7684;&#x6548;&#x7387;.</span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x5165;&#xFF1A;B000F83SZQ+A1F6404F1VG29J    nice&#xFF08;&#x4E0A;&#x4E00;&#x6B65;&#x9AA4;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF09;</span></span><br><span class="line"><span class="comment"> * &#x8F93;&#x51FA;&#xFF1A;B000F83SZQ nice 5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsinAbstractCount</span> </span>{ </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{ </span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration(); </span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs(); </span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) { </span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: AsinAbstractCount &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>); </span><br><span class="line">            System.exit(<span class="number">2</span>); </span><br><span class="line">        } </span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;AsinAbstractCount&quot;</span>); </span><br><span class="line">        job.setJarByClass(AsinAbstractCount.class); </span><br><span class="line">        job.setMapperClass(CountMapper.class); </span><br><span class="line">        job.setReducerClass(CountReducer.class); </span><br><span class="line">        job.setOutputKeyClass(Text.class); </span><br><span class="line">        job.setOutputValueClass(IntWritable.class); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) { </span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i])); </span><br><span class="line">        } </span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>])); </span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>); </span><br><span class="line">    } </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{ </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            String line = value.toString().replaceAll(<span class="string">&quot;\t&quot;</span>, <span class="string">&quot; &quot;</span>); </span><br><span class="line">            String[] strs = line.split(<span class="string">&quot; &quot;</span>); </span><br><span class="line">            <span class="comment">// &#x83B7;&#x53D6;asin&#xFF0C;word&#x8BB0;&#x4F5C;&#x4E3A;key </span></span><br><span class="line">            String asin = strs[<span class="number">0</span>].substring(<span class="number">0</span>, strs[<span class="number">0</span>].indexOf(<span class="string">&apos;+&apos;</span>)); </span><br><span class="line">            String word = strs[<span class="number">1</span>]; </span><br><span class="line">            context.write(<span class="keyword">new</span> Text(asin + <span class="string">&quot; &quot;</span> + word), <span class="keyword">new</span> IntWritable(<span class="number">1</span>)); </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{ </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{ </span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) { </span><br><span class="line">                sum += value.get(); </span><br><span class="line">            } </span><br><span class="line">            context.write(key, <span class="keyword">new</span> IntWritable(sum)); </span><br><span class="line">        } </span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<blockquote id="fn_3">
<sup>3</sup>. Overall.java<a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#x21A9;</a>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x6768;</span></span><br><span class="line"><span class="comment"> * &#x8BA1;&#x7B97;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Overall</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> </span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            </span><br><span class="line">            String review = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(review, KindleReview.class);</span><br><span class="line">            <span class="keyword">int</span> overall = kindleReview.getOverall();</span><br><span class="line">            String asin = kindleReview.getAsin();		</span><br><span class="line">	        context.write(<span class="keyword">new</span> Text(asin), <span class="keyword">new</span> IntWritable(overall));            </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>,<span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	        <span class="keyword">float</span> ave=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) {</span><br><span class="line">                sum += val.get();</span><br><span class="line">		        i++;</span><br><span class="line">            }</span><br><span class="line">	        <span class="keyword">float</span> s=(<span class="keyword">float</span>)sum;</span><br><span class="line">	        <span class="keyword">float</span> j=(<span class="keyword">float</span>)i;</span><br><span class="line">	        ave=s/j;</span><br><span class="line">            context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + ave));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf,<span class="string">&quot;overall&quot;</span>); </span><br><span class="line">        job.setJarByClass(Overall.class);	</span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(Text.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<blockquote id="fn_4">
<sup>4</sup>. CountOverall.java<a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#x21A9;</a>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x6768;</span></span><br><span class="line"><span class="comment"> * &#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x603B;&#x6570;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountOverall</span></span>{</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> IntWritable one = <span class="keyword">new</span> IntWritable(<span class="number">1</span>); </span><br><span class="line">        <span class="keyword">private</span> Text word = <span class="keyword">new</span> Text(); </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> </span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            </span><br><span class="line">		    String[] str = value.toString().split(<span class="string">&quot;\\s+&quot;</span>);</span><br><span class="line">		    <span class="keyword">double</span> i= Double.parseDouble(str[<span class="number">1</span>]);</span><br><span class="line">		    <span class="keyword">int</span> j=(<span class="keyword">int</span>)i;</span><br><span class="line">            word.set(<span class="string">&quot;&quot;</span> + j);	    	</span><br><span class="line">	    	context.write(word,one);</span><br><span class="line">       </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) {</span><br><span class="line">                sum += val.get();</span><br><span class="line">            }</span><br><span class="line">            context.write(key, <span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf,<span class="string">&quot;CountOverall&quot;</span>); </span><br><span class="line">        job.setJarByClass(CountOverall.class);</span><br><span class="line"></span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setCombinerClass(MyReduce.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line"></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line"></span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>print_models.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> * @author &#x7B80;</span></span><br><span class="line"><span class="string"> * &#x6253;&#x5370;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;&#x53CA;&#x5404;&#x8BC4;&#x7EA7;&#x603B;&#x6570;&#x7684;&#x67F1;&#x72B6;&#x56FE;.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">file = open(<span class="string">&quot;./KR/out/countOverall/part-r-00000&quot;</span>)</span><br><span class="line">x_list = []</span><br><span class="line">y_list = []</span><br><span class="line"></span><br><span class="line">line = file.readline()</span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    x = line.split()</span><br><span class="line">    x_list.append(x[<span class="number">0</span>])</span><br><span class="line">    y_list.append(int(x[<span class="number">1</span>]))</span><br><span class="line">    line = file.readline()</span><br><span class="line"></span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">plt.bar(range(len(y_list)), y_list, width=<span class="number">0.8</span>, facecolor=<span class="string">&quot;#4C72B0&quot;</span>, edgecolor=<span class="string">&quot;white&quot;</span>, tick_label=x_list)</span><br><span class="line">plt.xlabel(<span class="string">&apos;Level&apos;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&apos;Amount&apos;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>CommentCountByDateOver20.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x6839;&#x636E;&#x65F6;&#x95F4;&#x6233;&#x8BA1;&#x7B97;&#x6BCF;&#x5929;&#x7684;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#xFF0C;&#x7B5B;&#x9009;&#x51FA;&#x8BC4;&#x8BBA;&#x6570;&#x76EE;&#x8D85;&#x8FC7;20&#x6761;&#x7684;&#x8BB0;&#x5F55;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommentCountByDateOver20</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) {</span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: Comments count by year &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;CommentCountByDateOver20&quot;</span>);</span><br><span class="line">        job.setJarByClass(CommentCountByDateOver20.class);</span><br><span class="line">        job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">        job.setCombinerClass(CountReducer.class);</span><br><span class="line">        job.setReducerClass(CountReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">/*for (int i = 0; i &lt; otherArgs.length - 1; ++i) {</span></span><br><span class="line"><span class="comment">            FileInputFormat.addInputPath(job, new Path(otherArgs[i]));</span></span><br><span class="line"><span class="comment">        }</span></span><br><span class="line"><span class="comment">        FileOutputFormat.setOutputPath(job, new Path(otherArgs[otherArgs.length - 1]));*/</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) {</span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i]));</span><br><span class="line">        }</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            Long unixReviewTime = kindleReview.getUnixReviewTime();</span><br><span class="line">            String reviewTime = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>).format(<span class="keyword">new</span> Date(unixReviewTime * <span class="number">1000</span>));</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(reviewTime), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           Context context</span></span></span><br><span class="line"><span class="function"><span class="params">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) {</span><br><span class="line">                sum += value.get();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(sum &gt; <span class="number">20</span>)</span><br><span class="line">                context.write(key, <span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>IsPaidPoster1.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x6839;&#x636E;&#x6BCF;&#x4EBA;&#x6BCF;&#x5929;&#x7684;&#x8BC4;&#x8BBA;&#x6761;&#x6570;&#x7B5B;&#x9009;&#x51FA;&#x6F5C;&#x5728;&#x6C34;&#x519B;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IsPaidPoster1</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; rely = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">			</span><br><span class="line">			String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            Long unixReviewTime = kindleReview.getUnixReviewTime();</span><br><span class="line">            String reviewTime = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>).format(<span class="keyword">new</span> Date(unixReviewTime * <span class="number">1000</span>));</span><br><span class="line">            <span class="keyword">if</span>(rely.containsKey(reviewTime)){</span><br><span class="line">                String reviewID = kindleReview.getReviewerID();</span><br><span class="line">                context.write(<span class="keyword">new</span> Text(reviewTime + <span class="string">&quot;,&quot;</span> + reviewID), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">            }</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt;</span>{</span><br><span class="line">        </span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key,Iterable&lt;IntWritable&gt; values,Context context)</span><span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">            </span><br><span class="line">            String str = key.toString();</span><br><span class="line">            String words[] = str.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            <span class="keyword">int</span> amount = rely.get(words[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) {</span><br><span class="line">                sum += value.get();</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(sum &gt; <span class="number">15</span>||sum &gt; <span class="number">0.25</span>*amount)<span class="comment">//&#x67D0;&#x4EBA;&#x67D0;&#x5929;&#x8BC4;&#x8BBA;&#x6570;&#x8D85;&#x8FC7;15&#x6761;&#xFF0C;&#x6216;&#x8005;&#xFF0C;&#x67D0;&#x4EBA;&#x67D0;&#x5929;&#x8BC4;&#x8BBA;&#x6570;&#x8D85;&#x8FC7;&#x8BC4;&#x8BBA;&#x603B;&#x6570;&#x7684;25%</span></span><br><span class="line">			    context.write(key, <span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>{</span><br><span class="line">		Configuration configuration=<span class="keyword">new</span> Configuration();</span><br><span class="line">		String[] otherArgs=<span class="keyword">new</span> GenericOptionsParser(configuration,args).getRemainingArgs();</span><br><span class="line">		<span class="keyword">if</span>(otherArgs.length!=<span class="number">2</span>){</span><br><span class="line">			System.err.println(<span class="string">&quot;Usage:reverseIndex &lt;in&gt; &lt;out&gt;&quot;</span>);</span><br><span class="line">			System.exit(<span class="number">2</span>);</span><br><span class="line">		}</span><br><span class="line">		FileSystem fs=FileSystem.get(configuration);</span><br><span class="line">		InputStream in = <span class="keyword">null</span>;</span><br><span class="line">		Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/commentCountByDateOver20/part-r-00000&quot;</span>);</span><br><span class="line">		in = fs.open(name1);</span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String str = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = Integer.parseInt(itr.nextToken());</span><br><span class="line">            rely.put(str, integer);</span><br><span class="line">			line = br.readLine();</span><br><span class="line">		}</span><br><span class="line">		br.close();</span><br><span class="line">        in.close();</span><br><span class="line">				</span><br><span class="line">		<span class="comment">//&#x914D;&#x7F6E;&#x4F5C;&#x4E1A;&#x540D;</span></span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">&quot;deprecation&quot;</span>)</span><br><span class="line">		Job job=<span class="keyword">new</span> Job(configuration, <span class="string">&quot;IsPaidPoster1&quot;</span>);</span><br><span class="line">		job.setJarByClass(IsPaidPoster1.class);</span><br><span class="line">		job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">        <span class="comment">//&#x662F;&#x53EF;&#x4EE5;&#x6309;&#x6587;&#x4EF6;&#x540D;&#x8FDB;&#x884C;partition&#x7684;</span></span><br><span class="line">		job.setCombinerClass(IntSumReducer.class);</span><br><span class="line">		job.setReducerClass(IntSumReducer.class);</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(IntWritable.class);	</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(job.waitForCompletion(<span class="keyword">true</span>)) {</span><br><span class="line">            InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">            Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span> +otherArgs[<span class="number">1</span>]+ <span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">            Path name3 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+otherArgs[<span class="number">1</span>]+<span class="string">&quot;/ans&quot;</span>);		</span><br><span class="line">            in2 = fs.open(name2);</span><br><span class="line">            FSDataOutputStream fileout = fs.create(name3);</span><br><span class="line">	        BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line">			BufferedWriter out = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(fileout));</span><br><span class="line">	        line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	        line = br2.readLine();</span><br><span class="line">            Set&lt;String&gt; hs = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	        <span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">                String words[] = line.split(<span class="string">&quot;[,\\p{Blank}]&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(!hs.contains(words[<span class="number">1</span>])){</span><br><span class="line">                    cnt++;</span><br><span class="line">                    hs.add(words[<span class="number">1</span>]);</span><br><span class="line">				    out.write(words[<span class="number">1</span>] + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">	            line = br2.readLine();</span><br><span class="line">	        }</span><br><span class="line">            <span class="comment">//out.write(&quot;&quot;+ cnt + &quot;\n&quot;);</span></span><br><span class="line">	        br2.close();</span><br><span class="line">            in2.close();</span><br><span class="line">            out.flush();</span><br><span class="line">			out.close();</span><br><span class="line">		}</span><br><span class="line">		System.exit(job.waitForCompletion(<span class="keyword">true</span>)?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>IsPaidPoster2.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x6839;&#x636E;&#x4E00;&#x4E2A;&#x4EBA;&#x6240;&#x6709;&#x7684;&#x8BC4;&#x8BBA;&#x662F;&#x5426;&#x5747;&#x4E3A;&#x597D;&#x8BC4;&#x6216;&#x6076;&#x8BC4;&#x7B5B;&#x9009;&#x51FA;&#x6F5C;&#x5728;&#x6C34;&#x519B;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IsPaidPoster2</span> </span>{</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">			</span><br><span class="line">			String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            String reviewID = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">int</span> overall = kindleReview.getOverall();</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(reviewID), <span class="keyword">new</span> IntWritable(overall));</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt;</span>{</span><br><span class="line">        </span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key,Iterable&lt;IntWritable&gt; values,Context context)</span><span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">            </span><br><span class="line">            ArrayList&lt;Integer&gt; overall = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">float</span> avg = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) {</span><br><span class="line">                <span class="keyword">int</span> val = value.get();</span><br><span class="line">                avg += val;</span><br><span class="line">                overall.add(val);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">int</span> cnt = overall.size();</span><br><span class="line">            <span class="keyword">if</span>(cnt &gt; <span class="number">100</span>){<span class="comment">//&#x5F53;&#x67D0;&#x4E2A;&#x4EBA;&#x7684;&#x8BC4;&#x8BBA;&#x6761;&#x6570;&#x8D85;&#x8FC7;100&#x6761;&#x65F6;</span></span><br><span class="line">                avg = avg/cnt;</span><br><span class="line">                <span class="keyword">if</span>(avg &lt; <span class="number">1.1f</span>||avg &gt; <span class="number">4.9f</span>){<span class="comment">//&#x8BC4;&#x7EA7;&#x5747;&#x4E3A;&#x6076;&#x8BC4;&#x6216;&#x597D;&#x8BC4;</span></span><br><span class="line">                    <span class="keyword">float</span> sum = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> integer : overall){</span><br><span class="line">                        sum += (integer-avg)*(integer-avg);</span><br><span class="line">                    }</span><br><span class="line">                    sum = sum/cnt;</span><br><span class="line">                    <span class="keyword">if</span>(sum &lt; <span class="number">0.1</span>)<span class="comment">//&#x65B9;&#x5DEE;&#x5C0F;&#x4E8E;0.1</span></span><br><span class="line">		                context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + avg + <span class="string">&quot; &quot;</span> + sum));</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>{</span><br><span class="line">		Configuration configuration=<span class="keyword">new</span> Configuration();</span><br><span class="line">		String[] otherArgs=<span class="keyword">new</span> GenericOptionsParser(configuration,args).getRemainingArgs();</span><br><span class="line">		<span class="keyword">if</span>(otherArgs.length!=<span class="number">2</span>){</span><br><span class="line">			System.err.println(<span class="string">&quot;Usage:reverseIndex &lt;in&gt; &lt;out&gt;&quot;</span>);</span><br><span class="line">			System.exit(<span class="number">2</span>);</span><br><span class="line">		}</span><br><span class="line">		FileSystem fs=FileSystem.get(configuration);</span><br><span class="line">				</span><br><span class="line">		<span class="comment">//&#x914D;&#x7F6E;&#x4F5C;&#x4E1A;&#x540D;</span></span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">&quot;deprecation&quot;</span>)</span><br><span class="line">		Job job=<span class="keyword">new</span> Job(configuration, <span class="string">&quot;IsPaidPoster2&quot;</span>);</span><br><span class="line">		job.setJarByClass(IsPaidPoster2.class);</span><br><span class="line">		job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">		job.setReducerClass(IntSumReducer.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(Text.class);	</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(job.waitForCompletion(<span class="keyword">true</span>)) {</span><br><span class="line">            InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">            Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span> +otherArgs[<span class="number">1</span>]+ <span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">            Path name3 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+otherArgs[<span class="number">1</span>]+<span class="string">&quot;/ans&quot;</span>);		</span><br><span class="line">            in2 = fs.open(name2);</span><br><span class="line">            FSDataOutputStream fileout = fs.create(name3);</span><br><span class="line">	        BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line">			BufferedWriter out = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(fileout));</span><br><span class="line"></span><br><span class="line">            InputStream in1 = <span class="keyword">null</span>;</span><br><span class="line">            Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster1/ans&quot;</span>);	</span><br><span class="line">            in1 = fs.open(name1);</span><br><span class="line">	        BufferedReader br1 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in1));</span><br><span class="line"></span><br><span class="line">	        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            Set&lt;String&gt; hs = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            line = br1.readLine();</span><br><span class="line">	        <span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">                cnt++;</span><br><span class="line">                hs.add(line);</span><br><span class="line">			    out.write(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	            line = br1.readLine();</span><br><span class="line">	        }</span><br><span class="line">            line = br2.readLine();</span><br><span class="line">	        <span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">                String words[] = line.split(<span class="string">&quot;[\\p{Blank}]&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(!hs.contains(words[<span class="number">0</span>])){</span><br><span class="line">                    cnt++;</span><br><span class="line">			        out.write(words[<span class="number">0</span>] + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">	            line = br2.readLine();</span><br><span class="line">	        }</span><br><span class="line">            <span class="comment">//out.write(&quot;&quot;+ cnt + &quot;\n&quot;);</span></span><br><span class="line">            br1.close();</span><br><span class="line">            in1.close();</span><br><span class="line">	        br2.close();</span><br><span class="line">            in2.close();</span><br><span class="line">            out.flush();</span><br><span class="line">			out.close();</span><br><span class="line">		}</span><br><span class="line">		System.exit(job.waitForCompletion(<span class="keyword">true</span>)?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>OverallClean.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x6768;</span></span><br><span class="line"><span class="comment"> * &#x5254;&#x9664;&#x6C34;&#x519B;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x5404;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OverallClean</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; rely = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> </span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            </span><br><span class="line">            String review = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(review, KindleReview.class);</span><br><span class="line">            <span class="keyword">int</span> overall = kindleReview.getOverall();</span><br><span class="line">            String asin = kindleReview.getAsin();</span><br><span class="line">            </span><br><span class="line">            String reviewId = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">if</span>(!rely.contains(reviewId))<span class="comment">//&#x53BB;&#x9664;&#x4E0D;&#x826F;&#x8BC4;&#x5224;&#x4EBA;&#x5458;</span></span><br><span class="line">	            context.write(<span class="keyword">new</span> Text(asin), <span class="keyword">new</span> IntWritable(overall));            </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>,<span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">	        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	        <span class="keyword">float</span> ave=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) {</span><br><span class="line">                sum += val.get();</span><br><span class="line">		        i++;</span><br><span class="line">            }</span><br><span class="line">	        <span class="keyword">float</span> s=(<span class="keyword">float</span>)sum;</span><br><span class="line">	        <span class="keyword">float</span> j=(<span class="keyword">float</span>)i;</span><br><span class="line">	        ave=s/j;</span><br><span class="line">            context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + ave));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line"></span><br><span class="line">        FileSystem fs=FileSystem.get(conf);</span><br><span class="line">		InputStream in = <span class="keyword">null</span>;</span><br><span class="line">		Path name = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster2/ans&quot;</span>);</span><br><span class="line">		in = fs.open(name);</span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            rely.add(line);</span><br><span class="line">			line = br.readLine();</span><br><span class="line">		}</span><br><span class="line">		br.close();</span><br><span class="line">        in.close();</span><br><span class="line"></span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf,<span class="string">&quot;OverallClean&quot;</span>); </span><br><span class="line">        job.setJarByClass(OverallClean.class);	</span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(Text.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(job.waitForCompletion(<span class="keyword">true</span>)) {</span><br><span class="line">            InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">            Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span> +args[<span class="number">1</span>]+ <span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">            Path name3 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+args[<span class="number">1</span>]+<span class="string">&quot;/ans&quot;</span>);		</span><br><span class="line">            in2 = fs.open(name2);</span><br><span class="line">            FSDataOutputStream fileout = fs.create(name3);</span><br><span class="line">	        BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line">			BufferedWriter out = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(fileout));</span><br><span class="line"></span><br><span class="line">            InputStream in1 = <span class="keyword">null</span>;</span><br><span class="line">            Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/overall/part-r-00000&quot;</span>);	</span><br><span class="line">            in1 = fs.open(name1);</span><br><span class="line">	        BufferedReader br1 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in1));</span><br><span class="line"></span><br><span class="line">	        line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            Set&lt;String&gt; hs = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            line = br2.readLine();</span><br><span class="line">	        <span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">                String words[] = line.split(<span class="string">&quot;[\\p{Blank}]&quot;</span>);</span><br><span class="line">                hs.add(words[<span class="number">0</span>]);</span><br><span class="line">	            line = br2.readLine();</span><br><span class="line">	        }</span><br><span class="line">            out.write(<span class="string">&quot;Lack...\n&quot;</span>);</span><br><span class="line">            line = br1.readLine();</span><br><span class="line">	        <span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">                String words[] = line.split(<span class="string">&quot;[\\p{Blank}]&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(!hs.contains(words[<span class="number">0</span>])){</span><br><span class="line">                    cnt++;</span><br><span class="line">			        out.write(words[<span class="number">0</span>] + <span class="string">&quot; &quot;</span> + words[<span class="number">1</span>] + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                }</span><br><span class="line">	            line = br1.readLine();</span><br><span class="line">	        }</span><br><span class="line">            out.write(<span class="string">&quot;&quot;</span>+ cnt + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            br1.close();</span><br><span class="line">            in1.close();</span><br><span class="line">	        br2.close();</span><br><span class="line">            in2.close();</span><br><span class="line">            out.flush();</span><br><span class="line">			out.close();</span><br><span class="line">		}</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>OverallWeights.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x6839;&#x636E;&#x5E2E;&#x52A9;&#x5EA6;&#x548C;&#x65F6;&#x6548;&#x6027;&#xFF0C;&#x66F4;&#x6539;&#x540C;&#x4E00;&#x5546;&#x54C1;&#x6BCF;&#x6761;&#x8BC4;&#x8BBA;&#x7684;&#x8BC4;&#x7EA7;&#x6743;&#x91CD;&#xFF0C;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x5254;&#x9664;&#x6C34;&#x519B;</span></span><br><span class="line"><span class="comment"> * &#x8BC4;&#x8BBA;&#x540E;&#x7684;&#x5404;&#x5546;&#x54C1;&#x5E73;&#x5747;&#x8BC4;&#x7EA7;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OverallWeights</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; rely = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">			</span><br><span class="line">			String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            String asin = kindleReview.getAsin();</span><br><span class="line">            <span class="keyword">int</span> overall = kindleReview.getOverall();</span><br><span class="line">            String[] help = kindleReview.getHelpful();</span><br><span class="line">            Long unixReviewTime = kindleReview.getUnixReviewTime();</span><br><span class="line"></span><br><span class="line">            String reviewId = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">if</span>(!rely.contains(reviewId))<span class="comment">//&#x53BB;&#x9664;&#x4E0D;&#x826F;&#x8BC4;&#x5224;&#x4EBA;&#x5458;		</span></span><br><span class="line">                context.write(<span class="keyword">new</span> Text(asin), <span class="keyword">new</span> Text(overall + <span class="string">&quot;,&quot;</span> + help[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + help [<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + unixReviewTime));</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt;</span>{</span><br><span class="line">        </span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key,Iterable&lt;Text&gt; values,Context context)</span><span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">1</span>;<span class="comment">//&#x5E2E;&#x52A9;&#x5EA6;&#x548C;&#x65F6;&#x6548;&#x6027;&#x7684;&#x6BD4;&#x4F8B;&#x4E3A;1&#xFF1A;1</span></span><br><span class="line">            ArrayList&lt;Integer&gt; overall = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">            ArrayList&lt;Float&gt; help = <span class="keyword">new</span> ArrayList&lt;Float&gt;();</span><br><span class="line">            ArrayList&lt;Long&gt; unixTime = <span class="keyword">new</span> ArrayList&lt;Long&gt;();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (Text value : values) {</span><br><span class="line">                String str = value.toString();</span><br><span class="line">                String words[] = str.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                <span class="keyword">int</span> left = Integer.parseInt(words[<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">int</span> right = Integer.parseInt(words[<span class="number">2</span>]);</span><br><span class="line">                <span class="keyword">float</span> ans = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(right != <span class="number">0</span>)</span><br><span class="line">                    ans = (<span class="keyword">float</span>)left/right;</span><br><span class="line">                </span><br><span class="line">                overall.add(Integer.parseInt(words[<span class="number">0</span>]));</span><br><span class="line">                help.add(ans);</span><br><span class="line">                unixTime.add(Long.parseLong(words[<span class="number">3</span>]));</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="comment">//&#x5E2E;&#x52A9;&#x5EA6;</span></span><br><span class="line">            <span class="keyword">float</span> sum = <span class="number">0</span>, ans = <span class="number">0.5f</span>;<span class="comment">//&#x5F53;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5E2E;&#x52A9;&#x5EA6;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x65F6;&#xFF0C;&#x8BBE;&#x7F6E;&#x5E2E;&#x52A9;&#x5EA6;&#x4E3A;0.5</span></span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">float</span> f : help){</span><br><span class="line">                <span class="keyword">if</span>(f &gt; <span class="number">0.00001f</span>){</span><br><span class="line">                    sum += f;</span><br><span class="line">                    cnt++;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(cnt != <span class="number">0</span>)</span><br><span class="line">                ans = sum/cnt;</span><br><span class="line">            Collections.replaceAll(help, <span class="number">0.0f</span>, ans);</span><br><span class="line">            <span class="comment">//&#x65F6;&#x6548;&#x6027;</span></span><br><span class="line">            <span class="keyword">long</span> newTime = <span class="number">1406073600</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//&#x5E73;&#x5747;&#x8BC4;&#x7EA7;</span></span><br><span class="line">            <span class="keyword">float</span> helpRate = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">double</span> s1 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">double</span> s2 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> all = overall.size();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;all; i++){</span><br><span class="line">                <span class="keyword">float</span> timeRate = (<span class="keyword">float</span>)unixTime.get(i);</span><br><span class="line">                helpRate = help.get(i)*a + timeRate*timeRate/newTime*b;</span><br><span class="line">                s1 += (<span class="keyword">double</span>)helpRate*overall.get(i);</span><br><span class="line">                s2 += (<span class="keyword">double</span>)helpRate;</span><br><span class="line">            }</span><br><span class="line">		    context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + s1/s2));</span><br><span class="line">        }</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>{</span><br><span class="line">		Configuration configuration=<span class="keyword">new</span> Configuration();</span><br><span class="line">		String[] otherArgs=<span class="keyword">new</span> GenericOptionsParser(configuration,args).getRemainingArgs();</span><br><span class="line">		<span class="keyword">if</span>(otherArgs.length!=<span class="number">2</span>){</span><br><span class="line">			System.err.println(<span class="string">&quot;Usage:reverseIndex &lt;in&gt; &lt;out&gt;&quot;</span>);</span><br><span class="line">			System.exit(<span class="number">2</span>);</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">        FileSystem fs=FileSystem.get(configuration);</span><br><span class="line">		InputStream in = <span class="keyword">null</span>;</span><br><span class="line">		Path name = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster2/ans&quot;</span>);</span><br><span class="line">		in = fs.open(name);</span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            rely.add(line);</span><br><span class="line">			line = br.readLine();</span><br><span class="line">		}</span><br><span class="line">		br.close();</span><br><span class="line">        in.close();</span><br><span class="line">				</span><br><span class="line">		<span class="comment">//&#x914D;&#x7F6E;&#x4F5C;&#x4E1A;&#x540D;</span></span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">&quot;deprecation&quot;</span>)</span><br><span class="line">		Job job=<span class="keyword">new</span> Job(configuration, <span class="string">&quot;OverallWeights&quot;</span>);</span><br><span class="line">		job.setJarByClass(OverallWeights.class);</span><br><span class="line">		job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">		job.setReducerClass(IntSumReducer.class);</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(Text.class);	</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">		System.exit(job.waitForCompletion(<span class="keyword">true</span>)?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>print_zhe.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> * @author &#x7B80;</span></span><br><span class="line"><span class="string"> * &#x7ED8;&#x5236;&#x4E09;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x540E;&#x7684;&#x5BF9;&#x6BD4;&#x6298;&#x7EBF;&#x56FE;.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">f1 = open(<span class="string">&quot;./pic/overall&quot;</span>)</span><br><span class="line">f2 = open(<span class="string">&quot;./pic/overallClean&quot;</span>)</span><br><span class="line">f3 = open(<span class="string">&quot;./pic/overallWeights&quot;</span>)</span><br><span class="line">x1 = []</span><br><span class="line">x2 = []</span><br><span class="line">x3 = []</span><br><span class="line">y1 = []</span><br><span class="line">y2 = []</span><br><span class="line">y3 = []</span><br><span class="line"></span><br><span class="line">line = f1.readline()</span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    x = line.split()</span><br><span class="line">    x1.append(x[<span class="number">0</span>])</span><br><span class="line">    <span class="comment">#y1.append(int(x[1]))</span></span><br><span class="line">    y1.append(float(x[<span class="number">1</span>]))</span><br><span class="line">    line = f1.readline()</span><br><span class="line">line = f2.readline()</span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    x = line.split()</span><br><span class="line">    x2.append(x[<span class="number">0</span>])</span><br><span class="line">    y2.append(float(x[<span class="number">1</span>]))</span><br><span class="line">    line = f2.readline()</span><br><span class="line">line = f3.readline()</span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    x = line.split()</span><br><span class="line">    x3.append(x[<span class="number">0</span>])</span><br><span class="line">    y3.append(float(x[<span class="number">1</span>]))</span><br><span class="line">    line = f3.readline()</span><br><span class="line"></span><br><span class="line">x=np.arange(<span class="number">100</span>,<span class="number">350</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line">l1=plt.plot(x1,y1,<span class="string">&apos;r--&apos;</span>,label=<span class="string">&apos;avgReviewOverall&apos;</span>)</span><br><span class="line">l2=plt.plot(x2,y2,<span class="string">&apos;b--&apos;</span>,label=<span class="string">&apos;avgReviewOverallClean&apos;</span>)</span><br><span class="line">l3=plt.plot(x3,y3,<span class="string">&apos;g--&apos;</span>,label=<span class="string">&apos;avgReviewOverallWeights&apos;</span>)</span><br><span class="line">plt.plot(x1,y1,<span class="string">&apos;ro-&apos;</span>,x2,y2,<span class="string">&apos;b+-&apos;</span>,x3,y3,<span class="string">&apos;g^-&apos;</span>)</span><br><span class="line">plt.title(<span class="string">&apos;Average number of comments for each rated product&apos;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&apos;Rating&apos;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&apos;Average number of comments&apos;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"><span class="comment">#&#x663E;&#x793A;&#x51FA;&#x6240;&#x6709;&#x8BBE;&#x7F6E;</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>AvgReview.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x8BA1;&#x7B97;&#x5404;&#x8BC4;&#x7EA7;&#x9636;&#x6BB5;&#x7684;&#x5546;&#x54C1;&#x62E5;&#x6709;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6761;&#x6570;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AvgReview</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; rely1 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; rely2 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; rely3 = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> </span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            </span><br><span class="line">            String review = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(review, KindleReview.class);</span><br><span class="line">            String asin = kindleReview.getAsin();</span><br><span class="line">            String reviewId = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">if</span>(!rely3.contains(reviewId)&amp;&amp;rely1.containsKey(asin)){</span><br><span class="line">                <span class="keyword">int</span> overall = rely1.get(asin);</span><br><span class="line">                context.write(<span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + overall), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>,<span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String overall = key.toString();</span><br><span class="line">	        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) {</span><br><span class="line">		        i++;</span><br><span class="line">            }</span><br><span class="line">            context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + (<span class="keyword">float</span>)i/rely2.get(overall)));</span><br><span class="line">            <span class="comment">//context.write(key, new Text(&quot;&quot; + i));</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">//&#x8F93;&#x5165;&#x53C2;&#x6570;&#xFF1A;KR&#x8BC4;&#x8BBA;json&#x6587;&#x4EF6; &#x5546;&#x54C1;&#x8BC4;&#x7EA7; &#x6BCF;&#x79CD;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x79CD;&#x6570; &#x8F93;&#x51FA;&#x6587;&#x4EF6;</span></span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line"></span><br><span class="line">        FileSystem fs=FileSystem.get(conf);</span><br><span class="line">		InputStream in1 = <span class="keyword">null</span>;</span><br><span class="line">        InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">		InputStream in3 = <span class="keyword">null</span>;</span><br><span class="line">		Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+args[<span class="number">1</span>]+<span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">		Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+args[<span class="number">2</span>]+<span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">		Path name3 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster2/ans&quot;</span>);</span><br><span class="line">		in1 = fs.open(name1);</span><br><span class="line">		in2 = fs.open(name2);</span><br><span class="line">		in3 = fs.open(name3);</span><br><span class="line">		BufferedReader br1 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in1));</span><br><span class="line">		BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line">        BufferedReader br3 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in3));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br1.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String str = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = (<span class="keyword">int</span>)Double.parseDouble(itr.nextToken());</span><br><span class="line">            rely1.put(str, integer);</span><br><span class="line">			line = br1.readLine();</span><br><span class="line">		}</span><br><span class="line">        line = br2.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String str = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = Integer.parseInt(itr.nextToken());</span><br><span class="line">            rely2.put(str, integer);</span><br><span class="line">			line = br2.readLine();</span><br><span class="line">		}</span><br><span class="line">        line = br3.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            rely3.add(line);</span><br><span class="line">			line = br3.readLine();</span><br><span class="line">		}</span><br><span class="line">		br1.close();</span><br><span class="line">        br2.close();</span><br><span class="line">        br3.close();</span><br><span class="line">        in1.close();</span><br><span class="line">        in2.close();</span><br><span class="line">        in3.close();</span><br><span class="line"></span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf,<span class="string">&quot;AvgReview&quot;</span>); </span><br><span class="line">        job.setJarByClass(AvgReview.class);	</span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(Text.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">3</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>AvgReview.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x8BA1;&#x7B97;&#x5404;&#x8BC4;&#x7EA7;&#x9636;&#x6BB5;&#x7684;&#x5546;&#x54C1;&#x62E5;&#x6709;&#x7684;&#x5E73;&#x5747;&#x8BC4;&#x8BBA;&#x6761;&#x6570;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AvgReview</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; rely1 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; rely2 = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; rely3 = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMap</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> </span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            </span><br><span class="line">            String review = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(review, KindleReview.class);</span><br><span class="line">            String asin = kindleReview.getAsin();</span><br><span class="line">            String reviewId = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">if</span>(!rely3.contains(reviewId)&amp;&amp;rely1.containsKey(asin)){</span><br><span class="line">                <span class="keyword">int</span> overall = rely1.get(asin);</span><br><span class="line">                context.write(<span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + overall), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>,<span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String overall = key.toString();</span><br><span class="line">	        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) {</span><br><span class="line">		        i++;</span><br><span class="line">            }</span><br><span class="line">            context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + (<span class="keyword">float</span>)i/rely2.get(overall)));</span><br><span class="line">            <span class="comment">//context.write(key, new Text(&quot;&quot; + i));</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">//&#x8F93;&#x5165;&#x53C2;&#x6570;&#xFF1A;KR&#x8BC4;&#x8BBA;json&#x6587;&#x4EF6; &#x5546;&#x54C1;&#x8BC4;&#x7EA7; &#x6BCF;&#x79CD;&#x8BC4;&#x7EA7;&#x7684;&#x5546;&#x54C1;&#x79CD;&#x6570; &#x8F93;&#x51FA;&#x6587;&#x4EF6;</span></span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line"></span><br><span class="line">        FileSystem fs=FileSystem.get(conf);</span><br><span class="line">		InputStream in1 = <span class="keyword">null</span>;</span><br><span class="line">        InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">		InputStream in3 = <span class="keyword">null</span>;</span><br><span class="line">		Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+args[<span class="number">1</span>]+<span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">		Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/&quot;</span>+args[<span class="number">2</span>]+<span class="string">&quot;/part-r-00000&quot;</span>);</span><br><span class="line">		Path name3 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster2/ans&quot;</span>);</span><br><span class="line">		in1 = fs.open(name1);</span><br><span class="line">		in2 = fs.open(name2);</span><br><span class="line">		in3 = fs.open(name3);</span><br><span class="line">		BufferedReader br1 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in1));</span><br><span class="line">		BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line">        BufferedReader br3 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in3));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br1.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String str = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = (<span class="keyword">int</span>)Double.parseDouble(itr.nextToken());</span><br><span class="line">            rely1.put(str, integer);</span><br><span class="line">			line = br1.readLine();</span><br><span class="line">		}</span><br><span class="line">        line = br2.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String str = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = Integer.parseInt(itr.nextToken());</span><br><span class="line">            rely2.put(str, integer);</span><br><span class="line">			line = br2.readLine();</span><br><span class="line">		}</span><br><span class="line">        line = br3.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            rely3.add(line);</span><br><span class="line">			line = br3.readLine();</span><br><span class="line">		}</span><br><span class="line">		br1.close();</span><br><span class="line">        br2.close();</span><br><span class="line">        br3.close();</span><br><span class="line">        in1.close();</span><br><span class="line">        in2.close();</span><br><span class="line">        in3.close();</span><br><span class="line"></span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf,<span class="string">&quot;AvgReview&quot;</span>); </span><br><span class="line">        job.setJarByClass(AvgReview.class);	</span><br><span class="line">        job.setMapperClass(MyMap.class);</span><br><span class="line">        job.setReducerClass(MyReduce.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(Text.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">3</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>SentimentAnalysis.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * &#x60C5;&#x7EEA;&#x5206;&#x6790;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SentimentAnalysis</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">2</span>) {</span><br><span class="line">            System.err.println(<span class="string">&quot;Usage: SentimentAnalysis &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">&quot;SentimentAnalysis&quot;</span>);</span><br><span class="line">        job.setJarByClass(SentimentAnalysis.class);</span><br><span class="line">        job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">        job.setCombinerClass(IReducer.class);</span><br><span class="line">        job.setReducerClass(IReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) {</span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i]));</span><br><span class="line">        }</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            String ReviewText = kindleReview.getReviewText();</span><br><span class="line">            Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">            props.put(<span class="string">&quot;annotators&quot;</span>, <span class="string">&quot;tokenize, ssplit, pos, parse, sentiment&quot;</span>);</span><br><span class="line">            props.setProperty(<span class="string">&quot;parse.model&quot;</span>, <span class="string">&quot;edu/stanford/nlp/models/srparser/englishSR.ser.gz&quot;</span>);</span><br><span class="line">            StanfordCoreNLP pipeline = <span class="keyword">new</span> StanfordCoreNLP(props);</span><br><span class="line">            <span class="keyword">int</span> mainSentiment = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (ReviewText != <span class="keyword">null</span> &amp;&amp; ReviewText.length() &gt; <span class="number">0</span>) {</span><br><span class="line">                <span class="keyword">int</span> longest = <span class="number">0</span>;</span><br><span class="line">                Annotation annotation = pipeline.process(ReviewText);</span><br><span class="line">                <span class="keyword">for</span> (CoreMap sentence : annotation.get(CoreAnnotations.SentencesAnnotation.class)) {</span><br><span class="line">                    Tree tree = sentence.get(SentimentCoreAnnotations.SentimentAnnotatedTree.class);</span><br><span class="line">                    <span class="keyword">int</span> sentiment = RNNCoreAnnotations.getPredictedClass(tree);</span><br><span class="line">                    String partText = sentence.toString();</span><br><span class="line">                    <span class="keyword">if</span> (partText.length() &gt; longest) {</span><br><span class="line">                        mainSentiment = sentiment;</span><br><span class="line">                        longest = partText.length();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(kindleReview.getAsin() + <span class="string">&quot; &quot;</span> + kindleReview.getReviewerID()), <span class="keyword">new</span> IntWritable(mainSentiment + <span class="number">1</span>));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>{</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span></span></span><br><span class="line"><span class="function"><span class="params">                           Context context</span></span></span><br><span class="line"><span class="function"><span class="params">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>{</span><br><span class="line">            <span class="keyword">for</span> (IntWritable value : values) {</span><br><span class="line">                context.write(key, value);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>OverallSentiment.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x7B80;</span></span><br><span class="line"><span class="comment"> * &#x8BA1;&#x7B97;&#x7ECF;&#x8FC7;&#x5254;&#x9664;&#x6C34;&#x519B;&#x3001;&#x4FEE;&#x6539;&#x6743;&#x91CD;&#x3001;&#x60C5;&#x7EEA;&#x5206;&#x6790;&#x540E;&#x7684;&#x5546;&#x54C1;&#x8BC4;&#x7EA7;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OverallSentiment</span> </span>{</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; rely = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">			</span><br><span class="line">			String line = value.toString();</span><br><span class="line">            Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">            KindleReview kindleReview = gson.fromJson(line, KindleReview.class);</span><br><span class="line">            String asin = kindleReview.getAsin();</span><br><span class="line">            <span class="keyword">float</span> overall = kindleReview.getOverall();</span><br><span class="line">            String[] help = kindleReview.getHelpful();</span><br><span class="line">            Long unixReviewTime = kindleReview.getUnixReviewTime();</span><br><span class="line"></span><br><span class="line">            String reviewId = kindleReview.getReviewerID();</span><br><span class="line">            <span class="keyword">if</span>(!rely.contains(reviewId)){<span class="comment">//&#x53BB;&#x9664;&#x4E0D;&#x826F;&#x8BC4;&#x5224;&#x4EBA;&#x5458;</span></span><br><span class="line">                overall = (<span class="keyword">float</span>)(overall+map.get(asin + <span class="string">&quot; &quot;</span> + reviewId))/<span class="number">2</span>;</span><br><span class="line">                context.write(<span class="keyword">new</span> Text(asin), <span class="keyword">new</span> Text(overall + <span class="string">&quot;,&quot;</span> + help[<span class="number">0</span>] + <span class="string">&quot;,&quot;</span> + help [<span class="number">1</span>] + <span class="string">&quot;,&quot;</span> + unixReviewTime));</span><br><span class="line">            }</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt;</span>{</span><br><span class="line">        </span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key,Iterable&lt;Text&gt; values,Context context)</span><span class="keyword">throws</span> IOException,InterruptedException</span>{</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">1</span>;<span class="comment">//&#x5E2E;&#x52A9;&#x5EA6;&#x548C;&#x65F6;&#x6548;&#x6027;&#x7684;&#x6BD4;&#x4F8B;&#x4E3A;1&#xFF1A;1</span></span><br><span class="line">            ArrayList&lt;Float&gt; overall = <span class="keyword">new</span> ArrayList&lt;Float&gt;();</span><br><span class="line">            ArrayList&lt;Float&gt; help = <span class="keyword">new</span> ArrayList&lt;Float&gt;();</span><br><span class="line">            ArrayList&lt;Long&gt; unixTime = <span class="keyword">new</span> ArrayList&lt;Long&gt;();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (Text value : values) {</span><br><span class="line">                String str = value.toString();</span><br><span class="line">                String words[] = str.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                <span class="keyword">int</span> left = Integer.parseInt(words[<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">int</span> right = Integer.parseInt(words[<span class="number">2</span>]);</span><br><span class="line">                <span class="keyword">float</span> ans = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(right != <span class="number">0</span>)</span><br><span class="line">                    ans = (<span class="keyword">float</span>)left/right;</span><br><span class="line">                </span><br><span class="line">                overall.add(Float.parseFloat(words[<span class="number">0</span>]));</span><br><span class="line">                help.add(ans);</span><br><span class="line">                unixTime.add(Long.parseLong(words[<span class="number">3</span>]));</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="comment">//&#x5E2E;&#x52A9;&#x5EA6;</span></span><br><span class="line">            <span class="keyword">float</span> sum = <span class="number">0</span>, ans = <span class="number">0.5f</span>;<span class="comment">//&#x5F53;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5E2E;&#x52A9;&#x5EA6;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x65F6;&#xFF0C;&#x8BBE;&#x7F6E;&#x5E2E;&#x52A9;&#x5EA6;&#x4E3A;0.5</span></span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">float</span> f : help){</span><br><span class="line">                <span class="keyword">if</span>(f &gt; <span class="number">0.00001f</span>){</span><br><span class="line">                    sum += f;</span><br><span class="line">                    cnt++;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(cnt != <span class="number">0</span>)</span><br><span class="line">                ans = sum/cnt;</span><br><span class="line">            Collections.replaceAll(help, <span class="number">0.0f</span>, ans);</span><br><span class="line">            <span class="comment">//&#x65F6;&#x6548;&#x6027;</span></span><br><span class="line">            <span class="keyword">long</span> newTime = <span class="number">1406073600</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//&#x5E73;&#x5747;&#x8BC4;&#x7EA7;</span></span><br><span class="line">            <span class="keyword">float</span> helpRate = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">double</span> s1 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">double</span> s2 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> all = overall.size();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;all; i++){</span><br><span class="line">                <span class="keyword">float</span> timeRate = (<span class="keyword">float</span>)unixTime.get(i);</span><br><span class="line">                helpRate = help.get(i)*a + timeRate*timeRate/newTime*b;</span><br><span class="line">                s1 += (<span class="keyword">double</span>)helpRate*overall.get(i);</span><br><span class="line">                s2 += (<span class="keyword">double</span>)helpRate;</span><br><span class="line">            }</span><br><span class="line">		    context.write(key, <span class="keyword">new</span> Text(<span class="string">&quot;&quot;</span> + s1/s2));</span><br><span class="line">        }</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>{</span><br><span class="line">		Configuration configuration=<span class="keyword">new</span> Configuration();</span><br><span class="line">		String[] otherArgs=<span class="keyword">new</span> GenericOptionsParser(configuration,args).getRemainingArgs();</span><br><span class="line">		<span class="keyword">if</span>(otherArgs.length!=<span class="number">2</span>){</span><br><span class="line">			System.err.println(<span class="string">&quot;Usage:reverseIndex &lt;in&gt; &lt;out&gt;&quot;</span>);</span><br><span class="line">			System.exit(<span class="number">2</span>);</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">        FileSystem fs=FileSystem.get(configuration);</span><br><span class="line">		InputStream in1 = <span class="keyword">null</span>;</span><br><span class="line">        InputStream in2 = <span class="keyword">null</span>;</span><br><span class="line">		Path name1 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/isPaidPoster2/ans&quot;</span>);</span><br><span class="line">		Path name2 = <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://localhost:9000/user/hadoop/sentiment/sentiment_analysis&quot;</span>);</span><br><span class="line">		in1 = fs.open(name1);</span><br><span class="line">		in2 = fs.open(name2);</span><br><span class="line">		BufferedReader br1 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in1));		</span><br><span class="line">		BufferedReader br2 = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in2));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//rely</span></span><br><span class="line">        String line = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        line = br1.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            rely.add(line);</span><br><span class="line">			line = br1.readLine();</span><br><span class="line">		}</span><br><span class="line">        line = br2.readLine();</span><br><span class="line">		<span class="keyword">while</span> (line != <span class="keyword">null</span>) {</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(line);</span><br><span class="line">            String asin = itr.nextToken();</span><br><span class="line">			String reviewId = itr.nextToken();</span><br><span class="line">			<span class="keyword">int</span> integer = (<span class="keyword">int</span>)Double.parseDouble(itr.nextToken());</span><br><span class="line">            map.put(asin + <span class="string">&quot; &quot;</span> + reviewId, integer);</span><br><span class="line">			line = br2.readLine();</span><br><span class="line">		}</span><br><span class="line">		br1.close();</span><br><span class="line">        br2.close();</span><br><span class="line">        in1.close();</span><br><span class="line">        in2.close();</span><br><span class="line">				</span><br><span class="line">		<span class="comment">//&#x914D;&#x7F6E;&#x4F5C;&#x4E1A;&#x540D;</span></span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">&quot;deprecation&quot;</span>)</span><br><span class="line">		Job job=<span class="keyword">new</span> Job(configuration, <span class="string">&quot;OverallSentiment&quot;</span>);</span><br><span class="line">		job.setJarByClass(OverallSentiment.class);</span><br><span class="line">		job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">		job.setReducerClass(IntSumReducer.class);</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(Text.class);	</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">		System.exit(job.waitForCompletion(<span class="keyword">true</span>)?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>KindleReview.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &#x9F9A;</span></span><br><span class="line"><span class="comment"> * json&#x683C;&#x5F0F;&#x6570;&#x636E;&#x5904;&#x7406;&#x7C7B;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KindleReview</span> </span>{</span><br><span class="line">    String reviewerID;</span><br><span class="line">    String asin;</span><br><span class="line">    String reviewerName;</span><br><span class="line">    String[] helpful;</span><br><span class="line">    String reviewText;</span><br><span class="line">    <span class="keyword">int</span> overall;</span><br><span class="line">    String summary;</span><br><span class="line">    <span class="keyword">long</span> unixReviewTime;</span><br><span class="line">    String reviewTime;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReviewerID</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> reviewerID;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReviewerID</span><span class="params">(String reviewerID)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.reviewerID = reviewerID;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAsin</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> asin;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAsin</span><span class="params">(String asin)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.asin = asin;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReviewerName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> reviewerName;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReviewerName</span><span class="params">(String reviewerName)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.reviewerName = reviewerName;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getHelpful() {</span><br><span class="line">        <span class="keyword">return</span> helpful;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHelpful</span><span class="params">(String[] helpful)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.helpful = helpful;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReviewText</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> reviewText;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReviewText</span><span class="params">(String reviewText)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.reviewText = reviewText;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOverall</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> overall;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOverall</span><span class="params">(<span class="keyword">int</span> overall)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.overall = overall;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSummary</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> summary;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSummary</span><span class="params">(String summary)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.summary = summary;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getUnixReviewTime</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> unixReviewTime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUnixReviewTime</span><span class="params">(<span class="keyword">long</span> unixReviewTime)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.unixReviewTime = unixReviewTime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReviewTime</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> reviewTime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReviewTime</span><span class="params">(String reviewTime)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.reviewTime = reviewTime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;KindleReview{&quot;</span> +</span><br><span class="line">                <span class="string">&quot;reviewerID=&apos;&quot;</span> + reviewerID + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&quot;, asin=&apos;&quot;</span> + asin + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&quot;, reviewerName=&apos;&quot;</span> + reviewerName + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&quot;, helpful=&quot;</span> + Arrays.toString(helpful) +</span><br><span class="line">                <span class="string">&quot;, reviewText=&apos;&quot;</span> + reviewText + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&quot;, overall=&quot;</span> + overall +</span><br><span class="line">                <span class="string">&quot;, summary=&apos;&quot;</span> + summary + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&quot;, unixReviewTime=&quot;</span> + unixReviewTime +</span><br><span class="line">                <span class="string">&quot;, reviewTime=&apos;&quot;</span> + reviewTime + <span class="string">&apos;\&apos;&apos;</span> +</span><br><span class="line">                <span class="string">&apos;}&apos;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

        <a id="gotop" href="#"><i class="iconfont icon-up-circle"></i></a>
        
        <br>
        <div id="gitalk-container"></div>
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <ul class="list-inline text-center">
        <li>
            <a target="_blank" href="https://xn--i0v668g.com/">
                            <span>
                                <i class="iconfont icon-yang"></i>
                            </span>
            </a>
        </li>
        <li>
            <a target="_blank" href="https://github.com/jianzhiting">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
	<li>
            <a target="_blank" href="https://space.bilibili.com/50146626?from=search&seid=15037865582393636035/">
                            <span>
                                <i class="iconfont icon-bilibili-line"></i>
                            </span>
            </a>
        </li>

    </ul>
    <p>
	to work harder
        <!-- 
	<span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span> 
----------------------------����if you are looking for my theme����---------------------------
	<a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a>
----------------------------------------------------------------------------------------------
	-->
        <a href="https://hexo.io/">Hexo</a></p>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->




<script>!function(e){var r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function t(){for(var c=0;c<r.length;c++)t=r[c],void 0,0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=r[c];t=o,n=function(){r=r.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}t(),e.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(t,e)})}(this);</script></body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</html>
